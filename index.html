<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Open Case Studies: Exploring CO2 emissions across time</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<html>

<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DBLE7NM6XV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DBLE7NM6XV');
</script>
</head>

<body>

</body>
</html>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies: Exploring CO2 emissions
across time</h1>

</div>


<style>
#TOC {
  background: url("https://opencasestudies.github.io/img/icon-bahi.png");
  background-size: contain;
  padding-top: 240px !important;
  background-repeat: no-repeat;
}
</style>
<!-- Open all links in new tab-->
<p><base target="_blank"/></p>
<div id="google_translate_element">

</div>
<script type="text/javascript" src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit'></script>
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
}
</script>
<div id="section" class="section level4 outline">
<h4 class="outline"></h4>
<p><img src="img/mainplot.png" width="800 px" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level4">
<h4></h4>
</div>
<div id="section-2" class="section level4 disclaimer_block">
<h4 class="disclaimer_block"></h4>
<p><strong>Disclaimer</strong>: The purpose of the <a
href="https://opencasestudies.github.io" target="_blank">Open Case
Studies</a> project is <strong>to demonstrate the use of various data
science methods, tools, and software in the context of messy, real-world
data</strong>. A given case study does not cover all aspects of the
research process, is not claiming to be the most appropriate way to
analyze a given dataset, and should not be used in the context of making
policy decisions without external consultation from scientific
experts.</p>
</div>
<div id="section-3" class="section level4">
<h4></h4>
</div>
<div id="section-4" class="section level4 license_block">
<h4 class="license_block"></h4>
<p>This work is licensed under the Creative Commons
Attribution-NonCommercial 3.0 <a
href="https://creativecommons.org/licenses/by-nc/3.0/us/"
target="_blank">(CC BY-NC 3.0)</a> United States License.</p>
</div>
<div id="section-5" class="section level4">
<h4></h4>
</div>
<div id="section-6" class="section level4 reference_block">
<h4 class="reference_block"></h4>
<p>To cite this case study please use:</p>
<p>Wright, Carrie and Ontiveros, Michael and Jager, Leah and Taub,
Margaret and Hicks, Stephanie. (2020). <a
href="https://github.com/opencasestudies/ocs-bp-co2-emissions"
class="uri">https://github.com/opencasestudies/ocs-bp-co2-emissions</a>.
Exploring CO2 emissions across time (Version v1.0.0).</p>
</div>
<div id="section-7" class="section level4">
<h4></h4>
<p>To access the GitHub repository for this case study see here: <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions"
class="uri">https://github.com//opencasestudies/ocs-bp-co2-emissions</a>.</p>
<p>You may also access and download the data using our
<code>OCSdata</code> package. To learn more about this package including
examples, see this <a
href="https://github.com/opencasestudies/OCSdata">link</a>. Here is how
you would install this package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;OCSdata&quot;</span>)</span></code></pre></div>
<p>This case study is part of a series of public health case studies for
the <a href="https://americanhealth.jhu.edu/open-case-studies">Bloomberg
American Health Initiative</a>.</p>
<hr />
<p>The total reading time for this case study is calculated via <a
href="https://github.com/unDocUMeantIt/koRpus">koRpus</a> and shown
below:</p>
<table>
<thead>
<tr class="header">
<th align="left">Reading Time</th>
<th align="left">Method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">70 minutes</td>
<td align="left">koRpus</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Readability Score: </strong></p>
<p>A readability index estimates the reading difficulty level of a
particular text. Flesch-Kincaid, FORCAST, and SMOG are three common
readability indices that were calculated for this case study via <a
href="https://github.com/unDocUMeantIt/koRpus">koRpus</a>. These indices
provide an estimation of the minimum reading level required to
comprehend this case study by grade and age.</p>
<pre><code>Text language: en </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">index</th>
<th align="right">grade</th>
<th align="right">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Flesch-Kincaid</td>
<td align="right">9</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">FORCAST</td>
<td align="right">10</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">SMOG</td>
<td align="right">11</td>
<td align="right">16</td>
</tr>
</tbody>
</table>
<hr />
<p>Please help us by filling out our survey.</p>
<div style="display: flex; justify-content: center;">
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfpN4FN3KELqBNEgf2Atpi7Wy7Nqy2beSkFQINL7Y5sAMV5_w/viewform?embedded=true" width="1200" height="700" frameborder="0" marginheight="0" marginwidth="0">
Loading…
</iframe>
</div>
</div>
<div id="motivation" class="section level1">
<h1><strong>Motivation</strong></h1>
<hr />
<p>This case study explores how different countries have contributed to
Carbon Dioxide (CO2) emissions over time and how CO2 emission rates may
relate to increasing global temperatures and increased rates of natural
disasters and storms. We used this <a
href="https://www.epa.gov/report-environment/greenhouse-gases"
target="_blank">report from the EPA</a> as the basis for motivating this
case study, as it provides background information about how CO2
emissions and other greenhouse gases have influenced the climate and
weather patterns.</p>
<p>CO2 makes up the largest proportion of greenhouse gas emissions in
the United States:</p>
<p><img src="img/emissions.jpg" width="500px" style="display: block; margin: auto;" /></p>
<div id="source" class="section level5">
<h5><a
href="https://www.epa.gov/ghgemissions/inventory-us-greenhouse-gas-emissions-and-sinks"
target="_blank">[source]</a></h5>
<p>A variety of sources and sectors contribute to greenhouse gas
emissions:</p>
<p><img src="img/sector.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-1" class="section level5">
<h5><a
href="https://www.epa.gov/ghgemissions/inventory-us-greenhouse-gas-emissions-and-sinks"
target="_blank">[source]</a></h5>
<p>Transportation and Electricity contribute the most metric tons of
CO2:</p>
<p><img src="img/sources_pie.jpg" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-2" class="section level5">
<h5><a
href="https://www.epa.gov/ghgemissions/inventory-us-greenhouse-gas-emissions-and-sinks"
target="_blank">[source]</a></h5>
<p>So why should we pay attention to greenhouse gases?</p>
<p>According to the <a
href="https://www.epa.gov/sites/production/files/2020-04/documents/us-ghg-inventory-2020-main-text.pdf"
target="_blank">US Environmental Protection Agency (EPA) Inventory of
U.S. Greenhouse Gas Emissions and Sinks 2020 Report</a>:</p>
<blockquote>
<p>Greenhouse gases absorb infrared radiation, thereby trapping heat in
the atmosphere and making the planet warmer. The most important
greenhouse gases directly emitted by humans include carbon dioxide
(CO2), methane (CH4), nitrous oxide (N2O), and several
fluorine-containing halogenated substances. Although CO2, CH4, and N2O
occur naturally in the atmosphere, human activities have changed their
atmospheric concentrations. From the pre- industrial era (i.e., ending
about 1750) to 2018, concentrations of these greenhouse gases have
increased globally by 46, 165, and 23 percent, respectively (IPCC 2013;
NOAA/ESRL 2019a, 2019b, 2019c).</p>
</blockquote>
<p>* IPCC stands for the Intergovernmental Panel on Climate Change</p>
<p>In fact, there are many signs that our planet is experiencing warmer
temperatures:</p>
<p><img src="img/warming.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-3" class="section level5">
<h5><a href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">[source]</a></h5>
<p>The connection between greenhouse gas levels and global temperatures
and the influence of increased global temperatures on human health are
motivated by these reports:</p>
</div>
<div id="section-8" class="section level4 reference_block">
<h4 class="reference_block"></h4>
<ul>
<li><p>Melillo, J.M., T.C. Richmond, and G.W. Yohe (eds.). 2014. Climate
change impacts in the United States: The third National Climate
Assessment. U.S. Global Change Research Program.</p></li>
<li><ol start="2020" style="list-style-type: decimal">
<li>“Inventory of US Greenhouse Gas Emissions and Sinks: 1990–2018.” EPA
430-R-20-002, Tech. Rep. <a
href="https://www.epa.gov/ghgemissions/inventory-us-greenhouse-gas-emissions-and-sinks"
class="uri">https://www.epa.gov/ghgemissions/inventory-us-greenhouse-gas-emissions-and-sinks</a>.</li>
</ol></li>
</ul>
</div>
<div id="section-9" class="section level4">
<h4></h4>
<p>The <a href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">National Climate Assessment Report</a> states that:</p>
<blockquote>
<p>Heat-trapping gases already in the atmosphere have committed us to a
hotter future with more climate-related impacts over the next few
decades. The magnitude of climate change beyond the next few decades
depends primarily on the amount of heat-trapping gases that human
activities emit globally, now and in the future.</p>
</blockquote>
<p>See the following links for more information about how greenhouse
gases have influenced global temperatures: 1) The EPA <a
href="https://www.epa.gov/report-environment/greenhouse-gases"
target="_blank">report</a> on green house gases<br />
2) The National Climate Assessment (NCA) <a
href="https://nca2014.globalchange.gov/" target="_blank">summary from
2014</a>) 3) The <a
href="https://world101.cfr.org/global-era-issues/climate-change/climate-change-adaptations"
target="_blank">World101 website</a> about how countries are adapting to
climate change</p>
</div>
</div>
<div id="main-questions" class="section level1">
<h1><strong>Main Questions</strong></h1>
<hr />
<div id="section-10" class="section level4 main_question_block">
<h4 class="main_question_block"></h4>
<p><b><u> Our main questions: </u></b></p>
<ol style="list-style-type: decimal">
<li>How have global CO2 emission rates changed over time? In particular
for the US, and how does the US compare to other countries?</li>
<li>Are CO2 emissions in the US, global temperatures, and natural
disaster rates in the US associated?</li>
</ol>
</div>
<div id="section-11" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level1">
<h1><strong>Learning Objectives</strong></h1>
<hr />
<p>In this case study, we will explore CO2 emission data from around the
world. We will also focus on the US specifically to evaluate patterns of
temperatures and natural disaster activity.</p>
<p>This case study will particularly focus on how to use different
datasets that span different ranges of time, as well as how to create
visualizations of patterns over time. We will especially focus on using
packages and functions from the <a href="https://www.tidyverse.org/"
target="_blank"><code>tidyverse</code></a>, such as <code>dplyr</code>,
<code>tidyr</code>, and <code>ggplot2</code>.</p>
<p>The tidyverse is a library of packages created by RStudio. While some
students may be familiar with previous R programming packages, these
packages make data science in R especially legible and intuitive.</p>
<p>The skills, methods, and concepts that students will be familiar with
by the end of this case study are:</p>
<p><u><strong>Data Science Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Importing data from various types of Excel files and CSV files</li>
<li>Apply action verbs in <code>dplyr</code> for data wrangling</li>
<li>How to pivot between “long” and “wide” datasets</li>
<li>Joining together multiple datasets using <code>dplyr</code></li>
<li>How to create effective longitudinal data visualizations with
<code>ggplot2</code></li>
<li>How to add text, color, and labels to <code>ggplot2</code>
plots</li>
<li>How to create faceted <code>ggplot2</code> plots</li>
</ol>
<p><u><strong>Statistical Learning Objectives:</strong></u></p>
<ol style="list-style-type: decimal">
<li>Introduction to correlation coefficient as a summary statistic</li>
<li>Relationship between correlation and linear regression</li>
<li>Correlation is not causation</li>
</ol>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<hr />
<p>We will begin by loading the packages that we will need:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(directlabels)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OCSdata)</span></code></pre></div>
<p><u><strong>Packages used in this case study:</strong> </u></p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use in this case study</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here"
target="_blank"><code>here</code></a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readxl.tidyverse.org/"
target="_blank"><code>readxl</code></a></td>
<td>to import the Excel file data</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/"
target="_blank"><code>readr</code></a></td>
<td>to import the csv file data</td>
</tr>
<tr class="even">
<td><a href="https://dplyr.tidyverse.org/"
target="_blank"><code>dplyr</code></a></td>
<td>to view and wrangle the data, by modifying variables, renaming
variables, selecting variables, creating variables, and arranging values
within a variable</td>
</tr>
<tr class="odd">
<td><a
href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"
target="_blank"><code>magrittr</code></a></td>
<td>to use and reassign data objects using the
<code>%&lt;&gt;%</code>pipe operator</td>
</tr>
<tr class="even">
<td><a href="https://stringr.tidyverse.org/"
target="_blank"><code>stringr</code></a></td>
<td>to select only the first 4 characters of date data</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/"
target="_blank"><code>purrr</code></a></td>
<td>to apply a function on a list of tibbles (tibbles are the tidyverse
version of a data frame)</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/"
target="_blank"><code>tidyr</code></a></td>
<td>to drop rows with <code>NA</code> values from a tibble</td>
</tr>
<tr class="odd">
<td><a href="https://forcats.tidyverse.org/"
target="_blank"><code>forcats</code></a></td>
<td>to reorder the levels of a factor</td>
</tr>
<tr class="even">
<td><a href="https://ggplot2.tidyverse.org/"
target="_blank"><code>ggplot2</code></a></td>
<td>to make visualizations</td>
</tr>
<tr class="odd">
<td><a href="http://directlabels.r-forge.r-project.org/docs/index.html"
target="_blank"><code>directlabels</code></a></td>
<td>to add labels to plots easily</td>
</tr>
<tr class="even">
<td><a
href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"
target="_blank"><code>ggrepel</code></a></td>
<td>to add labels that don’t overlap to plots</td>
</tr>
<tr class="odd">
<td><a
href="https://www.tidyverse.org/blog/2018/07/broom-0-5-0/"><code>broom</code></a></td>
<td>to make the output form statistical tests easier to work with</td>
</tr>
<tr class="even">
<td><a href="https://github.com/thomasp85/patchwork"
target="_blank"><code>patchwork</code></a></td>
<td>to combine plots</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/opencasestudies/OCSdata"
target="_blank"><code>OCSdata</code></a></td>
<td>to access and download OCS data files</td>
</tr>
</tbody>
</table>
<p>The first time we use a function, we will use the <code>::</code> to
indicate which package we are using. Unless we have overlapping function
names, this is not necessary, but we will include it here to be
informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level1">
<h1><strong>Context</strong></h1>
<hr />
<p>Now we will describe a bit more background about greenhouse gas
emissions and the potential influence of these emissions on public
health.</p>
<p>Greenhouse gas emissions are due to both natural processes and
anthropogenic (human-derived) activities.</p>
<p>These emissions are one of the contributing factors to rising global
temperatures, which can have a great influence on <a
href="https://www.epa.gov/climate-indicators/understanding-connections-between-climate-change-and-human-health"
target="_blank">public health</a> as illustrated in the following
image:</p>
<p><img src="img/climate_change_health_impacts.jpg" width="800px" style="display: block; margin: auto;" /></p>
<div id="source-4" class="section level5">
<h5><a href="https://www.cdc.gov/climateandhealth/effects/default.htm"
target="_blank">[source]</a></h5>
<p>According to the <a
href="https://www.epa.gov/sites/production/files/2020-04/documents/us-ghg-inventory-2020-main-text.pdf"
target="_blank">US Environmental Protection Agency (EPA) Inventory of
U.S. Greenhouse Gas Emissions and Sinks 2020 Report</a>:</p>
<blockquote>
<p>Gases in the atmosphere can contribute to climate change both
directly and indirectly. Direct effects occur when the gas itself
absorbs radiation. Indirect radiative forcing occurs when chemical
transformations of the substance produce other greenhouse gases, when a
gas influences the atmospheric lifetimes of other gases, and/or when a
gas affects atmospheric processes that alter the radiative balance of
the earth (e.g., affect cloud formation or <a
href="https://en.wikipedia.org/wiki/Albedo"
target="_blank">albedo</a>).</p>
</blockquote>
<p>The <strong>Global Warming Potential (GWP)</strong> compares the
<strong>ability of a greenhouse gas to trap heat in the atmosphere
relative to another gas</strong>.</p>
<blockquote>
<p>The GWP of a greenhouse gas is defined as the ratio of the
accumulated radiative forcing within a specific time horizon caused by
emitting 1 kilogram of the gas, relative to that of the reference gas
CO2 (IPCC 2013). Therefore GWP-weighted emissions are provided in
million metric tons of CO2 equivalent (MMT CO2 Eq.)</p>
</blockquote>
</div>
<div id="source-5" class="section level5">
<h5><a
href="https://www.epa.gov/sites/production/files/2020-04/documents/us-ghg-inventory-2020-main-text.pdf"
target="_blank">[source]</a></h5>
<p>CO2 is actually the least heat-trapping gas of the greenhouse
gases:</p>
<p><img src="img/GWP.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-6" class="section level5">
<h5><a
href="https://www.epa.gov/sites/production/files/2020-04/documents/us-ghg-inventory-2020-main-text.pdf"
target="_blank">[source]</a></h5>
<p>However, because CO2 is so much more abundant and stays in the
atmosphere so much longer than other greenhouse gases, it has been the
largest contributor to global warming. See <a
href="https://www.ucsusa.org/resources/why-does-co2-get-more-attention-other-gases#:~:text=CO2%20sticks%20around,oxide%20(N2O)"
target="_blank">here</a> for more details.</p>
<p>It is also important to keep in mind that there is a <a
href="https://earthobservatory.nasa.gov/blogs/climateqa/would-gw-stop-with-greenhouse-gases/">lag</a>
between greenhouse gas emissions and temperature changes that we
experience because much of Earth’s thermal energy (and CO2) gets stored
in the ocean.</p>
<p>Due to a process called <a
href="https://en.wikipedia.org/wiki/Volumetric_heat_capacity#Thermal_inertia">thermal
inertia</a>, the heat stored in the ocean will eventually be transfered
to the surface of the Earth long after the gases were emitted that
resulted in the increased ocean temperature.</p>
<p>See <a
href="https://earthobservatory.nasa.gov/blogs/climateqa/would-gw-stop-with-greenhouse-gases/">here</a>
for more explanation.</p>
<p>Furthermore, rising CO2 levels in the ocean also influence ocean
acidity:</p>
<p><img src="img/oceans.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-7" class="section level5">
<h5><a href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">[source]</a></h5>
<p>As CO2 levels rise in the ocean, the pH becomes more acidic, which
makes it difficult for organisms to maintain their shells or skeletons
that are made of calcium carbonate, thus making it more difficult for
these organisms to survive and impacting their role in the ecosystem and
food chain.</p>
<p>Furthermore, greenhouse gas emissions are believed to influence
weather patterns as shown in this <a
href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">report</a>.</p>
<p>Indeed, events with high levels of precipitation which can induce
flooding and property damage are generally increasing around the
country:</p>
<p><img src="img/storms.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="source-8" class="section level5">
<h5><a href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">[source]</a></h5>
</div>
</div>
<div id="limitations" class="section level1">
<h1><strong>Limitations</strong></h1>
<hr />
<p>An important limitation regarding this data analysis to keep in mind
is the datasets only include countries and years in which countries were
reporting such information to the agencies that collected the data.
Thus, the data are incomplete. For example, while we have a fairly good
sense of CO2 emissions globally for later years, additional emissions
were also produced by countries that are not included in the data.</p>
</div>
<div id="what-are-the-data" class="section level1">
<h1><strong>What are the data?</strong></h1>
<hr />
<p>In this case study we will be using data related to CO2 emissions, as
well as other data that may influence, be influenced or relate to CO2
emissions. Most of our data is from <a
href="https://www.gapminder.org/data/" target="_blank">Gapminder</a>
that was originally obtained from the <a
href="https://www.worldbank.org/en/what-we-do" target="_blank">World
Bank</a>.</p>
<p>In addition, we will use some data that is specific to the United
States from the <a href="https://www.noaa.gov/" target="_blank">National
Oceanic and Atmospheric Administration (NOAA)</a>, which is an agency
that collects weather and climate data.</p>
<table style="width:100%;">
<colgroup>
<col width="12%" />
<col width="17%" />
<col width="14%" />
<col width="14%" />
<col width="31%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th>Data</th>
<th>Time span</th>
<th>Source</th>
<th>Original Source</th>
<th>Description</th>
<th>Citation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>CO2 emissions</strong></td>
<td>1751-2014</td>
<td><a href="https://www.gapminder.org/data/"
target="_blank">Gapminder</a></td>
<td><a href="https://cdiac.ess-dive.lbl.gov/" target="_blank">Carbon
Dioxide Information Analysis Center (CDIAC)</a></td>
<td>CO2 emissions in tonnes or metric tons (equivalent to approximately
2,204.6 pounds) per person by country</td>
<td>NA</td>
</tr>
<tr class="even">
<td><strong>GDP per capita (percent yearly growth)</strong></td>
<td>1801-2019</td>
<td><a href="https://www.gapminder.org/data/"
target="_blank">Gapminder</a></td>
<td><a href="https://data.worldbank.org/indicator/NY.GDP.PCAP.KD.ZG"
target="_blank">World Bank</a></td>
<td><a
href="https://www.investopedia.com/terms/g/gdp.asp#:~:text=Gross%20Domestic%20Product%20(GDP)%20is%20the%20monetary%20value%20of%20all,expenditures%2C%20production%2C%20or%20incomes."
target="_blank">Growth Domestic Product</a> (which is an overall measure
of the health of nation’s economy) per person by country</td>
<td>NA</td>
</tr>
<tr class="odd">
<td><strong>Energy use per person</strong></td>
<td>1960-2015</td>
<td><a href="https://www.gapminder.org/data/"
target="_blank">Gapminder</a></td>
<td><a href="https://data.worldbank.org/indicator/EG.USE.PCAP.KG.OE"
target="_blank">World Bank</a></td>
<td>Use of primary energy before transformation to other end-use fuels,
by country</td>
<td>NA</td>
</tr>
<tr class="even">
<td><strong>US Natural Disasters</strong></td>
<td>1980-2019</td>
<td><a href="https://www.ncdc.noaa.gov/billions/time-series"
target="_blank">The National Oceanic and Atmospheric Administration
(NOAA)</a></td>
<td><a href="https://www.ncdc.noaa.gov/billions/time-series"
target="_blank">The National Oceanic and Atmospheric Administration
(NOAA)</a></td>
<td>US data about: <br> – Droughts <br> – Floods <br> – Freezes <br> –
Severe Storms <br> – Tropical Cyclones <br> – Wildfires<br> – Winter
Storms</td>
<td>NOAA National Centers for Environmental Information (NCEI) U.S.
Billion-Dollar Weather and Climate Disasters (2020). <a
href="https://www.ncdc.noaa.gov/billions/"
class="uri">https://www.ncdc.noaa.gov/billions/</a>, DOI:
10.25921/stkw-7w73</td>
</tr>
<tr class="odd">
<td><strong>Temperature</strong></td>
<td>1895-2019</td>
<td><a href="https://www.ncdc.noaa.gov/cag/national/time-series"
target="_blank">The National Oceanic and Atmospheric Administration
(NOAA)</a></td>
<td><a href="https://www.ncdc.noaa.gov/cag/national/time-series"
target="_blank">The National Oceanic and Atmospheric Administration
(NOAA)</a></td>
<td>US National yearly average temperature (in Fahrenheit) from 1895 to
2019</td>
<td>NOAA National Centers for Environmental information, Climate at a
Glance: National Time Series, published June 2020, retrieved on June 26,
2020 from <a href="https://www.ncdc.noaa.gov/cag/"
class="uri">https://www.ncdc.noaa.gov/cag/</a></td>
</tr>
</tbody>
</table>
<p>To obtain the temperature data, the annual average temperatures were
selected as shown in this image:
<img src="img/temp.png" width="800 px" style="display: block; margin: auto;" /></p>
<div id="source-9" class="section level5">
<h5><a href="https://www.ncdc.noaa.gov/cag/national/time-series"
target="_blank">[source]</a></h5>
<p>Importantly, notice that the data we would like to use span different
time periods:</p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Data</th>
<th>Time span</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>CO2 emissions</strong></td>
<td>1751 to 2014</td>
</tr>
<tr class="even">
<td><strong>GDP per capita (yearly growth)</strong></td>
<td>1801 to 2019</td>
</tr>
<tr class="odd">
<td><strong>Energy use per person</strong></td>
<td>1960 to 2015</td>
</tr>
<tr class="even">
<td><strong>US Natural Disasters</strong></td>
<td>1980 to 2019</td>
</tr>
<tr class="odd">
<td><strong>Temperature</strong></td>
<td>1895 to 2019</td>
</tr>
</tbody>
</table>
<p>We will explore more about this a bit later.</p>
</div>
<div id="section-12" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What concerns might arise about reliability and variation of
measurement practices over time?</p>
</div>
<div id="section-13" class="section level4">
<h4></h4>
</div>
</div>
<div id="data-import" class="section level1">
<h1><strong>Data Import</strong></h1>
<hr />
<p>In our case, we downloaded the data for the files from the various
sources as indicated in the table above and put them within a “raw”
subdirectory of a “data” directory for our project. If you use an
RStudio project, then you can use the <code>here()</code> function of
the <code>here</code> package to make the path for importing this data
simpler. The <code>here</code> package automatically starts looking for
files based on where you have a <code>.Rproj</code> file which is
created when you start a new RStudio project. We can specify that we
want to look for the “yearly_co2_emissions_1000_tonnes.xlsx” file within
the “raw” directory within the “data” directory within a directory where
our <code>.Rproj</code> file is located by separating the names of these
directories using commas and listing “data” first.</p>
<hr />
<details>
<summary>
Click here to see more about creating new projects in RStudio.
</summary>
<p>You can create a project by going to the File menu of RStudio like
so:</p>
<p><img src="img/New_project.png" width="60%" style="display: block; margin: auto;" /></p>
<p>You can also do so by clicking the project button:</p>
<p><img src="img/project_button.png" width="60%" style="display: block; margin: auto;" /></p>
<p>See <a
href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">here</a>
to learn more about using RStudio projects and <a
href="https://github.com/jennybc/here_here">here</a> to learn more about
the <code>here</code> package.</p>
</details>
<hr />
<p>To read in the files that were downloaded from the various sources as
indicated in the table above, we will use the <code>read_xlsx()</code>
and <code>read_xls()</code> functions of the <code>readxl</code> package
to import the data from the <code>.xlsx</code> and <code>.xls</code>
files, respectively. We will also use the <code>here()</code> function
of the <code>here</code> package to more easily specify the path to our
files relative to the directory where the .Rproj file is located.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;yearly_co2_emissions_1000_tonnes.xlsx&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gdp_growth    <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;raw&quot;</span>, <span class="st">&quot;gdp_per_capita_yearly_growth.xlsx&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>energy_use    <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;raw&quot;</span>, <span class="st">&quot;energy_use_per_person.xlsx&quot;</span>))</span></code></pre></div>
<p>If you had trouble downloading these files, you can do so at our <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/raw/">GitHub
repo</a> or more directly by clicking <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/raw/yearly_co2_emissions_1000_tonnes.xlsx">here</a>,
<a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/raw/gdp_per_capita_yearly_growth.xlsx">here</a>,
and <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/raw/energy_use_per_person.xlsx">here</a>.</p>
<p>You may also download these files using the <code>OCSdata</code>
package:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;OCSdata&quot;)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OCSdata)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">raw_data</span>(<span class="st">&quot;ocs-bp-co2-emissions&quot;</span>, <span class="at">outpath =</span> <span class="fu">getwd</span>())</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This will save the raw data files in a &quot;OCSdata/data/raw/&quot; subfolder </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in your current working directory</span></span></code></pre></div>
<p>We will use the <code>read_csv()</code> function of the
<code>readr</code> package to import the data from the <code>.csv</code>
files.</p>
<p>However, for these files there are some lines that we would like to
not import because the number of columns differ for some rows. If we
don’t account for this, then we may end up importing fewer columns of
the data that we would like.</p>
<p>In the first 5 rows shown below in the
<code>data/disasters.csv</code> file, you can see that the first two
rows does not have the same number of columns as the subsequent rows and
are just (sub)titles.</p>
<p><img src="img/Disasters.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>To do this, we can skip rows using the <code>skip = 2</code> argument
of the <code>read_csv()</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;raw&quot;</span>, <span class="st">&quot;disasters.csv&quot;</span>), <span class="at">skip =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>If you had trouble downloading this file, you can do so at our <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/raw">GitHub
repo</a> or more directly by clicking <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/raw/disasters.csv">here</a>.</p>
<p>Now looking at the <code>data/temperature.csv</code> file, we see
that the first four lines do not have the same number of columns as the
subsequent lines.</p>
<p><img src="img/tempdata.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>We will skip importing all 4 lines by using <code>skip = 4</code>. We
can also replace all instances of <code>"-99"</code> with
<code>NA</code> using the <code>na = "-99"</code> argument of the
<code>read_csv()</code> function. The “-99” needs to be in quotation
marks because this argument expects characters.</p>
<hr />
<details>
<summary>
Click here for an explanation about data types in R and about character
strings.
</summary>
<p>There are several <a
href="https://en.wikipedia.org/wiki/R_(programming_language)">classes of
data in R programming</a>, meaning that certain objects will be treated
or interpreted differently. Character is one of these classes. A
character string is an individual data value made up of characters. This
can be a paragraph, like the legend for the table, or it can be a single
letter or number like the letter “a” or the number “3”. If data are of
class character, than the numeric values will not be processed like a
numeric value in a mathematical sense. If you want your numeric values
to be interpreted that way, they need to be converted to a numeric
class. The options typically used are integer (which has no decimal
place) and double precision (which has a decimal place).</p>
<p>A variable that is a factor has a set of particular values called
levels (this can be numbers or characters). Even if these are numeric,
they will be interpreted as levels (i.e., as if they were characters)
not as mathematical numbers. The values of a factor are assumed to have
a particular ordering; by default the order is alphabetical, but this is
not always the correct/intuitive ordering. You can modify the order of
these levels with the <code>forcats</code> package.</p>
</details>
<hr />
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;raw&quot;</span>, <span class="st">&quot;temperature.csv&quot;</span>), <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">na =</span> <span class="st">&quot;-99&quot;</span>)</span></code></pre></div>
<p>If you had trouble downloading this file, you can do so at our <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/raw">GitHub
repo</a> or more directly by clicking <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/raw/temperature.csv">here</a>.</p>
<p>Great! now we have imported all of the data that we will need.</p>
<p>To allow users to skip import we will save the data as an RDA
file:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(CO2_emissions, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>     gdp_growth,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     energy_use, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     us_disaster, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>     us_temperature, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;imported&quot;</span>, <span class="st">&quot;co2_data_imported.rda&quot;</span>))</span></code></pre></div>
</div>
<div id="data-wrangling" class="section level1">
<h1><strong>Data Wrangling</strong></h1>
<hr />
<p>If you have been following along but stopped, we could load our
imported data like so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;imported&quot;</span>, <span class="st">&quot;co2_data_imported.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
If you skipped the data import section click here.
</summary>
<p>First you need to install and load the <code>OCSdata</code>
package:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;OCSdata&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OCSdata)</span></code></pre></div>
<p>Then, you may load the imported data using the following code:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">imported_data</span>(<span class="st">&quot;ocs-bp-co2-emissions&quot;</span>, <span class="at">outpath =</span> <span class="fu">getwd</span>())</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;OCSdata&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;imported&quot;</span>, <span class="st">&quot;co2_data_imported.rda&quot;</span>))</span></code></pre></div>
<p>If the package does not work for you, alternatively, an RDA file
(stands for R data) of the data can be found <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/imported">here</a>
or slightly more directly <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/imported/co2_data_imported.rda">here</a>.
Download this file and then place it in your current working directory
within a subdirectory called “imported” within a directory called “data”
to copy and paste our code. We used an RStudio project and the <a
href="https://github.com/jennybc/here_here"><code>here</code>
package</a> to navigate to the file more easily.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;imported&quot;</span>, <span class="st">&quot;co2_data_imported.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
Click here to see more about creating new projects in RStudio.
</summary>
<p>You can create a project by going to the File menu of RStudio like
so:</p>
<p><img src="img/New_project.png" width="60%" style="display: block; margin: auto;" /></p>
<p>You can also do so by clicking the project button:</p>
<p><img src="img/project_button.png" width="60%" style="display: block; margin: auto;" /></p>
<p>See <a
href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">here</a>
to learn more about using RStudio projects and <a
href="https://github.com/jennybc/here_here">here</a> to learn more about
the <code>here</code> package.</p>
</details>
<hr />
</details>
<hr />
<p>Next, we take a look at our data that we just imported. We will need
to do some data wrangling to allow us to evaluate how CO2 emissions have
changed over time and how emissions may relate to energy use, GDP, etc.
Let’s explore how to do that with useful functions and packages from the
<code>tidyverse</code>.</p>
<div id="yearly-co2-emissions" class="section level2">
<h2><strong>Yearly CO<sub>2</sub> Emissions</strong></h2>
<hr />
<p>First, let’s take a look at the CO2 data
(<code>CO2_emissions</code>). We can use the <code>slice_head()</code>
function of the <code>dplyr</code> package to see just the first rows of
our data. We can specify how many rows we would like to see by using the
<code>n =</code> argument.</p>
<p>We will use the <code>%&gt;%</code> pipe from the
<code>magrittr</code> package (although it is also imported by other
<code>tidyverse</code> packages, like <code>dplyr</code>), which can be
used to define the input for later sequential steps. This will make more
sense when we have multiple sequential steps using the same data
object.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 265
  country  `1751` `1752` `1753` `1754` `1755` `1756` `1757` `1758` `1759` `1760`
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Afghani…     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
2 Albania      NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 Algeria      NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
# … with 254 more variables: `1761` &lt;dbl&gt;, `1762` &lt;dbl&gt;, `1763` &lt;dbl&gt;,
#   `1764` &lt;dbl&gt;, `1765` &lt;dbl&gt;, `1766` &lt;dbl&gt;, `1767` &lt;dbl&gt;, `1768` &lt;dbl&gt;,
#   `1769` &lt;dbl&gt;, `1770` &lt;dbl&gt;, `1771` &lt;dbl&gt;, `1772` &lt;dbl&gt;, `1773` &lt;dbl&gt;,
#   `1774` &lt;dbl&gt;, `1775` &lt;dbl&gt;, `1776` &lt;dbl&gt;, `1777` &lt;dbl&gt;, `1778` &lt;dbl&gt;,
#   `1779` &lt;dbl&gt;, `1780` &lt;dbl&gt;, `1781` &lt;dbl&gt;, `1782` &lt;dbl&gt;, `1783` &lt;dbl&gt;,
#   `1784` &lt;dbl&gt;, `1785` &lt;dbl&gt;, `1786` &lt;dbl&gt;, `1787` &lt;dbl&gt;, `1788` &lt;dbl&gt;,
#   `1789` &lt;dbl&gt;, `1790` &lt;dbl&gt;, `1791` &lt;dbl&gt;, `1792` &lt;dbl&gt;, `1793` &lt;dbl&gt;, …</code></pre>
<p>Another useful function is <code>slice_sample()</code> to look at a
<strong>selection of random rows</strong> using <a
href="https://en.wikipedia.org/wiki/Pseudorandomness"
target="_blank">pseudorandom</a> numbers for the index of rows to show.
To continue to get the same random values or for others to get the same
values, we need to set a seed first. We can do this with the
<code>set.seed()</code> base function. We just specify a number with
this function and that will allow us to get the same subset of values
from the <code>slice_sample()</code> function. If two different people
ran this code (without set.seed()), they would each see a different
subset of rows. For data exploration, this isn’t a huge deal, but if
we’d like separate analysts running the same code to see the same
output, we will use set.seed(). If we changed set.seed(123) to
set.seed(333), we would obtain a different random sample of rows.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 265
  country  `1751` `1752` `1753` `1754` `1755` `1756` `1757` `1758` `1759` `1760`
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Sri Lan…     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
2 Tuvalu       NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 Banglad…     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
# … with 254 more variables: `1761` &lt;dbl&gt;, `1762` &lt;dbl&gt;, `1763` &lt;dbl&gt;,
#   `1764` &lt;dbl&gt;, `1765` &lt;dbl&gt;, `1766` &lt;dbl&gt;, `1767` &lt;dbl&gt;, `1768` &lt;dbl&gt;,
#   `1769` &lt;dbl&gt;, `1770` &lt;dbl&gt;, `1771` &lt;dbl&gt;, `1772` &lt;dbl&gt;, `1773` &lt;dbl&gt;,
#   `1774` &lt;dbl&gt;, `1775` &lt;dbl&gt;, `1776` &lt;dbl&gt;, `1777` &lt;dbl&gt;, `1778` &lt;dbl&gt;,
#   `1779` &lt;dbl&gt;, `1780` &lt;dbl&gt;, `1781` &lt;dbl&gt;, `1782` &lt;dbl&gt;, `1783` &lt;dbl&gt;,
#   `1784` &lt;dbl&gt;, `1785` &lt;dbl&gt;, `1786` &lt;dbl&gt;, `1787` &lt;dbl&gt;, `1788` &lt;dbl&gt;,
#   `1789` &lt;dbl&gt;, `1790` &lt;dbl&gt;, `1791` &lt;dbl&gt;, `1792` &lt;dbl&gt;, `1793` &lt;dbl&gt;, …</code></pre>
<div id="section-14" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try setting a different seed to see the difference in the output.</p>
</div>
<div id="section-15" class="section level4">
<h4></h4>
<p>OK, we see each country is represented along one row and each column
contains yearly CO2 emissions. We also see that there are a lot of
<code>NA</code> values.</p>
<p>We can also use the <code>glimpse()</code> function of the
<code>dplyr</code> package to view our data. This allows us to see all
of our variables at once. We will see a tiny bit of each variable/column
with the data displayed on the right.</p>
</div>
<div id="section-16" class="section level4 scrollable">
<h4 class="scrollable"></h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scroll through the output!</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 192
Columns: 265
$ country &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Albania&quot;, &quot;Algeria&quot;, &quot;Andorra&quot;, &quot;Angola&quot;, &quot;Ant…
$ `1751`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1752`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1753`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1754`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1755`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1756`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1757`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1758`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1759`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1760`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1761`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1762`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1763`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1764`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1765`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1766`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1767`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1768`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1769`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1770`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1771`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1772`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1773`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1774`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1775`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1776`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1777`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1778`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1779`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1780`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1781`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1782`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1783`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1784`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1785`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1786`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1787`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1788`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1789`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1790`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1791`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1792`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1793`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1794`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1795`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1796`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1797`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1798`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1799`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1800`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1801`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1802`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1803`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1804`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1805`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1806`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1807`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 169, NA, NA, NA, NA, NA, N…
$ `1808`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1809`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1810`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1811`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1812`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1813`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1814`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1815`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1816`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1817`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1818`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `1819`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 253, NA, NA, NA, NA, NA, N…
$ `1820`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 334, NA, NA, NA, NA, NA, N…
$ `1821`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 359, NA, NA, NA, NA, NA, N…
$ `1822`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 367, NA, NA, NA, NA, NA, N…
$ `1823`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 348, NA, NA, NA, NA, NA, N…
$ `1824`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 400, NA, NA, NA, NA, NA, N…
$ `1825`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 403, NA, NA, NA, NA, NA, N…
$ `1826`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 458, NA, NA, NA, NA, NA, N…
$ `1827`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 477, NA, NA, NA, NA, NA, N…
$ `1828`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 458, NA, NA, NA, NA, NA, N…
$ `1829`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 477, NA, NA, NA, NA, NA, N…
$ `1830`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 0.032, NA, 495.000, 0.308, NA, NA,…
$ `1831`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 3.84e-02, NA, 4.80e+02, 3.70e-01, …
$ `1832`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 2.56e-02, NA, 5.13e+02, 2.47e-01, …
$ `1833`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 0.032, NA, 429.000, 0.308, NA, NA,…
$ `1834`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 587, NA, NA, NA, NA, NA, N…
$ `1835`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 634, NA, NA, NA, NA, NA, N…
$ `1836`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 675, NA, NA, NA, NA, NA, N…
$ `1837`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 708, NA, NA, NA, NA, NA, N…
$ `1838`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 851, NA, NA, NA, NA, NA, N…
$ `1839`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1060, NA, NA, NA, NA, NA, …
$ `1840`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1170, NA, NA, NA, NA, NA, …
$ `1841`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1320, NA, NA, NA, NA, NA, …
$ `1842`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1460, NA, NA, NA, NA, NA, …
$ `1843`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1270, NA, NA, NA, NA, NA, …
$ `1844`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1600, NA, NA, NA, NA, NA, …
$ `1845`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 1800, NA, NA, NA, NA, NA, …
$ `1846`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2120, NA, NA, NA, NA, NA, …
$ `1847`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2080, NA, NA, NA, NA, NA, …
$ `1848`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2340, NA, NA, NA, NA, NA, …
$ `1849`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2260, NA, NA, NA, NA, NA, …
$ `1850`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 0.198, NA, 2330.000, 1.910, NA, NA…
$ `1851`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2340, NA, NA, NA, NA, NA, …
$ `1852`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 2810, NA, NA, NA, NA, NA, …
$ `1853`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 3230, NA, NA, NA, NA, NA, …
$ `1854`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 3180, NA, NA, NA, NA, NA, …
$ `1855`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 6.01e-01, NA, 3.70e+03, 5.80e+00, …
$ `1856`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 4240, NA, NA, NA, NA, NA, …
$ `1857`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 4880, NA, NA, NA, NA, NA, …
$ `1858`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 8.44e-01, NA, 7.25e+03, 8.14e+00, …
$ `1859`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 8.95e-01, NA, 5.87e+03, 8.64e+00, …
$ `1860`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.18, 279.00, 6150.00, 11.40, NA, …
$ `1861`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.5, 510.0, 6380.0, 14.5, NA, NA, …
$ `1862`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.36, 356.00, 6360.00, 13.10, NA, …
$ `1863`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.42, 400.00, 5880.00, 13.70, NA, …
$ `1864`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.59, 268.00, 5080.00, 15.40, NA, …
$ `1865`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 1.52, 422.00, 5360.00, 14.70, NA, …
$ `1866`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 4.81, 697.00, 3600.00, 46.40, NA, …
$ `1867`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 5.52, 895.00, 4920.00, 53.20, NA, …
$ `1868`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 4.59, 733.00, 6080.00, 44.30, NA, …
$ `1869`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 6.23, 642.00, 6490.00, 60.10, NA, …
$ `1870`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 6.76, 601.00, 7370.00, 65.20, NA, …
$ `1871`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 9.12, 693.00, 10200.00, 88.00, NA,…
$ `1872`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 9.36, 708.00, 10000.00, 90.40, NA,…
$ `1873`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 8.79, 869.00, 10700.00, 84.80, NA,…
$ `1874`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 10.7, 891.0, 9160.0, 103.0, NA, NA…
$ `1875`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 12.3, 829.0, 7870.0, 119.0, NA, NA…
$ `1876`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 15.2, 931.0, 8100.0, 147.0, NA, NA…
$ `1877`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 15.6, 1070.0, 7290.0, 150.0, NA, N…
$ `1878`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 20.3, 968.0, 7250.0, 196.0, NA, NA…
$ `1879`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 20.9, 1460.0, 8870.0, 201.0, NA, N…
$ `1880`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 24.5, 2210.0, 23700.0, 236.0, NA, …
$ `1881`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 25.80, 1770.00, 10300.00, 249.00, …
$ `1882`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 27.20, 2010.00, 10600.00, 262.00, …
$ `1883`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 30.90, 2430.00, 11800.00, 298.00, …
$ `1884`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 31.4, 2570.0, 11500.0, 303.0, NA, …
$ `1885`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 34.20, 2910.00, 12100.00, 330.00, …
$ `1886`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 35.10, 2890.00, 11400.00, 338.00, …
$ `1887`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1090.0, 37.1, 3040.0, 12300.0, 358.0, …
$ `1888`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 891.0, 38.7, 3530.0, 12000.0, 373.0, N…
$ `1889`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1760.0, 41.8, 3430.0, 12900.0, 403.0, …
$ `1890`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1370.0, 47.3, 3550.0, 13000.0, 457.0, …
$ `1891`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 939.0, 52.1, 4010.0, 15000.0, 503.0, N…
$ `1892`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1390.0, 55.1, 4150.0, 14500.0, 532.0, …
$ `1893`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1550.0, 64.6, 3970.0, 17700.0, 624.0, …
$ `1894`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 1990.0, 65.8, 4360.0, 18100.0, 635.0, …
$ `1895`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2270.0, 75.6, 4590.0, 20400.0, 730.0, …
$ `1896`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2310, 77, 4510, 21300, 743, NA, NA, NA…
$ `1897`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2080, 89, 4980, 23000, 859, NA, NA, NA…
$ `1898`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2350.0, 99.9, 5620.0, 24500.0, 964.0, …
$ `1899`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2920, 116, 5790, 24800, 1120, NA, NA, …
$ `1900`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2070, 131, 10200, 27700, 1270, NA, NA,…
$ `1901`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2490, 135, 11400, 28400, 1300, NA, NA,…
$ `1902`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2820, 130, 11400, 25700, 1260, NA, NA,…
$ `1903`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 2860, 127, 11200, 25600, 1230, NA, NA,…
$ `1904`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3800, 142, 11600, 26900, 1370, NA, NA,…
$ `1905`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3990, 126, 12100, 28100, 1220, NA, NA,…
$ `1906`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6260, 144, 14400, 33600, 1390, NA, NA,…
$ `1907`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6260, 161, 15500, 42200, 1560, NA, NA,…
$ `1908`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 7620, 162, 16800, 59000, 1570, NA, NA,…
$ `1909`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 5940, 172, 14600, 42200, 1660, NA, NA,…
$ `1910`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 8910, 168, 17500, 57600, 1620, NA, NA,…
$ `1911`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 9950, 174, 19300, 48100, 1680, NA, NA,…
$ `1912`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 9490, 198, 20800, 50000, 1910, NA, NA,…
$ `1913`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 10200, 215, 22400, 59700, 2070, NA, NA…
$ `1914`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 8680, 194, 24500, 48900, 1870, NA, NA,…
$ `1915`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 6950, 178, 21800, 34900, 1720, NA, NA,…
$ `1916`  &lt;dbl&gt; NA, NA, 3.67, NA, NA, NA, 4990.00, 189.00, 19300.00, 8040.00, …
$ `1917`  &lt;dbl&gt; NA, NA, 7.33, NA, NA, NA, 2230.00, 174.00, 20800.00, 3450.00, …
$ `1918`  &lt;dbl&gt; NA, NA, 18.3, NA, NA, NA, 2520.0, 69.5, 23000.0, 3340.0, 671.0…
$ `1919`  &lt;dbl&gt; NA, NA, 18.3, NA, NA, NA, 3730.0, 59.4, 21800.0, 3020.0, 573.0…
$ `1920`  &lt;dbl&gt; NA, NA, 22.0, NA, NA, NA, 5900.0, 54.2, 25800.0, 14500.0, 523.…
$ `1921`  &lt;dbl&gt; NA, NA, 25.7, NA, NA, NA, 5540.0, 58.7, 23200.0, 19400.0, 567.…
$ `1922`  &lt;dbl&gt; NA, NA, 25.7, NA, NA, NA, 7300.0, 71.6, 24400.0, 18600.0, 692.…
$ `1923`  &lt;dbl&gt; NA, NA, 14.7, NA, NA, NA, 8450.0, 79.1, 24900.0, 17800.0, 764.…
$ `1924`  &lt;dbl&gt; NA, NA, 29.3, NA, NA, NA, 11000.0, 94.3, 27100.0, 20100.0, 910…
$ `1925`  &lt;dbl&gt; NA, NA, 33.0, NA, NA, NA, 11200.0, 93.1, 28300.0, 19000.0, 898…
$ `1926`  &lt;dbl&gt; NA, NA, 40.3, NA, NA, NA, 11300.0, 135.0, 27900.0, 18600.0, 13…
$ `1927`  &lt;dbl&gt; NA, NA, 58.7, NA, NA, NA, 13400.0, 168.0, 28900.0, 20100.0, 16…
$ `1928`  &lt;dbl&gt; NA, NA, 73.30, NA, NA, NA, 12800.00, 186.00, 26300.00, 21200.0…
$ `1929`  &lt;dbl&gt; NA, NA, 80.70, NA, NA, NA, 13100.00, 201.00, 23700.00, 24200.0…
$ `1930`  &lt;dbl&gt; NA, NA, 84.30, NA, NA, NA, 12800.00, 273.00, 22000.00, 18900.0…
$ `1931`  &lt;dbl&gt; NA, NA, 99.00, NA, NA, NA, 12900.00, 328.00, 19600.00, 18100.0…
$ `1932`  &lt;dbl&gt; NA, NA, 114.00, NA, NA, NA, 13100.00, 369.00, 20400.00, 15200.…
$ `1933`  &lt;dbl&gt; NA, 7.33, 121.00, NA, NA, NA, 13200.00, 412.00, 21600.00, 1420…
$ `1934`  &lt;dbl&gt; NA, 7.33, 139.00, NA, NA, NA, 14300.00, 499.00, 22700.00, 1380…
$ `1935`  &lt;dbl&gt; NA, 18.3, 132.0, NA, NA, NA, 14000.0, 565.0, 25300.0, 13900.0,…
$ `1936`  &lt;dbl&gt; NA, 128.0, 51.3, NA, NA, NA, 15100.0, 648.0, 27100.0, 13600.0,…
$ `1937`  &lt;dbl&gt; NA, 297.0, 69.7, NA, NA, NA, 16700.0, 662.0, 28900.0, 15300.0,…
$ `1938`  &lt;dbl&gt; NA, 348, 33, NA, NA, NA, 16400, 699, 28100, 5790, 6750, NA, 34…
$ `1939`  &lt;dbl&gt; NA, 433.00, 161.00, NA, NA, NA, 17400.00, 707.00, 32200.00, 63…
$ `1940`  &lt;dbl&gt; NA, 693, 238, NA, NA, NA, 15900, 848, 29100, 7350, 8190, NA, 2…
$ `1941`  &lt;dbl&gt; NA, 627, 312, NA, NA, NA, 14000, 745, 34600, 7980, 7190, NA, 2…
$ `1942`  &lt;dbl&gt; NA, 744, 499, NA, NA, NA, 13500, 513, 36500, 8560, 4950, NA, 2…
$ `1943`  &lt;dbl&gt; NA, 462, 469, NA, NA, NA, 14100, 655, 35000, 9620, 6320, NA, 2…
$ `1944`  &lt;dbl&gt; NA, 154, 499, NA, NA, NA, 14000, 613, 34200, 9400, 5920, NA, 2…
$ `1945`  &lt;dbl&gt; NA, 121, 616, NA, NA, NA, 13700, 649, 32700, 4570, 6270, NA, 3…
$ `1946`  &lt;dbl&gt; NA, 484, 763, NA, NA, NA, 13700, 730, 35500, 12800, 7040, NA, …
$ `1947`  &lt;dbl&gt; NA, 928.00, 744.00, NA, NA, NA, 14500.00, 878.00, 38000.00, 17…
$ `1948`  &lt;dbl&gt; NA, 704.00, 803.00, NA, NA, NA, 17400.00, 935.00, 38500.00, 24…
$ `1949`  &lt;dbl&gt; 14.70, 1020.00, 909.00, NA, NA, NA, 15400.00, 1060.00, 37700.0…
$ `1950`  &lt;dbl&gt; 84.3, 297.0, 3790.0, NA, 187.0, NA, 30000.0, 1180.0, 54800.0, …
$ `1951`  &lt;dbl&gt; 91.7, 403.0, 4140.0, NA, 249.0, NA, 35000.0, 1280.0, 59100.0, …
$ `1952`  &lt;dbl&gt; 91.7, 374.0, 3890.0, NA, 312.0, NA, 36100.0, 1370.0, 60300.0, …
$ `1953`  &lt;dbl&gt; 106.0, 414.0, 4000.0, NA, 275.0, NA, 35200.0, 1450.0, 59500.0,…
$ `1954`  &lt;dbl&gt; 106.0, 502.0, 4160.0, NA, 348.0, NA, 36800.0, 1590.0, 67900.0,…
$ `1955`  &lt;dbl&gt; 154.0, 664.0, 4610.0, NA, 414.0, NA, 39600.0, 1800.0, 70700.0,…
$ `1956`  &lt;dbl&gt; 183.0, 840.0, 5000.0, NA, 502.0, NA, 44300.0, 1970.0, 73100.0,…
$ `1957`  &lt;dbl&gt; 293.0, 1510.0, 5540.0, NA, 620.0, 22.0, 47700.0, 2160.0, 74600…
$ `1958`  &lt;dbl&gt; 330.0, 1200.0, 5220.0, NA, 594.0, 29.3, 44200.0, 2310.0, 77700…
$ `1959`  &lt;dbl&gt; 385.0, 1440.0, 5670.0, NA, 620.0, 29.3, 49000.0, 2430.0, 83800…
$ `1960`  &lt;dbl&gt; 414.0, 2020.0, 6160.0, NA, 550.0, 36.7, 48800.0, 2530.0, 88200…
$ `1961`  &lt;dbl&gt; 491.0, 2280.0, 6070.0, NA, 455.0, 47.7, 51200.0, 2600.0, 90600…
$ `1962`  &lt;dbl&gt; 689.0, 2460.0, 5670.0, NA, 1180.0, 103.0, 53700.0, 2730.0, 949…
$ `1963`  &lt;dbl&gt; 708.0, 2080.0, 5430.0, NA, 1150.0, 84.3, 50100.0, 2930.0, 1010…
$ `1964`  &lt;dbl&gt; 840.0, 2020.0, 5650.0, NA, 1220.0, 91.7, 55700.0, 3120.0, 1090…
$ `1965`  &lt;dbl&gt; 1010.0, 2170.0, 6600.0, NA, 1190.0, 150.0, 58900.0, 3310.0, 12…
$ `1966`  &lt;dbl&gt; 1090.0, 2550.0, 8430.0, NA, 1550.0, 348.0, 63100.0, 3490.0, 12…
$ `1967`  &lt;dbl&gt; 1280, 2680, 8440, NA, 994, 565, 65500, 3650, 129000, 40000, 35…
$ `1968`  &lt;dbl&gt; 1220, 3070, 9060, NA, 1670, 990, 69100, 3750, 135000, 42400, 3…
$ `1969`  &lt;dbl&gt; 942, 3250, 11300, NA, 2790, 1260, 77300, 3910, 142000, 44700, …
$ `1970`  &lt;dbl&gt; 1.67e+03, 3.74e+03, 1.51e+04, NA, 3.58e+03, 4.62e+02, 8.27e+04…
$ `1971`  &lt;dbl&gt; 1.90e+03, 4.35e+03, 1.87e+04, NA, 3.41e+03, 4.25e+02, 8.89e+04…
$ `1972`  &lt;dbl&gt; 1.53e+03, 5.64e+03, 2.83e+04, NA, 4.51e+03, 3.74e+02, 9.02e+04…
$ `1973`  &lt;dbl&gt; 1.64e+03, 5.29e+03, 3.83e+04, NA, 4.88e+03, 3.30e+02, 9.41e+04…
$ `1974`  &lt;dbl&gt; 1.92e+03, 4.35e+03, 3.19e+04, NA, 4.87e+03, 4.29e+02, 9.56e+04…
$ `1975`  &lt;dbl&gt; 2.13e+03, 4.59e+03, 3.20e+04, NA, 4.42e+03, 7.08e+02, 9.49e+04…
$ `1976`  &lt;dbl&gt; 1.99e+03, 4.95e+03, 3.92e+04, NA, 3.29e+03, 4.03e+02, 9.98e+04…
$ `1977`  &lt;dbl&gt; 2.39e+03, 5.72e+03, 4.19e+04, NA, 3.53e+03, 4.66e+02, 1.01e+05…
$ `1978`  &lt;dbl&gt; 2160, 6490, 62500, NA, 5410, 491, 103000, 5810, 202000, 57500,…
$ `1979`  &lt;dbl&gt; 2240, 7590, 45600, NA, 5500, 407, 111000, 5850, 205000, 61600,…
$ `1980`  &lt;dbl&gt; 1760, 5170, 66500, NA, 5350, 143, 109000, 6080, 221000, 52300,…
$ `1981`  &lt;dbl&gt; 1980.0, 7340.0, 46400.0, NA, 5280.0, 106.0, 102000.0, 5970.0, …
$ `1982`  &lt;dbl&gt; 2100, 7310, 39300, NA, 4650, 293, 103000, 6080, 234000, 53900,…
$ `1983`  &lt;dbl&gt; 2520.0, 7630.0, 52600.0, NA, 5120.0, 84.3, 105000.0, 6170.0, 2…
$ `1984`  &lt;dbl&gt; 2830.0, 7830.0, 71100.0, NA, 5010.0, 147.0, 107000.0, 6230.0, …
$ `1985`  &lt;dbl&gt; 3510.0, 7880.0, 72800.0, NA, 4700.0, 249.0, 101000.0, 6710.0, …
$ `1986`  &lt;dbl&gt; 3140, 8060, 76300, NA, 4660, 249, 104000, 6730, 240000, 54100,…
$ `1987`  &lt;dbl&gt; 3120, 7440, 84100, NA, 5820, 275, 115000, 7020, 256000, 57700,…
$ `1988`  &lt;dbl&gt; 2870, 7330, 83900, NA, 5130, 286, 121000, 7210, 261000, 53300,…
$ `1989`  &lt;dbl&gt; 2780.0, 8980.0, 80000.0, NA, 5010.0, 286.0, 117000.0, 7060.0, …
$ `1990`  &lt;dbl&gt; 2610, 5520, 77000, 407, 5120, 282, 112000, 6620, 264000, 57700…
$ `1991`  &lt;dbl&gt; 2440, 4290, 79000, 407, 5090, 268, 117000, 6380, 261000, 61600…
$ `1992`  &lt;dbl&gt; 1390, 2520, 80100, 407, 5200, 264, 121000, 5830, 268000, 56700…
$ `1993`  &lt;dbl&gt; 1350, 2340, 82200, 411, 5780, 271, 118000, 2560, 277000, 57100…
$ `1994`  &lt;dbl&gt; 1290, 1930, 86400, 407, 3890, 268, 122000, 2710, 278000, 57100…
$ `1995`  &lt;dbl&gt; 1240, 2090, 95300, 425, 11000, 275, 128000, 3410, 282000, 5980…
$ `1996`  &lt;dbl&gt; 1180, 2020, 97100, 455, 10500, 293, 135000, 2560, 302000, 6320…
$ `1997`  &lt;dbl&gt; 1100, 1540, 87300, 466, 7380, 308, 138000, 3230, 306000, 62700…
$ `1998`  &lt;dbl&gt; 1040, 1750, 107000, 491, 7310, 319, 140000, 3360, 317000, 6370…
$ `1999`  &lt;dbl&gt; 821, 2980, 92000, 513, 9160, 330, 147000, 3010, 325000, 61900,…
$ `2000`  &lt;dbl&gt; 774, 3020, 87900, 524, 9540, 345, 142000, 3470, 329000, 62300,…
$ `2001`  &lt;dbl&gt; 818, 3220, 84200, 524, 9730, 348, 134000, 3540, 325000, 65900,…
$ `2002`  &lt;dbl&gt; 1070, 3750, 89900, 532, 12700, 370, 125000, 3040, 341000, 6710…
$ `2003`  &lt;dbl&gt; 1200, 4290, 91600, 535, 9060, 403, 135000, 3430, 336000, 72200…
$ `2004`  &lt;dbl&gt; 950, 4170, 88500, 561, 18800, 422, 158000, 3640, 343000, 72400…
$ `2005`  &lt;dbl&gt; 1330, 4250, 107000, 576, 19200, 429, 162000, 4350, 350000, 742…
$ `2006`  &lt;dbl&gt; 1650, 3900, 101000, 546, 22300, 444, 175000, 4380, 365000, 722…
$ `2007`  &lt;dbl&gt; 2270, 3930, 109000, 539, 25200, 469, 175000, 5060, 372000, 697…
$ `2008`  &lt;dbl&gt; 4210, 4370, 110000, 539, 25700, 480, 189000, 5560, 386000, 690…
$ `2009`  &lt;dbl&gt; 6770, 4380, 121000, 517, 27800, 510, 180000, 4360, 395000, 627…
$ `2010`  &lt;dbl&gt; 8460, 4600, 119000, 517, 29100, 524, 188000, 4220, 391000, 675…
$ `2011`  &lt;dbl&gt; 12200, 5240, 121000, 491, 30300, 513, 192000, 4920, 392000, 65…
$ `2012`  &lt;dbl&gt; 10800, 4910, 130000, 488, 33400, 524, 192000, 5690, 388000, 62…
$ `2013`  &lt;dbl&gt; 10000, 5060, 134000, 477, 32600, 524, 190000, 5500, 372000, 62…
$ `2014`  &lt;dbl&gt; 9810, 5720, 145000, 462, 34800, 532, 204000, 5530, 361000, 587…</code></pre>
</div>
<div id="section-17" class="section level4">
<h4></h4>
<p>We can also see that we have a large <a
href="https://tibble.tidyverse.org/">tibble</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>()</span></code></pre></div>
<pre><code>[1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>This is the object that is created when we read in the data with
<code>readr</code>. A tibble (or <code>tbl_df</code>) is the
<code>tidyverse</code> version of a <code>data.frame</code> object.
Similar to <code>data.frame</code>, it is a table with variable
information arranged as columns, and individual observations arranged as
rows. However some nice differences are they do not change variable
names or data types and they give more messages when something is wrong
(e.g. when a variable does not exist), which forces the analyst to
confront problems earlier. Tibbles also give us information about the
class of each variable.</p>
<p>For example the <code>country</code> variable is made up of character
(abbreviated as <code>chr</code>) values.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country)</span></code></pre></div>
<pre><code># A tibble: 192 × 1
   country            
   &lt;chr&gt;              
 1 Afghanistan        
 2 Albania            
 3 Algeria            
 4 Andorra            
 5 Angola             
 6 Antigua and Barbuda
 7 Argentina          
 8 Armenia            
 9 Australia          
10 Austria            
# … with 182 more rows</code></pre>
<p>We see that we have 192 rows different country variables and CO2
emission values for 264 different years (from 1751 to 2014).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(CO2_emissions)</span></code></pre></div>
<pre><code>  [1] &quot;country&quot; &quot;1751&quot;    &quot;1752&quot;    &quot;1753&quot;    &quot;1754&quot;    &quot;1755&quot;    &quot;1756&quot;   
  [8] &quot;1757&quot;    &quot;1758&quot;    &quot;1759&quot;    &quot;1760&quot;    &quot;1761&quot;    &quot;1762&quot;    &quot;1763&quot;   
 [15] &quot;1764&quot;    &quot;1765&quot;    &quot;1766&quot;    &quot;1767&quot;    &quot;1768&quot;    &quot;1769&quot;    &quot;1770&quot;   
 [22] &quot;1771&quot;    &quot;1772&quot;    &quot;1773&quot;    &quot;1774&quot;    &quot;1775&quot;    &quot;1776&quot;    &quot;1777&quot;   
 [29] &quot;1778&quot;    &quot;1779&quot;    &quot;1780&quot;    &quot;1781&quot;    &quot;1782&quot;    &quot;1783&quot;    &quot;1784&quot;   
 [36] &quot;1785&quot;    &quot;1786&quot;    &quot;1787&quot;    &quot;1788&quot;    &quot;1789&quot;    &quot;1790&quot;    &quot;1791&quot;   
 [43] &quot;1792&quot;    &quot;1793&quot;    &quot;1794&quot;    &quot;1795&quot;    &quot;1796&quot;    &quot;1797&quot;    &quot;1798&quot;   
 [50] &quot;1799&quot;    &quot;1800&quot;    &quot;1801&quot;    &quot;1802&quot;    &quot;1803&quot;    &quot;1804&quot;    &quot;1805&quot;   
 [57] &quot;1806&quot;    &quot;1807&quot;    &quot;1808&quot;    &quot;1809&quot;    &quot;1810&quot;    &quot;1811&quot;    &quot;1812&quot;   
 [64] &quot;1813&quot;    &quot;1814&quot;    &quot;1815&quot;    &quot;1816&quot;    &quot;1817&quot;    &quot;1818&quot;    &quot;1819&quot;   
 [71] &quot;1820&quot;    &quot;1821&quot;    &quot;1822&quot;    &quot;1823&quot;    &quot;1824&quot;    &quot;1825&quot;    &quot;1826&quot;   
 [78] &quot;1827&quot;    &quot;1828&quot;    &quot;1829&quot;    &quot;1830&quot;    &quot;1831&quot;    &quot;1832&quot;    &quot;1833&quot;   
 [85] &quot;1834&quot;    &quot;1835&quot;    &quot;1836&quot;    &quot;1837&quot;    &quot;1838&quot;    &quot;1839&quot;    &quot;1840&quot;   
 [92] &quot;1841&quot;    &quot;1842&quot;    &quot;1843&quot;    &quot;1844&quot;    &quot;1845&quot;    &quot;1846&quot;    &quot;1847&quot;   
 [99] &quot;1848&quot;    &quot;1849&quot;    &quot;1850&quot;    &quot;1851&quot;    &quot;1852&quot;    &quot;1853&quot;    &quot;1854&quot;   
[106] &quot;1855&quot;    &quot;1856&quot;    &quot;1857&quot;    &quot;1858&quot;    &quot;1859&quot;    &quot;1860&quot;    &quot;1861&quot;   
[113] &quot;1862&quot;    &quot;1863&quot;    &quot;1864&quot;    &quot;1865&quot;    &quot;1866&quot;    &quot;1867&quot;    &quot;1868&quot;   
[120] &quot;1869&quot;    &quot;1870&quot;    &quot;1871&quot;    &quot;1872&quot;    &quot;1873&quot;    &quot;1874&quot;    &quot;1875&quot;   
[127] &quot;1876&quot;    &quot;1877&quot;    &quot;1878&quot;    &quot;1879&quot;    &quot;1880&quot;    &quot;1881&quot;    &quot;1882&quot;   
[134] &quot;1883&quot;    &quot;1884&quot;    &quot;1885&quot;    &quot;1886&quot;    &quot;1887&quot;    &quot;1888&quot;    &quot;1889&quot;   
[141] &quot;1890&quot;    &quot;1891&quot;    &quot;1892&quot;    &quot;1893&quot;    &quot;1894&quot;    &quot;1895&quot;    &quot;1896&quot;   
[148] &quot;1897&quot;    &quot;1898&quot;    &quot;1899&quot;    &quot;1900&quot;    &quot;1901&quot;    &quot;1902&quot;    &quot;1903&quot;   
[155] &quot;1904&quot;    &quot;1905&quot;    &quot;1906&quot;    &quot;1907&quot;    &quot;1908&quot;    &quot;1909&quot;    &quot;1910&quot;   
[162] &quot;1911&quot;    &quot;1912&quot;    &quot;1913&quot;    &quot;1914&quot;    &quot;1915&quot;    &quot;1916&quot;    &quot;1917&quot;   
[169] &quot;1918&quot;    &quot;1919&quot;    &quot;1920&quot;    &quot;1921&quot;    &quot;1922&quot;    &quot;1923&quot;    &quot;1924&quot;   
[176] &quot;1925&quot;    &quot;1926&quot;    &quot;1927&quot;    &quot;1928&quot;    &quot;1929&quot;    &quot;1930&quot;    &quot;1931&quot;   
[183] &quot;1932&quot;    &quot;1933&quot;    &quot;1934&quot;    &quot;1935&quot;    &quot;1936&quot;    &quot;1937&quot;    &quot;1938&quot;   
[190] &quot;1939&quot;    &quot;1940&quot;    &quot;1941&quot;    &quot;1942&quot;    &quot;1943&quot;    &quot;1944&quot;    &quot;1945&quot;   
[197] &quot;1946&quot;    &quot;1947&quot;    &quot;1948&quot;    &quot;1949&quot;    &quot;1950&quot;    &quot;1951&quot;    &quot;1952&quot;   
[204] &quot;1953&quot;    &quot;1954&quot;    &quot;1955&quot;    &quot;1956&quot;    &quot;1957&quot;    &quot;1958&quot;    &quot;1959&quot;   
[211] &quot;1960&quot;    &quot;1961&quot;    &quot;1962&quot;    &quot;1963&quot;    &quot;1964&quot;    &quot;1965&quot;    &quot;1966&quot;   
[218] &quot;1967&quot;    &quot;1968&quot;    &quot;1969&quot;    &quot;1970&quot;    &quot;1971&quot;    &quot;1972&quot;    &quot;1973&quot;   
[225] &quot;1974&quot;    &quot;1975&quot;    &quot;1976&quot;    &quot;1977&quot;    &quot;1978&quot;    &quot;1979&quot;    &quot;1980&quot;   
[232] &quot;1981&quot;    &quot;1982&quot;    &quot;1983&quot;    &quot;1984&quot;    &quot;1985&quot;    &quot;1986&quot;    &quot;1987&quot;   
[239] &quot;1988&quot;    &quot;1989&quot;    &quot;1990&quot;    &quot;1991&quot;    &quot;1992&quot;    &quot;1993&quot;    &quot;1994&quot;   
[246] &quot;1995&quot;    &quot;1996&quot;    &quot;1997&quot;    &quot;1998&quot;    &quot;1999&quot;    &quot;2000&quot;    &quot;2001&quot;   
[253] &quot;2002&quot;    &quot;2003&quot;    &quot;2004&quot;    &quot;2005&quot;    &quot;2006&quot;    &quot;2007&quot;    &quot;2008&quot;   
[260] &quot;2009&quot;    &quot;2010&quot;    &quot;2011&quot;    &quot;2012&quot;    &quot;2013&quot;    &quot;2014&quot;   </code></pre>
<p>Recall, the values are emissions in metric tons, also called tonnes.
Scrolling through the <code>glimpse()</code> function above, we can also
see that there are fewer <code>NA</code> values for later years.</p>
<p>In this next code chunk, we will introduce the
<code>%&lt;&gt;%</code> operator from the <code>magrittr</code> package.
This allows us to use our <code>CO2_emissions</code> data and reassign
it to a modified version at the same time. Let’s modify
<code>CO2_emissions</code> to make it more usable for making
visualizations. Specifically, we will use the
<code>pivot_longer()</code> function of the <code>dplyr</code> package
to convert our data into what is called <strong>“long”</strong> format.
This is also sometimes referred to as <strong>“narrow”</strong>
format.</p>
<p>This means that we will have more rows and fewer columns than our
current format.</p>
<p>Right now our data is in what is called <strong>“wide”</strong>
format. In wide format, each variable is listed as its own column. In
contrast, in long format, variables maybe collapsed into a column that
identifies the variables and a column of values. See <a
href="https://en.wikipedia.org/wiki/Wide_and_narrow_data"
target="_blank">here</a> for more information about the difference
between the two formats.</p>
<p>We want to collapse all of the values for the emission data across
the different individual year variables into one new
<code>Emissions</code> variable. We will identify what year they are
from by creating a new <code>Year</code> variable. The
<code>cols =</code> argument allows us to specify which columns we want
to pivot (or not pivot) to create these new columns. We want to keep our
<code>country</code> data as an ID variable so we will exclude it using
the <code>-</code> sign, by default all other columns will be used.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions  <span class="sc">%&lt;&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Emissions&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
  country     Year  Emissions
  &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
1 Bahamas     1832       NA  
2 Montenegro  1843       NA  
3 Mongolia    1892       NA  
4 Samoa       1791       NA  
5 Azerbaijan  1867       53.2
6 Timor-Leste 2010      235  </code></pre>
</div>
<div id="section-18" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Think a moment about what the dimensions of the
<code>CO2_emissions</code> tibble are now and why? How would you check
this?</p>
<p><b><u> Hint </u></b>: Checking has something to do with a unique
aspect about tibbles.</p>
</div>
<div id="section-19" class="section level4">
<h4></h4>
<p>Let’s say we also want to rename the <code>country</code> variable to
be capitalized. To do this, we can use the <code>rename()</code>
function of the <code>dplyr</code> package to rename this variable. When
renaming variables the syntax is <code>new-name = old-name</code>, where
the new name is listed first before the <code>=</code>.</p>
<p>You may also note that the <code>Year</code> variable is currently of
class type character. We would like to change it to be numeric. To do
this we will use the <code>mutate()</code> function, which is also part
of the <code>dplyr</code> package. This function allows us to create and
modify variables. We will also use this function to create a variable
called <code>Label</code> which will have
<code>"CO2 Emissions (Metric Tons)"</code> as the value for every row,
to be used when we create plots later.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>CO2_emissions  <span class="sc">%&lt;&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Country =</span> country) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(Year),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Label =</span> <span class="st">&quot;CO2 Emissions (Metric Tons)&quot;</span>)</span></code></pre></div>
<p>Now let’s take a look to see how our data has changed:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 4
  Country      Year Emissions Label                      
  &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                      
1 Bahamas      1832      NA   CO2 Emissions (Metric Tons)
2 Montenegro   1843      NA   CO2 Emissions (Metric Tons)
3 Mongolia     1892      NA   CO2 Emissions (Metric Tons)
4 Samoa        1791      NA   CO2 Emissions (Metric Tons)
5 Azerbaijan   1867      53.2 CO2 Emissions (Metric Tons)
6 Timor-Leste  2010     235   CO2 Emissions (Metric Tons)</code></pre>
<p>Great, we can see that now the <code>Year</code> variable is of class
double (abbreviated <code>dbl</code>), which is a numeric class.</p>
<p>Now, let’s take a look at the <code>Country</code> variable to check
if there is anything unexpected. We will use the <code>distinct()</code>
function of the <code>dplyr</code> package to view the unique values
only. Finally, we use the <code>pull()</code> function of the
<code>dplyr</code> package to extract the values from the column (this
is similar to using the <code>$</code> base R syntax
e.g. <code>CO2_emission$Country</code>).</p>
</div>
<div id="section-20" class="section level4 scrollable">
<h4 class="scrollable"></h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scroll through the output!</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code></pre></div>
<pre><code>  [1] &quot;Afghanistan&quot;                    &quot;Albania&quot;                       
  [3] &quot;Algeria&quot;                        &quot;Andorra&quot;                       
  [5] &quot;Angola&quot;                         &quot;Antigua and Barbuda&quot;           
  [7] &quot;Argentina&quot;                      &quot;Armenia&quot;                       
  [9] &quot;Australia&quot;                      &quot;Austria&quot;                       
 [11] &quot;Azerbaijan&quot;                     &quot;Bahamas&quot;                       
 [13] &quot;Bahrain&quot;                        &quot;Bangladesh&quot;                    
 [15] &quot;Barbados&quot;                       &quot;Belarus&quot;                       
 [17] &quot;Belgium&quot;                        &quot;Belize&quot;                        
 [19] &quot;Benin&quot;                          &quot;Bhutan&quot;                        
 [21] &quot;Bolivia&quot;                        &quot;Bosnia and Herzegovina&quot;        
 [23] &quot;Botswana&quot;                       &quot;Brazil&quot;                        
 [25] &quot;Brunei&quot;                         &quot;Bulgaria&quot;                      
 [27] &quot;Burkina Faso&quot;                   &quot;Burundi&quot;                       
 [29] &quot;Cambodia&quot;                       &quot;Cameroon&quot;                      
 [31] &quot;Canada&quot;                         &quot;Cape Verde&quot;                    
 [33] &quot;Central African Republic&quot;       &quot;Chad&quot;                          
 [35] &quot;Chile&quot;                          &quot;China&quot;                         
 [37] &quot;Colombia&quot;                       &quot;Comoros&quot;                       
 [39] &quot;Congo, Dem. Rep.&quot;               &quot;Congo, Rep.&quot;                   
 [41] &quot;Costa Rica&quot;                     &quot;Cote d&#39;Ivoire&quot;                 
 [43] &quot;Croatia&quot;                        &quot;Cuba&quot;                          
 [45] &quot;Cyprus&quot;                         &quot;Czech Republic&quot;                
 [47] &quot;Denmark&quot;                        &quot;Djibouti&quot;                      
 [49] &quot;Dominica&quot;                       &quot;Dominican Republic&quot;            
 [51] &quot;Ecuador&quot;                        &quot;Egypt&quot;                         
 [53] &quot;El Salvador&quot;                    &quot;Equatorial Guinea&quot;             
 [55] &quot;Eritrea&quot;                        &quot;Estonia&quot;                       
 [57] &quot;Ethiopia&quot;                       &quot;Fiji&quot;                          
 [59] &quot;Finland&quot;                        &quot;France&quot;                        
 [61] &quot;Gabon&quot;                          &quot;Gambia&quot;                        
 [63] &quot;Georgia&quot;                        &quot;Germany&quot;                       
 [65] &quot;Ghana&quot;                          &quot;Greece&quot;                        
 [67] &quot;Grenada&quot;                        &quot;Guatemala&quot;                     
 [69] &quot;Guinea&quot;                         &quot;Guinea-Bissau&quot;                 
 [71] &quot;Guyana&quot;                         &quot;Haiti&quot;                         
 [73] &quot;Honduras&quot;                       &quot;Hungary&quot;                       
 [75] &quot;Iceland&quot;                        &quot;India&quot;                         
 [77] &quot;Indonesia&quot;                      &quot;Iran&quot;                          
 [79] &quot;Iraq&quot;                           &quot;Ireland&quot;                       
 [81] &quot;Israel&quot;                         &quot;Italy&quot;                         
 [83] &quot;Jamaica&quot;                        &quot;Japan&quot;                         
 [85] &quot;Jordan&quot;                         &quot;Kazakhstan&quot;                    
 [87] &quot;Kenya&quot;                          &quot;Kiribati&quot;                      
 [89] &quot;Kuwait&quot;                         &quot;Kyrgyz Republic&quot;               
 [91] &quot;Lao&quot;                            &quot;Latvia&quot;                        
 [93] &quot;Lebanon&quot;                        &quot;Lesotho&quot;                       
 [95] &quot;Liberia&quot;                        &quot;Libya&quot;                         
 [97] &quot;Liechtenstein&quot;                  &quot;Lithuania&quot;                     
 [99] &quot;Luxembourg&quot;                     &quot;Macedonia, FYR&quot;                
[101] &quot;Madagascar&quot;                     &quot;Malawi&quot;                        
[103] &quot;Malaysia&quot;                       &quot;Maldives&quot;                      
[105] &quot;Mali&quot;                           &quot;Malta&quot;                         
[107] &quot;Marshall Islands&quot;               &quot;Mauritania&quot;                    
[109] &quot;Mauritius&quot;                      &quot;Mexico&quot;                        
[111] &quot;Micronesia, Fed. Sts.&quot;          &quot;Moldova&quot;                       
[113] &quot;Mongolia&quot;                       &quot;Montenegro&quot;                    
[115] &quot;Morocco&quot;                        &quot;Mozambique&quot;                    
[117] &quot;Myanmar&quot;                        &quot;Namibia&quot;                       
[119] &quot;Nauru&quot;                          &quot;Nepal&quot;                         
[121] &quot;Netherlands&quot;                    &quot;New Zealand&quot;                   
[123] &quot;Nicaragua&quot;                      &quot;Niger&quot;                         
[125] &quot;Nigeria&quot;                        &quot;North Korea&quot;                   
[127] &quot;Norway&quot;                         &quot;Oman&quot;                          
[129] &quot;Pakistan&quot;                       &quot;Palau&quot;                         
[131] &quot;Palestine&quot;                      &quot;Panama&quot;                        
[133] &quot;Papua New Guinea&quot;               &quot;Paraguay&quot;                      
[135] &quot;Peru&quot;                           &quot;Philippines&quot;                   
[137] &quot;Poland&quot;                         &quot;Portugal&quot;                      
[139] &quot;Qatar&quot;                          &quot;Romania&quot;                       
[141] &quot;Russia&quot;                         &quot;Rwanda&quot;                        
[143] &quot;Samoa&quot;                          &quot;Sao Tome and Principe&quot;         
[145] &quot;Saudi Arabia&quot;                   &quot;Senegal&quot;                       
[147] &quot;Serbia&quot;                         &quot;Seychelles&quot;                    
[149] &quot;Sierra Leone&quot;                   &quot;Singapore&quot;                     
[151] &quot;Slovak Republic&quot;                &quot;Slovenia&quot;                      
[153] &quot;Solomon Islands&quot;                &quot;Somalia&quot;                       
[155] &quot;South Africa&quot;                   &quot;South Korea&quot;                   
[157] &quot;South Sudan&quot;                    &quot;Spain&quot;                         
[159] &quot;Sri Lanka&quot;                      &quot;St. Kitts and Nevis&quot;           
[161] &quot;St. Lucia&quot;                      &quot;St. Vincent and the Grenadines&quot;
[163] &quot;Sudan&quot;                          &quot;Suriname&quot;                      
[165] &quot;Swaziland&quot;                      &quot;Sweden&quot;                        
[167] &quot;Switzerland&quot;                    &quot;Syria&quot;                         
[169] &quot;Tajikistan&quot;                     &quot;Tanzania&quot;                      
[171] &quot;Thailand&quot;                       &quot;Timor-Leste&quot;                   
[173] &quot;Togo&quot;                           &quot;Tonga&quot;                         
[175] &quot;Trinidad and Tobago&quot;            &quot;Tunisia&quot;                       
[177] &quot;Turkey&quot;                         &quot;Turkmenistan&quot;                  
[179] &quot;Tuvalu&quot;                         &quot;Uganda&quot;                        
[181] &quot;Ukraine&quot;                        &quot;United Arab Emirates&quot;          
[183] &quot;United Kingdom&quot;                 &quot;United States&quot;                 
[185] &quot;Uruguay&quot;                        &quot;Uzbekistan&quot;                    
[187] &quot;Vanuatu&quot;                        &quot;Venezuela&quot;                     
[189] &quot;Vietnam&quot;                        &quot;Yemen&quot;                         
[191] &quot;Zambia&quot;                         &quot;Zimbabwe&quot;                      </code></pre>
</div>
<div id="section-21" class="section level4">
<h4></h4>
<p>These all look as expected!</p>
</div>
</div>
<div id="yearly-growth-in-gdp-per-capita" class="section level2">
<h2><strong>Yearly Growth in GDP per Capita</strong></h2>
<hr />
<p>Let’s take a look at the next dataset (<code>gdp_growth</code>) that
we imported.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 220
  country       `1801`   `1802`   `1803`   `1804`   `1805`   `1806`   `1807`
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Afghanistan NA       NA       NA       NA       NA       NA       NA      
2 Albania      0.104    0.104    0.104    0.104    0.104    0.104    0.104  
3 Algeria     -0.00247 -0.00247 -0.00247 -0.00247 -0.00247 -0.00247 -0.00247
# … with 212 more variables: `1808` &lt;dbl&gt;, `1809` &lt;dbl&gt;, `1810` &lt;dbl&gt;,
#   `1811` &lt;dbl&gt;, `1812` &lt;dbl&gt;, `1813` &lt;dbl&gt;, `1814` &lt;dbl&gt;, `1815` &lt;dbl&gt;,
#   `1816` &lt;dbl&gt;, `1817` &lt;dbl&gt;, `1818` &lt;dbl&gt;, `1819` &lt;dbl&gt;, `1820` &lt;dbl&gt;,
#   `1821` &lt;dbl&gt;, `1822` &lt;dbl&gt;, `1823` &lt;dbl&gt;, `1824` &lt;dbl&gt;, `1825` &lt;dbl&gt;,
#   `1826` &lt;dbl&gt;, `1827` &lt;dbl&gt;, `1828` &lt;dbl&gt;, `1829` &lt;dbl&gt;, `1830` &lt;dbl&gt;,
#   `1831` &lt;dbl&gt;, `1832` &lt;dbl&gt;, `1833` &lt;dbl&gt;, `1834` &lt;dbl&gt;, `1835` &lt;dbl&gt;,
#   `1836` &lt;dbl&gt;, `1837` &lt;dbl&gt;, `1838` &lt;dbl&gt;, `1839` &lt;dbl&gt;, `1840` &lt;dbl&gt;, …</code></pre>
<p>How many rows and columns are there are there? We can easily check by
using the base <code>dim()</code> function, which evaluates the
dimensions of an object.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(gdp_growth)</span></code></pre></div>
<pre><code>[1] 194 220</code></pre>
<p>Interesting, it’s 194 rows (as opposed to 50688 above). We will deal
with this and other differences in the sets of countries a bit later on.
There are also 220 columns with a <code>country</code> column and a set
of columns corresponding to different years.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gdp_growth)</span></code></pre></div>
<pre><code>  [1] &quot;country&quot; &quot;1801&quot;    &quot;1802&quot;    &quot;1803&quot;    &quot;1804&quot;    &quot;1805&quot;    &quot;1806&quot;   
  [8] &quot;1807&quot;    &quot;1808&quot;    &quot;1809&quot;    &quot;1810&quot;    &quot;1811&quot;    &quot;1812&quot;    &quot;1813&quot;   
 [15] &quot;1814&quot;    &quot;1815&quot;    &quot;1816&quot;    &quot;1817&quot;    &quot;1818&quot;    &quot;1819&quot;    &quot;1820&quot;   
 [22] &quot;1821&quot;    &quot;1822&quot;    &quot;1823&quot;    &quot;1824&quot;    &quot;1825&quot;    &quot;1826&quot;    &quot;1827&quot;   
 [29] &quot;1828&quot;    &quot;1829&quot;    &quot;1830&quot;    &quot;1831&quot;    &quot;1832&quot;    &quot;1833&quot;    &quot;1834&quot;   
 [36] &quot;1835&quot;    &quot;1836&quot;    &quot;1837&quot;    &quot;1838&quot;    &quot;1839&quot;    &quot;1840&quot;    &quot;1841&quot;   
 [43] &quot;1842&quot;    &quot;1843&quot;    &quot;1844&quot;    &quot;1845&quot;    &quot;1846&quot;    &quot;1847&quot;    &quot;1848&quot;   
 [50] &quot;1849&quot;    &quot;1850&quot;    &quot;1851&quot;    &quot;1852&quot;    &quot;1853&quot;    &quot;1854&quot;    &quot;1855&quot;   
 [57] &quot;1856&quot;    &quot;1857&quot;    &quot;1858&quot;    &quot;1859&quot;    &quot;1860&quot;    &quot;1861&quot;    &quot;1862&quot;   
 [64] &quot;1863&quot;    &quot;1864&quot;    &quot;1865&quot;    &quot;1866&quot;    &quot;1867&quot;    &quot;1868&quot;    &quot;1869&quot;   
 [71] &quot;1870&quot;    &quot;1871&quot;    &quot;1872&quot;    &quot;1873&quot;    &quot;1874&quot;    &quot;1875&quot;    &quot;1876&quot;   
 [78] &quot;1877&quot;    &quot;1878&quot;    &quot;1879&quot;    &quot;1880&quot;    &quot;1881&quot;    &quot;1882&quot;    &quot;1883&quot;   
 [85] &quot;1884&quot;    &quot;1885&quot;    &quot;1886&quot;    &quot;1887&quot;    &quot;1888&quot;    &quot;1889&quot;    &quot;1890&quot;   
 [92] &quot;1891&quot;    &quot;1892&quot;    &quot;1893&quot;    &quot;1894&quot;    &quot;1895&quot;    &quot;1896&quot;    &quot;1897&quot;   
 [99] &quot;1898&quot;    &quot;1899&quot;    &quot;1900&quot;    &quot;1901&quot;    &quot;1902&quot;    &quot;1903&quot;    &quot;1904&quot;   
[106] &quot;1905&quot;    &quot;1906&quot;    &quot;1907&quot;    &quot;1908&quot;    &quot;1909&quot;    &quot;1910&quot;    &quot;1911&quot;   
[113] &quot;1912&quot;    &quot;1913&quot;    &quot;1914&quot;    &quot;1915&quot;    &quot;1916&quot;    &quot;1917&quot;    &quot;1918&quot;   
[120] &quot;1919&quot;    &quot;1920&quot;    &quot;1921&quot;    &quot;1922&quot;    &quot;1923&quot;    &quot;1924&quot;    &quot;1925&quot;   
[127] &quot;1926&quot;    &quot;1927&quot;    &quot;1928&quot;    &quot;1929&quot;    &quot;1930&quot;    &quot;1931&quot;    &quot;1932&quot;   
[134] &quot;1933&quot;    &quot;1934&quot;    &quot;1935&quot;    &quot;1936&quot;    &quot;1937&quot;    &quot;1938&quot;    &quot;1939&quot;   
[141] &quot;1940&quot;    &quot;1941&quot;    &quot;1942&quot;    &quot;1943&quot;    &quot;1944&quot;    &quot;1945&quot;    &quot;1946&quot;   
[148] &quot;1947&quot;    &quot;1948&quot;    &quot;1949&quot;    &quot;1950&quot;    &quot;1951&quot;    &quot;1952&quot;    &quot;1953&quot;   
[155] &quot;1954&quot;    &quot;1955&quot;    &quot;1956&quot;    &quot;1957&quot;    &quot;1958&quot;    &quot;1959&quot;    &quot;1960&quot;   
[162] &quot;1961&quot;    &quot;1962&quot;    &quot;1963&quot;    &quot;1964&quot;    &quot;1965&quot;    &quot;1966&quot;    &quot;1967&quot;   
[169] &quot;1968&quot;    &quot;1969&quot;    &quot;1970&quot;    &quot;1971&quot;    &quot;1972&quot;    &quot;1973&quot;    &quot;1974&quot;   
[176] &quot;1975&quot;    &quot;1976&quot;    &quot;1977&quot;    &quot;1978&quot;    &quot;1979&quot;    &quot;1980&quot;    &quot;1981&quot;   
[183] &quot;1982&quot;    &quot;1983&quot;    &quot;1984&quot;    &quot;1985&quot;    &quot;1986&quot;    &quot;1987&quot;    &quot;1988&quot;   
[190] &quot;1989&quot;    &quot;1990&quot;    &quot;1991&quot;    &quot;1992&quot;    &quot;1993&quot;    &quot;1994&quot;    &quot;1995&quot;   
[197] &quot;1996&quot;    &quot;1997&quot;    &quot;1998&quot;    &quot;1999&quot;    &quot;2000&quot;    &quot;2001&quot;    &quot;2002&quot;   
[204] &quot;2003&quot;    &quot;2004&quot;    &quot;2005&quot;    &quot;2006&quot;    &quot;2007&quot;    &quot;2008&quot;    &quot;2009&quot;   
[211] &quot;2010&quot;    &quot;2011&quot;    &quot;2012&quot;    &quot;2013&quot;    &quot;2014&quot;    &quot;2015&quot;    &quot;2016&quot;   
[218] &quot;2017&quot;    &quot;2018&quot;    &quot;2019&quot;   </code></pre>
<p>Yes, no other columns in this dataset.</p>
<p>Next, we will use the <code>pivot_longer()</code> to transform the
data to long format, similar to what we did in the previous section.</p>
<p>We will also again change the <code>country</code> variable to be
<code>Country</code> by using the <code>rename()</code> function, and we
will make the <code>Year</code> variable numeric using the
<code>mutate()</code> function.</p>
<div id="section-22" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Using what you just learned about <code>pivot_longer()</code>,
<code>rename()</code>, and <code>mutate()</code> and without scrolling
up, try to come up with the code to do the wrangling for this data.</p>
</div>
<div id="section-23" class="section level4">
<h4></h4>
<hr />
<details>
<summary>
Click here to reveal the code.
</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="sc">%&lt;&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;gdp_growth&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country =</span> country) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(Year),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Label =</span> <span class="st">&quot;GDP Growth/Capita (%)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GDP =</span> gdp_growth)</span></code></pre></div>
</details>
<hr />
<p>Now let’s see how this data has changed:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 4
  Country      Year   GDP Label                
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                
1 Afghanistan  1801    NA GDP Growth/Capita (%)
2 Afghanistan  1802    NA GDP Growth/Capita (%)
3 Afghanistan  1803    NA GDP Growth/Capita (%)
4 Afghanistan  1804    NA GDP Growth/Capita (%)
5 Afghanistan  1805    NA GDP Growth/Capita (%)
6 Afghanistan  1806    NA GDP Growth/Capita (%)</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Year)</span></code></pre></div>
<pre><code># A tibble: 219 × 2
    Year     n
   &lt;dbl&gt; &lt;int&gt;
 1  1801   194
 2  1802   194
 3  1803   194
 4  1804   194
 5  1805   194
 6  1806   194
 7  1807   194
 8  1808   194
 9  1809   194
10  1810   194
# … with 209 more rows</code></pre>
<p>Again let’s check that the <code>Country</code> variable only
contains values we would expect.</p>
</div>
<div id="section-24" class="section level4 scrollable">
<h4 class="scrollable"></h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scroll through the output!</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>gdp_growth <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code></pre></div>
<pre><code>  [1] &quot;Afghanistan&quot;                    &quot;Albania&quot;                       
  [3] &quot;Algeria&quot;                        &quot;Andorra&quot;                       
  [5] &quot;Angola&quot;                         &quot;Antigua and Barbuda&quot;           
  [7] &quot;Argentina&quot;                      &quot;Armenia&quot;                       
  [9] &quot;Australia&quot;                      &quot;Austria&quot;                       
 [11] &quot;Azerbaijan&quot;                     &quot;Bahamas&quot;                       
 [13] &quot;Bahrain&quot;                        &quot;Bangladesh&quot;                    
 [15] &quot;Barbados&quot;                       &quot;Belarus&quot;                       
 [17] &quot;Belgium&quot;                        &quot;Belize&quot;                        
 [19] &quot;Benin&quot;                          &quot;Bhutan&quot;                        
 [21] &quot;Bolivia&quot;                        &quot;Bosnia and Herzegovina&quot;        
 [23] &quot;Botswana&quot;                       &quot;Brazil&quot;                        
 [25] &quot;Brunei&quot;                         &quot;Bulgaria&quot;                      
 [27] &quot;Burkina Faso&quot;                   &quot;Burundi&quot;                       
 [29] &quot;Cambodia&quot;                       &quot;Cameroon&quot;                      
 [31] &quot;Canada&quot;                         &quot;Cape Verde&quot;                    
 [33] &quot;Central African Republic&quot;       &quot;Chad&quot;                          
 [35] &quot;Chile&quot;                          &quot;China&quot;                         
 [37] &quot;Colombia&quot;                       &quot;Comoros&quot;                       
 [39] &quot;Congo, Dem. Rep.&quot;               &quot;Congo, Rep.&quot;                   
 [41] &quot;Costa Rica&quot;                     &quot;Cote d&#39;Ivoire&quot;                 
 [43] &quot;Croatia&quot;                        &quot;Cuba&quot;                          
 [45] &quot;Cyprus&quot;                         &quot;Czech Republic&quot;                
 [47] &quot;Denmark&quot;                        &quot;Djibouti&quot;                      
 [49] &quot;Dominica&quot;                       &quot;Dominican Republic&quot;            
 [51] &quot;Ecuador&quot;                        &quot;Egypt&quot;                         
 [53] &quot;El Salvador&quot;                    &quot;Equatorial Guinea&quot;             
 [55] &quot;Eritrea&quot;                        &quot;Estonia&quot;                       
 [57] &quot;Ethiopia&quot;                       &quot;Fiji&quot;                          
 [59] &quot;Finland&quot;                        &quot;France&quot;                        
 [61] &quot;Gabon&quot;                          &quot;Gambia&quot;                        
 [63] &quot;Georgia&quot;                        &quot;Germany&quot;                       
 [65] &quot;Ghana&quot;                          &quot;Greece&quot;                        
 [67] &quot;Grenada&quot;                        &quot;Guatemala&quot;                     
 [69] &quot;Guinea&quot;                         &quot;Guinea-Bissau&quot;                 
 [71] &quot;Guyana&quot;                         &quot;Haiti&quot;                         
 [73] &quot;Honduras&quot;                       &quot;Hungary&quot;                       
 [75] &quot;Iceland&quot;                        &quot;India&quot;                         
 [77] &quot;Indonesia&quot;                      &quot;Iran&quot;                          
 [79] &quot;Iraq&quot;                           &quot;Ireland&quot;                       
 [81] &quot;Israel&quot;                         &quot;Italy&quot;                         
 [83] &quot;Jamaica&quot;                        &quot;Japan&quot;                         
 [85] &quot;Jordan&quot;                         &quot;Kazakhstan&quot;                    
 [87] &quot;Kenya&quot;                          &quot;Kiribati&quot;                      
 [89] &quot;Kuwait&quot;                         &quot;Kyrgyz Republic&quot;               
 [91] &quot;Lao&quot;                            &quot;Latvia&quot;                        
 [93] &quot;Lebanon&quot;                        &quot;Lesotho&quot;                       
 [95] &quot;Liberia&quot;                        &quot;Libya&quot;                         
 [97] &quot;Liechtenstein&quot;                  &quot;Lithuania&quot;                     
 [99] &quot;Luxembourg&quot;                     &quot;Macedonia, FYR&quot;                
[101] &quot;Madagascar&quot;                     &quot;Malawi&quot;                        
[103] &quot;Malaysia&quot;                       &quot;Maldives&quot;                      
[105] &quot;Mali&quot;                           &quot;Malta&quot;                         
[107] &quot;Marshall Islands&quot;               &quot;Mauritania&quot;                    
[109] &quot;Mauritius&quot;                      &quot;Mexico&quot;                        
[111] &quot;Micronesia, Fed. Sts.&quot;          &quot;Moldova&quot;                       
[113] &quot;Monaco&quot;                         &quot;Mongolia&quot;                      
[115] &quot;Montenegro&quot;                     &quot;Morocco&quot;                       
[117] &quot;Mozambique&quot;                     &quot;Myanmar&quot;                       
[119] &quot;Namibia&quot;                        &quot;Nauru&quot;                         
[121] &quot;Nepal&quot;                          &quot;Netherlands&quot;                   
[123] &quot;New Zealand&quot;                    &quot;Nicaragua&quot;                     
[125] &quot;Niger&quot;                          &quot;Nigeria&quot;                       
[127] &quot;North Korea&quot;                    &quot;Norway&quot;                        
[129] &quot;Oman&quot;                           &quot;Pakistan&quot;                      
[131] &quot;Palau&quot;                          &quot;Palestine&quot;                     
[133] &quot;Panama&quot;                         &quot;Papua New Guinea&quot;              
[135] &quot;Paraguay&quot;                       &quot;Peru&quot;                          
[137] &quot;Philippines&quot;                    &quot;Poland&quot;                        
[139] &quot;Portugal&quot;                       &quot;Qatar&quot;                         
[141] &quot;Romania&quot;                        &quot;Russia&quot;                        
[143] &quot;Rwanda&quot;                         &quot;Samoa&quot;                         
[145] &quot;San Marino&quot;                     &quot;Sao Tome and Principe&quot;         
[147] &quot;Saudi Arabia&quot;                   &quot;Senegal&quot;                       
[149] &quot;Serbia&quot;                         &quot;Seychelles&quot;                    
[151] &quot;Sierra Leone&quot;                   &quot;Singapore&quot;                     
[153] &quot;Slovak Republic&quot;                &quot;Slovenia&quot;                      
[155] &quot;Solomon Islands&quot;                &quot;Somalia&quot;                       
[157] &quot;South Africa&quot;                   &quot;South Korea&quot;                   
[159] &quot;South Sudan&quot;                    &quot;Spain&quot;                         
[161] &quot;Sri Lanka&quot;                      &quot;St. Kitts and Nevis&quot;           
[163] &quot;St. Lucia&quot;                      &quot;St. Vincent and the Grenadines&quot;
[165] &quot;Sudan&quot;                          &quot;Suriname&quot;                      
[167] &quot;Swaziland&quot;                      &quot;Sweden&quot;                        
[169] &quot;Switzerland&quot;                    &quot;Syria&quot;                         
[171] &quot;Tajikistan&quot;                     &quot;Tanzania&quot;                      
[173] &quot;Thailand&quot;                       &quot;Timor-Leste&quot;                   
[175] &quot;Togo&quot;                           &quot;Tonga&quot;                         
[177] &quot;Trinidad and Tobago&quot;            &quot;Tunisia&quot;                       
[179] &quot;Turkey&quot;                         &quot;Turkmenistan&quot;                  
[181] &quot;Tuvalu&quot;                         &quot;Uganda&quot;                        
[183] &quot;Ukraine&quot;                        &quot;United Arab Emirates&quot;          
[185] &quot;United Kingdom&quot;                 &quot;United States&quot;                 
[187] &quot;Uruguay&quot;                        &quot;Uzbekistan&quot;                    
[189] &quot;Vanuatu&quot;                        &quot;Venezuela&quot;                     
[191] &quot;Vietnam&quot;                        &quot;Yemen&quot;                         
[193] &quot;Zambia&quot;                         &quot;Zimbabwe&quot;                      </code></pre>
</div>
<div id="section-25" class="section level4">
<h4></h4>
<p>Also looks good!</p>
</div>
</div>
<div id="energy-use-per-person" class="section level2">
<h2><strong>Energy Use per Person</strong></h2>
<hr />
<p>Now let’s take a look at the energy use per person data
(<code>energy_use</code>) using <code>slice_head()</code> and
<code>glimpse()</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>energy_use <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 57
  country `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967` `1968` `1969`
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Albania     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
2 Algeria     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 Angola      NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
# … with 46 more variables: `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;, `1972` &lt;dbl&gt;,
#   `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;,
#   `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;,
#   `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;,
#   `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;,
#   `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;,
#   `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, `2002` &lt;dbl&gt;, …</code></pre>
<div id="section-26" class="section level4 scrollable">
<h4 class="scrollable"></h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>energy_use <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 169
Columns: 57
$ country &lt;chr&gt; &quot;Albania&quot;, &quot;Algeria&quot;, &quot;Angola&quot;, &quot;Antigua and Barbuda&quot;, &quot;Argent…
$ `1960`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3060, 1550, NA, NA, NA, NA, NA, NA, 25…
$ `1961`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3120, 1550, NA, NA, NA, NA, NA, NA, 25…
$ `1962`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3170, 1680, NA, NA, NA, NA, NA, NA, 28…
$ `1963`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3280, 1820, NA, NA, NA, NA, NA, NA, 30…
$ `1964`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3350, 1860, NA, NA, NA, NA, NA, NA, 30…
$ `1965`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3460, 1850, NA, NA, NA, NA, NA, NA, 31…
$ `1966`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3550, 1900, NA, NA, NA, NA, NA, NA, 30…
$ `1967`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3690, 1920, NA, NA, NA, NA, NA, NA, 31…
$ `1968`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3760, 2050, NA, NA, NA, NA, NA, NA, 35…
$ `1969`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 3790, 2180, NA, NA, NA, NA, NA, NA, 38…
$ `1970`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 4060, 2420, NA, NA, NA, NA, NA, NA, 41…
$ `1971`  &lt;dbl&gt; 785.0, 232.0, 556.0, NA, 1380.0, NA, 3990.0, 2510.0, NA, NA, 6…
$ `1972`  &lt;dbl&gt; 866.0, 261.0, 584.0, NA, 1380.0, NA, 4040.0, 2630.0, NA, NA, 5…
$ `1973`  &lt;dbl&gt; 763.0, 305.0, 568.0, NA, 1410.0, NA, 4260.0, 2830.0, NA, NA, 8…
$ `1974`  &lt;dbl&gt; 777.0, 319.0, 565.0, NA, 1420.0, NA, 4290.0, 2730.0, NA, NA, 9…
$ `1975`  &lt;dbl&gt; 827.0, 330.0, 536.0, NA, 1380.0, NA, 4350.0, 2650.0, NA, NA, 8…
$ `1976`  &lt;dbl&gt; 891, 367, 515, NA, 1400, NA, 4410, 2870, NA, NA, 9580, 98, NA,…
$ `1977`  &lt;dbl&gt; 924.0, 399.0, 494.0, NA, 1420.0, NA, 4670.0, 2800.0, NA, NA, 8…
$ `1978`  &lt;dbl&gt; 1010.0, 477.0, 527.0, NA, 1430.0, NA, 4630.0, 2890.0, NA, NA, …
$ `1979`  &lt;dbl&gt; 864.0, 586.0, 518.0, NA, 1480.0, NA, 4680.0, 3140.0, NA, NA, 8…
$ `1980`  &lt;dbl&gt; 1150, 579, 511, NA, 1490, NA, 4740, 3070, NA, NA, 7790, 103, N…
$ `1981`  &lt;dbl&gt; 989, 611, 497, NA, 1430, NA, 4690, 2900, NA, NA, 8300, 102, NA…
$ `1982`  &lt;dbl&gt; 967, 771, 473, NA, 1420, NA, 4820, 2830, NA, NA, 9070, 105, NA…
$ `1983`  &lt;dbl&gt; 1000, 808, 469, NA, 1420, NA, 4560, 2840, NA, NA, 8500, 105, N…
$ `1984`  &lt;dbl&gt; 1020, 776, 458, NA, 1450, NA, 4650, 2950, NA, NA, 8830, 104, N…
$ `1985`  &lt;dbl&gt; 917, 786, 470, NA, 1360, NA, 4600, 3050, NA, NA, 9920, 107, NA…
$ `1986`  &lt;dbl&gt; 964, 862, 462, NA, 1420, NA, 4620, 3060, NA, NA, 10300, 111, N…
$ `1987`  &lt;dbl&gt; 922, 828, 461, NA, 1480, NA, 4770, 3170, NA, NA, 9520, 107, NA…
$ `1988`  &lt;dbl&gt; 928, 850, 467, NA, 1500, NA, 4700, 3200, NA, NA, 10500, 114, N…
$ `1989`  &lt;dbl&gt; 896, 820, 465, NA, 1440, NA, 5000, 3140, NA, NA, 10200, 117, N…
$ `1990`  &lt;dbl&gt; 813, 856, 483, 1480, 1410, 2180, 5060, 3240, 3170, 2520, 10600…
$ `1991`  &lt;dbl&gt; 573, 884, 480, NA, 1430, 2320, 4930, 3420, 3090, NA, 10100, 11…
$ `1992`  &lt;dbl&gt; 418, 884, 467, NA, 1480, 1200, 4960, 3250, 2460, NA, 10800, 11…
$ `1993`  &lt;dbl&gt; 412, 868, 468, NA, 1470, 652, 5150, 3260, 2180, NA, 11100, 123…
$ `1994`  &lt;dbl&gt; 441, 819, 459, NA, 1540, 420, 5090, 3230, 1950, NA, 11600, 126…
$ `1995`  &lt;dbl&gt; 417, 839, 445, NA, 1540, 511, 5130, 3370, 1810, NA, 11400, 134…
$ `1996`  &lt;dbl&gt; 448, 798, 445, NA, 1580, 562, 5390, 3580, 1510, NA, 11100, 132…
$ `1997`  &lt;dbl&gt; 385, 805, 443, NA, 1610, 594, 5470, 3550, 1440, NA, 12200, 135…
$ `1998`  &lt;dbl&gt; 427, 821, 430, NA, 1650, 610, 5550, 3610, 1490, NA, 12400, 138…
$ `1999`  &lt;dbl&gt; 576, 864, 439, NA, 1660, 594, 5610, 3590, 1370, NA, 11900, 137…
$ `2000`  &lt;dbl&gt; 580, 866, 437, NA, 1660, 656, 5640, 3570, 1400, NA, 12000, 139…
$ `2001`  &lt;dbl&gt; 597, 856, 442, NA, 1560, 657, 5450, 3760, 1410, NA, 11700, 149…
$ `2002`  &lt;dbl&gt; 660, 904, 447, NA, 1500, 618, 5570, 3770, 1410, NA, 11500, 150…
$ `2003`  &lt;dbl&gt; 648, 949, 466, NA, 1590, 657, 5570, 3970, 1480, NA, 11600, 155…
$ `2004`  &lt;dbl&gt; 715, 948, 462, 1530, 1720, 698, 5600, 4010, 1540, 2060, 10900,…
$ `2005`  &lt;dbl&gt; 720, 974, 431, 1530, 1710, 843, 5560, 4090, 1600, 2110, 11700,…
$ `2006`  &lt;dbl&gt; 707, 1030, 456, 1580, 1840, 865, 5710, 4080, 1560, 2100, 11600…
$ `2007`  &lt;dbl&gt; 680, 1070, 470, 1600, 1850, 973, 5870, 4020, 1410, 2070, 11200…
$ `2008`  &lt;dbl&gt; 711, 1070, 491, NA, 1920, 1030, 5960, 4030, 1520, NA, 11300, 1…
$ `2009`  &lt;dbl&gt; 732, 1150, 514, NA, 1850, 904, 5860, 3800, 1330, NA, 10300, 18…
$ `2010`  &lt;dbl&gt; 729, 1110, 521, NA, 1910, 863, 5790, 4050, 1280, NA, 10200, 20…
$ `2011`  &lt;dbl&gt; 765, 1140, 522, NA, 1930, 944, 5750, 3920, 1370, NA, 9910, 206…
$ `2012`  &lt;dbl&gt; 688, 1220, 553, NA, 1920, 1030, 5570, 3890, 1470, NA, 9660, 21…
$ `2013`  &lt;dbl&gt; 801, 1240, 534, NA, 1950, 1000, 5460, 3920, 1470, NA, 10400, 2…
$ `2014`  &lt;dbl&gt; 808, 1320, 545, NA, 2020, 1020, 5330, 3760, 1500, NA, 10600, 2…
$ `2015`  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 5480, 3800, NA, NA, NA, NA, NA, NA, 46…</code></pre>
</div>
<div id="section-27" class="section level4">
<h4></h4>
<p>Looks like we have 169 rows and 57 columns where we have a
<code>country</code> column and again a set of years. To wrangle the
<code>energy_use</code> data, we will again convert the data to long
format, rename some variables, and mutate the <code>Year</code> data to
be numeric.</p>
</div>
<div id="section-28" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Again try to come up with the code on your own to wrangle the
data.</p>
</div>
<div id="section-29" class="section level4">
<h4></h4>
<hr />
<details>
<summary>
Click here to reveal the code.
</summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>energy_use <span class="sc">%&lt;&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>country,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;energy_use&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Country =</span> country) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(Year),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Label =</span> <span class="st">&quot;Energy Use (kg, oil-eq./capita)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Energy =</span> energy_use)</span></code></pre></div>
</details>
<hr />
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>energy_use <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 4
  Country             Year Energy Label                          
  &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                          
1 Dominican Republic  2014    734 Energy Use (kg, oil-eq./capita)
2 Ecuador             2006    671 Energy Use (kg, oil-eq./capita)
3 Turkey              1997   1170 Energy Use (kg, oil-eq./capita)</code></pre>
<p>Now we will check the <code>Country</code> variable:</p>
</div>
<div id="section-30" class="section level4 scrollable">
<h4 class="scrollable"></h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scroll through the output!</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>energy_use <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code></pre></div>
<pre><code>  [1] &quot;Albania&quot;                        &quot;Algeria&quot;                       
  [3] &quot;Angola&quot;                         &quot;Antigua and Barbuda&quot;           
  [5] &quot;Argentina&quot;                      &quot;Armenia&quot;                       
  [7] &quot;Australia&quot;                      &quot;Austria&quot;                       
  [9] &quot;Azerbaijan&quot;                     &quot;Bahamas&quot;                       
 [11] &quot;Bahrain&quot;                        &quot;Bangladesh&quot;                    
 [13] &quot;Barbados&quot;                       &quot;Belarus&quot;                       
 [15] &quot;Belgium&quot;                        &quot;Belize&quot;                        
 [17] &quot;Benin&quot;                          &quot;Bhutan&quot;                        
 [19] &quot;Bolivia&quot;                        &quot;Bosnia and Herzegovina&quot;        
 [21] &quot;Botswana&quot;                       &quot;Brazil&quot;                        
 [23] &quot;Brunei&quot;                         &quot;Bulgaria&quot;                      
 [25] &quot;Cambodia&quot;                       &quot;Cameroon&quot;                      
 [27] &quot;Canada&quot;                         &quot;Cape Verde&quot;                    
 [29] &quot;Chile&quot;                          &quot;China&quot;                         
 [31] &quot;Colombia&quot;                       &quot;Comoros&quot;                       
 [33] &quot;Congo, Dem. Rep.&quot;               &quot;Congo, Rep.&quot;                   
 [35] &quot;Costa Rica&quot;                     &quot;Cote d&#39;Ivoire&quot;                 
 [37] &quot;Croatia&quot;                        &quot;Cuba&quot;                          
 [39] &quot;Cyprus&quot;                         &quot;Czech Republic&quot;                
 [41] &quot;Denmark&quot;                        &quot;Djibouti&quot;                      
 [43] &quot;Dominica&quot;                       &quot;Dominican Republic&quot;            
 [45] &quot;Ecuador&quot;                        &quot;Egypt&quot;                         
 [47] &quot;El Salvador&quot;                    &quot;Equatorial Guinea&quot;             
 [49] &quot;Eritrea&quot;                        &quot;Estonia&quot;                       
 [51] &quot;Ethiopia&quot;                       &quot;Fiji&quot;                          
 [53] &quot;Finland&quot;                        &quot;France&quot;                        
 [55] &quot;Gabon&quot;                          &quot;Gambia&quot;                        
 [57] &quot;Georgia&quot;                        &quot;Germany&quot;                       
 [59] &quot;Ghana&quot;                          &quot;Greece&quot;                        
 [61] &quot;Grenada&quot;                        &quot;Guatemala&quot;                     
 [63] &quot;Guinea-Bissau&quot;                  &quot;Guyana&quot;                        
 [65] &quot;Haiti&quot;                          &quot;Honduras&quot;                      
 [67] &quot;Hungary&quot;                        &quot;Iceland&quot;                       
 [69] &quot;India&quot;                          &quot;Indonesia&quot;                     
 [71] &quot;Iran&quot;                           &quot;Iraq&quot;                          
 [73] &quot;Ireland&quot;                        &quot;Israel&quot;                        
 [75] &quot;Italy&quot;                          &quot;Jamaica&quot;                       
 [77] &quot;Japan&quot;                          &quot;Jordan&quot;                        
 [79] &quot;Kazakhstan&quot;                     &quot;Kenya&quot;                         
 [81] &quot;Kiribati&quot;                       &quot;Kuwait&quot;                        
 [83] &quot;Kyrgyz Republic&quot;                &quot;Latvia&quot;                        
 [85] &quot;Lebanon&quot;                        &quot;Lesotho&quot;                       
 [87] &quot;Libya&quot;                          &quot;Lithuania&quot;                     
 [89] &quot;Luxembourg&quot;                     &quot;Macedonia, FYR&quot;                
 [91] &quot;Malaysia&quot;                       &quot;Maldives&quot;                      
 [93] &quot;Malta&quot;                          &quot;Marshall Islands&quot;              
 [95] &quot;Mauritius&quot;                      &quot;Mexico&quot;                        
 [97] &quot;Moldova&quot;                        &quot;Mongolia&quot;                      
 [99] &quot;Montenegro&quot;                     &quot;Morocco&quot;                       
[101] &quot;Mozambique&quot;                     &quot;Myanmar&quot;                       
[103] &quot;Namibia&quot;                        &quot;Nepal&quot;                         
[105] &quot;Netherlands&quot;                    &quot;New Zealand&quot;                   
[107] &quot;Nicaragua&quot;                      &quot;Niger&quot;                         
[109] &quot;Nigeria&quot;                        &quot;North Korea&quot;                   
[111] &quot;Norway&quot;                         &quot;Oman&quot;                          
[113] &quot;Pakistan&quot;                       &quot;Palau&quot;                         
[115] &quot;Panama&quot;                         &quot;Paraguay&quot;                      
[117] &quot;Peru&quot;                           &quot;Philippines&quot;                   
[119] &quot;Poland&quot;                         &quot;Portugal&quot;                      
[121] &quot;Qatar&quot;                          &quot;Romania&quot;                       
[123] &quot;Russia&quot;                         &quot;Samoa&quot;                         
[125] &quot;Sao Tome and Principe&quot;          &quot;Saudi Arabia&quot;                  
[127] &quot;Senegal&quot;                        &quot;Serbia&quot;                        
[129] &quot;Seychelles&quot;                     &quot;Singapore&quot;                     
[131] &quot;Slovak Republic&quot;                &quot;Slovenia&quot;                      
[133] &quot;Solomon Islands&quot;                &quot;South Africa&quot;                  
[135] &quot;South Korea&quot;                    &quot;South Sudan&quot;                   
[137] &quot;Spain&quot;                          &quot;Sri Lanka&quot;                     
[139] &quot;St. Kitts and Nevis&quot;            &quot;St. Lucia&quot;                     
[141] &quot;St. Vincent and the Grenadines&quot; &quot;Sudan&quot;                         
[143] &quot;Suriname&quot;                       &quot;Swaziland&quot;                     
[145] &quot;Sweden&quot;                         &quot;Switzerland&quot;                   
[147] &quot;Syria&quot;                          &quot;Tajikistan&quot;                    
[149] &quot;Tanzania&quot;                       &quot;Thailand&quot;                      
[151] &quot;Timor-Leste&quot;                    &quot;Togo&quot;                          
[153] &quot;Tonga&quot;                          &quot;Trinidad and Tobago&quot;           
[155] &quot;Tunisia&quot;                        &quot;Turkey&quot;                        
[157] &quot;Turkmenistan&quot;                   &quot;Ukraine&quot;                       
[159] &quot;United Arab Emirates&quot;           &quot;United Kingdom&quot;                
[161] &quot;United States&quot;                  &quot;Uruguay&quot;                       
[163] &quot;Uzbekistan&quot;                     &quot;Vanuatu&quot;                       
[165] &quot;Venezuela&quot;                      &quot;Vietnam&quot;                       
[167] &quot;Yemen&quot;                          &quot;Zambia&quot;                        
[169] &quot;Zimbabwe&quot;                      </code></pre>
</div>
<div id="section-31" class="section level4">
<h4></h4>
<p>Looks good!</p>
</div>
</div>
<div id="us-specific-data" class="section level2">
<h2><strong>US Specific Data</strong></h2>
<hr />
<p>Now we will take a look at the US data about disasters and
temperature.</p>
<div id="disasters" class="section level3">
<h3><strong>Disasters</strong></h3>
<hr />
<p>First, we consider the disasters that have occurred in the US.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>us_disaster</span></code></pre></div>
<pre><code># A tibble: 40 × 57
    Year Droug…¹ Droug…² Droug…³ Droug…⁴ Droug…⁵ Droug…⁶ Droug…⁷ Droug…⁸ Flood…⁹
   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1  1980       1    33.2    26.4    39.6    24.5    41.6    23.4    42.8       1
 2  1981       0     0       0       0       0       0       0       0         0
 3  1982       0     0       0       0       0       0       0       0         0
 4  1983       1     7.8     5.5     9       5       9.9     4.6    10.6       2
 5  1984       0     0       0       0       0       0       0       0         0
 6  1985       0     0       0       0       0       0       0       0         0
 7  1986       1     4.2     3.5     5       3.2     5.3     3       5.6       0
 8  1987       0     0       0       0       0       0       0       0         0
 9  1988       1    44.4    33.8    54      31.3    56.5    30.2    57.7       0
10  1989       1     6.4     5.6     7.4     5.3     7.6     5.1     7.9       0
# … with 30 more rows, 47 more variables: `Flooding Cost` &lt;dbl&gt;,
#   `Flooding Lower 75` &lt;dbl&gt;, `Flooding Upper 75` &lt;dbl&gt;,
#   `Flooding Lower 90` &lt;dbl&gt;, `Flooding Upper 90` &lt;dbl&gt;,
#   `Flooding Lower 95` &lt;dbl&gt;, `Flooding Upper 95` &lt;dbl&gt;, `Freeze Count` &lt;dbl&gt;,
#   `Freeze Cost` &lt;dbl&gt;, `Freeze Lower 75` &lt;dbl&gt;, `Freeze Upper 75` &lt;dbl&gt;,
#   `Freeze Lower 90` &lt;dbl&gt;, `Freeze Upper 90` &lt;dbl&gt;, `Freeze Lower 95` &lt;dbl&gt;,
#   `Freeze Upper 95` &lt;dbl&gt;, `Severe Storm Count` &lt;dbl&gt;, …</code></pre>
<p>We are specifically interested in the <code>Year</code> and the
variables that contain the word <code>"Count"</code>. The other
variables represent an estimate of the economic cost in billions of
dollars, as well as the upper and lower bounds for simulations used to
estimate the economic cost, which show the level of uncertainty in these
estimates (at three different levels of confidence) as the true cost is
unknown. See <a
href="https://www.ncdc.noaa.gov/billions/time-series">here</a> for more
information about the data. For this analysis, we will focus just on the
number of disasters that occurred each year.</p>
<p>We will select our variables of interest using the
<code>select()</code> and <code>contains()</code> functions in the
<code>dplyr</code> package. Since we are selecting for variables with
the word <code>"Count"</code> we need to use quotation marks around
it.</p>
<p>Selecting for the variable <code>Year</code> does not require quotes
because it is the full name of one of the existing variables.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&lt;&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">select</span>(Year, <span class="fu">contains</span>(<span class="st">&quot;Count&quot;</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 8
   Year `Drought Count` `Flooding Count` Freez…¹ Sever…² Tropi…³ Wildf…⁴ Winte…⁵
  &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  1980               1                1       0       0       1       0       0
2  1981               0                0       1       1       0       0       0
3  1982               0                0       0       2       0       0       1
4  1983               1                2       1       0       1       0       0
5  1984               0                0       0       2       0       0       0
6  1985               0                0       1       0       3       0       1
# … with abbreviated variable names ¹​`Freeze Count`, ²​`Severe Storm Count`,
#   ³​`Tropical Cyclone Count`, ⁴​`Wildfire Count`, ⁵​`Winter Storm Count`</code></pre>
<p>Now we want to create a new variable that will be the sum of all the
different types of disasters for each year.</p>
<p>We don’t want to include the <code>Year</code> variable in our sum,
so we can exclude it using the <code>select</code> function. To perform
the sum for each year, we can use the base <code>rowSums()</code>
function.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>yearly_disasters <span class="ot">&lt;-</span> us_disaster <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(<span class="sc">-</span>Year) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rowSums</span>()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>yearly_disasters</span></code></pre></div>
<pre><code> [1]  3  2  3  5  2  5  2  0  1  5  3  4  7  5  6  5  4  3 10  5  4  2  4  7  5
[26]  6  7  5 12  7  6 16 11  9  8 10 15 16 14 14</code></pre>
<p>We could then add this to our <code>us_diaster</code> tibble like so
using the <code>bind_cols</code> function of the <code>dplyr</code>
package:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(<span class="at">Disaters =</span> yearly_disasters)</span></code></pre></div>
<pre><code># A tibble: 40 × 9
    Year `Drought Count` Flood…¹ Freez…² Sever…³ Tropi…⁴ Wildf…⁵ Winte…⁶ Disat…⁷
   &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1  1980               1       1       0       0       1       0       0       3
 2  1981               0       0       1       1       0       0       0       2
 3  1982               0       0       0       2       0       0       1       3
 4  1983               1       2       1       0       1       0       0       5
 5  1984               0       0       0       2       0       0       0       2
 6  1985               0       0       1       0       3       0       1       5
 7  1986               1       0       0       1       0       0       0       2
 8  1987               0       0       0       0       0       0       0       0
 9  1988               1       0       0       0       0       0       0       1
10  1989               1       0       1       1       1       0       1       5
# … with 30 more rows, and abbreviated variable names ¹​`Flooding Count`,
#   ²​`Freeze Count`, ³​`Severe Storm Count`, ⁴​`Tropical Cyclone Count`,
#   ⁵​`Wildfire Count`, ⁶​`Winter Storm Count`, ⁷​Disaters</code></pre>
<p>However, we can actually create and add this new variable directly to
the <code>us_disaster</code> tibble by using the <code>mutate()</code>
function of <code>dplyr</code> and using the <code>.</code>
notation.</p>
<p>We need to use the <code>.</code> notation to indicate that we are
using the data that we already used as input (on the left side of the
pipe) to our <code>mutate()</code> function (on the right side of our
pipe), which in this case is the entire <code>us_disaster</code> tibble
for our <code>select()</code> function. The output from the
<code>select()</code> function will be used for the
<code>rowSums()</code> function.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&lt;&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Disasters =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>Year)))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 40
Columns: 9
$ Year                     &lt;dbl&gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 198…
$ `Drought Count`          &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, …
$ `Flooding Count`         &lt;dbl&gt; 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, …
$ `Freeze Count`           &lt;dbl&gt; 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, …
$ `Severe Storm Count`     &lt;dbl&gt; 0, 1, 2, 0, 2, 0, 1, 0, 0, 1, 1, 1, 4, 1, 1, …
$ `Tropical Cyclone Count` &lt;dbl&gt; 1, 0, 0, 1, 0, 3, 0, 0, 0, 1, 0, 1, 2, 0, 1, …
$ `Wildfire Count`         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, …
$ `Winter Storm Count`     &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 2, …
$ Disasters                &lt;dbl&gt; 3, 2, 3, 5, 2, 5, 2, 0, 1, 5, 3, 4, 7, 5, 6, …</code></pre>
<p>Great, now we are going to remove some of these variables and just
keep the variables of interest using <code>select()</code>.</p>
<p>We are also going to add a new variable called <code>Country</code>
to indicate that this data is from the United States. Again this will
create a new variable where every value is
<code>United States</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&lt;&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Year, Disasters) <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Country =</span> <span class="st">&quot;United States&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>Country, <span class="sc">-</span>Year),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Indicator&quot;</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Label =</span> <span class="st">&quot;Number of Disasters&quot;</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
   Year Country       Indicator Value Label              
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;              
1  1980 United States Disasters     3 Number of Disasters
2  1981 United States Disasters     2 Number of Disasters
3  1982 United States Disasters     3 Number of Disasters
4  1983 United States Disasters     5 Number of Disasters
5  1984 United States Disasters     2 Number of Disasters
6  1985 United States Disasters     5 Number of Disasters</code></pre>
<p>Great, this looks good now.</p>
<div id="section-32" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>This dataset was slightly different from the other datasets and
therefore required slightly different wrangling. Why was it necessary to
exclude the <code>Year</code> variable from the
<code>pivot_longer()</code> function? What would happen if we did not
exclude <code>Year</code>?</p>
</div>
<div id="section-33" class="section level4">
<h4></h4>
</div>
</div>
<div id="temperature" class="section level3">
<h3><strong>Temperature</strong></h3>
<hr />
<p>Next, we consider the temperature in the US over time.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
    Date Value Anomaly
   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 189512  50.3   -1.68
2 189612  52.0   -0.03
3 189712  51.6   -0.46
4 189812  51.4   -0.59
5 189912  51.0   -1.01
6 190012  52.8    0.75</code></pre>
<p>So a few things need to be fixed here.</p>
<p>First, the <code>Date</code> column looks a bit strange. The format
of the numbers look like the year followed by the number 12
(representing 12 months).</p>
<p>We want to change this to only keep the first 4 characters in the
<code>Date</code> variable string values.</p>
<p>However, first let’s make sure that indeed all of the
<code>Date</code> variables are 6 characters long and that they all end
with the number 12.</p>
<p>We can use a couple of functions in the <code>stringr</code> package
to do this. This package is used for working with character strings. The
<code>str_length()</code> function can be used to check the length of
each value, while the <code>str_ends()</code> function can be used to
check that all the values end with <code>"12"</code>.</p>
<p>Let’s start with the <code>str_length()</code> function. These
functions in the <code>stringr</code> package require a character
vector. Thus we need to pull the values for the <code>Date</code>
variable first using the <code>pull()</code> function of the
<code>dplyr</code> package.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_length</span>()</span></code></pre></div>
<pre><code>  [1] 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6
 [38] 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6
 [75] 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6
[112] 6 6 6 6 6 6 6 6 6 6 6 6 6 6</code></pre>
<p>Great! It looks like all of the values are 6 characters long.</p>
<p>Now let’s check that they all end with <code>"12"</code>. We just
need to specify what pattern to look for.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_ends</span>(<span class="at">pattern =</span> <span class="st">&quot;12&quot;</span>)</span></code></pre></div>
<pre><code>  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [31] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [46] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [61] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [76] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
 [91] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[106] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[121] TRUE TRUE TRUE TRUE TRUE</code></pre>
<p>Great! Since all of the values are <code>TRUE</code> we know that all
of the values in the <code>Date</code> variable end with
<code>"12"</code>.</p>
<p>It’s a good idea to always check that your data is as you expect.</p>
<p>Now we can use the <code>str_sub()</code> function of the
<code>stringr</code> package to remove the <code>"12"</code> from each
<code>Date</code> value.</p>
<p>We just need to indicate the start and stop characters.</p>
<p>In this case the start would be 1 and the 4th character would be
where we want to stop, so we would use <code>start = 1, stop = 4</code>.
We can do this inside of the <code>mutate()</code> function to modify
the <code>Date</code> variable. In doing so, we will not need to use
<code>pull()</code> to pull the values for the <code>Date</code>
variable.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&lt;&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">str_sub</span>(Date, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">4</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>us_temperature</span></code></pre></div>
<pre><code># A tibble: 125 × 3
   Date  Value Anomaly
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 1895   50.3   -1.68
 2 1896   52.0   -0.03
 3 1897   51.6   -0.46
 4 1898   51.4   -0.59
 5 1899   51.0   -1.01
 6 1900   52.8    0.75
 7 1901   51.9   -0.15
 8 1902   51.6   -0.43
 9 1903   50.6   -1.4 
10 1904   51.2   -0.86
# … with 115 more rows</code></pre>
<p>We also want to remove the <code>Anomaly</code> variable, which is an
indicator of how different the national average temperature for that
year was from the average temperature from 1901-2000 which was
52.02°F.</p>
<p>Then, we also want to create a <code>Country</code> variable. We will
also change the name of the <code>Date</code> variable to
<code>Year</code> so that it will be consistent with our other datasets.
We also also want the <code>Year</code> to be numeric. We can accomplish
both renaming and changing to numeric by using the <code>mutate()</code>
function.</p>
<p>We also want to create an <code>Indicator</code> variable so that we
can later tell what data the values in this tibble represent if we
combine it with other tibbles and a <code>Label</code> variable, so that
we will have informative labels if we make a plot with this data
later.</p>
<p>Finally, we remove the <code>Date</code> variable and also order the
columns just like the other us data using the <code>select()</code>
function.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&lt;&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Anomaly) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Country =</span> <span class="st">&quot;United States&quot;</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">as.numeric</span>(Date),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Indicator =</span> <span class="st">&quot;Temperature&quot;</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Label =</span> <span class="st">&quot;Temperature (Fahrenheit)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Country, Indicator, Value, Label)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&gt;%</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
   Year Country       Indicator   Value Label                   
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                   
1  1895 United States Temperature  50.3 Temperature (Fahrenheit)
2  1896 United States Temperature  52.0 Temperature (Fahrenheit)
3  1897 United States Temperature  51.6 Temperature (Fahrenheit)
4  1898 United States Temperature  51.4 Temperature (Fahrenheit)
5  1899 United States Temperature  51.0 Temperature (Fahrenheit)
6  1900 United States Temperature  52.8 Temperature (Fahrenheit)</code></pre>
</div>
</div>
<div id="joining-data" class="section level2">
<h2><strong>Joining data</strong></h2>
<hr />
<p>Now that we have wrangled the individual datasets, we are ready to
put everything together. Specifically, we will <em>join</em> the
individual datasets into one tibble using <code>*_join()</code>
functions available in the <code>dplyr</code> package.</p>
<p>Before we begin though, we will need to make sure that there is at
least one variable/column that has the same name across all datasets to
be joined. Such variables with common names are called
<strong>keys</strong> for joining your data.</p>
<p>These are the <code>by="x1"</code> arguments below where
<code>x1</code> is the name of the column in both the <code>a</code> and
<code>b</code> datasets that we will join together.</p>
<p><img src="img/join.png" width="500 px" style="display: block; margin: auto;" /></p>
<div id="source-10" class="section level5">
<h5><a
href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf"
target="_blank">[source]</a></h5>
<p>There are several types of <code>*_join()</code> functions to
consider. The <code>full_join()</code> function keeps all rows from both
tibbles that are being joined and adds <code>NA</code> values as
necessary if there are values within the key for either of the tibbles
that is is not in the key of the other tibble.</p>
<p>We use the <code>full_join()</code> function as we have different
time spans for each dataset and we would like to retain as much data as
possible.</p>
<p>The <code>full_join()</code> function will simply create
<code>NA</code> values for any of the years that are not in one of the
datasets.</p>
<p>First, we check using the base <code>summary()</code> function that
there are column names that are consistent in each dataset that we wish
to combine.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CO2_emissions)</span></code></pre></div>
<pre><code>   Country               Year        Emissions           Label          
 Length:50688       Min.   :1751   Min.   :       0   Length:50688      
 Class :character   1st Qu.:1817   1st Qu.:     550   Class :character  
 Mode  :character   Median :1882   Median :    4390   Mode  :character  
                    Mean   :1882   Mean   :   83808                     
                    3rd Qu.:1948   3rd Qu.:   31925                     
                    Max.   :2014   Max.   :10300000                     
                                   NA&#39;s   :33772                        </code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gdp_growth)</span></code></pre></div>
<pre><code>   Country               Year           GDP             Label          
 Length:42486       Min.   :1801   Min.   :-67.500   Length:42486      
 Class :character   1st Qu.:1855   1st Qu.:  0.133   Class :character  
 Mode  :character   Median :1910   Median :  0.633   Mode  :character  
                    Mean   :1910   Mean   :  1.302                     
                    3rd Qu.:1965   3rd Qu.:  2.160                     
                    Max.   :2019   Max.   :145.000                     
                                   NA&#39;s   :2392                        </code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(energy_use)</span></code></pre></div>
<pre><code>   Country               Year          Energy            Label          
 Length:9464        Min.   :1960   Min.   :    9.58   Length:9464       
 Class :character   1st Qu.:1974   1st Qu.:  505.75   Class :character  
 Mode  :character   Median :1988   Median : 1185.00   Mode  :character  
                    Mean   :1988   Mean   : 2238.82                     
                    3rd Qu.:2001   3rd Qu.: 3030.00                     
                    Max.   :2015   Max.   :22000.00                     
                                   NA&#39;s   :3544                         </code></pre>
</div>
<div id="section-34" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What variable or variables might we want to use to join our data
by?</p>
</div>
<div id="section-35" class="section level4">
<h4></h4>
<hr />
<details>
<summary>
Click here to see an explanation for what variable or variables to join
by after you have thought about it.
</summary>
<p>The <code>Country</code>, and <code>Year</code> variables are present
in all of the datasets with values that overlap. Although
<code>Label</code> is also present in the datasets, the values do not
overlap. We can see that the minimum and maximum year is different for
nearly all the datasets.</p>
<p>Next, we need to specify what columns/variables we will be joining by
using the <code>by =</code> argument in the <code>full_join()</code>
function, (recall that this variable is called the “key”)</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>data_wide <span class="ot">&lt;-</span> CO2_emissions <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gdp_growth, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Label&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(energy_use, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Label&quot;</span>))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>data_wide <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 6
  Country                   Year Emissions Label                      GDP Energy
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt;
1 Angola                    1899        NA GDP Growth/Capita (%)    0.425     NA
2 Central African Republic  1974        NA GDP Growth/Capita (%)   -4.92      NA
3 Bahamas                   1832        NA CO2 Emissions (Metric … NA         NA
4 Montenegro                1843        NA CO2 Emissions (Metric … NA         NA
5 Croatia                   2015        NA Energy Use (kg, oil-eq… NA         NA
6 Israel                    1885        NA GDP Growth/Capita (%)    0.582     NA</code></pre>
<hr />
<details>
<summary>
Click here to see an explanation for another option that works well for
large numbers of tibbles
</summary>
<p>We can also do the same thing by using the <code>reduce()</code>
function of the <code>purrr</code> package. This takes a list of
elements (which can be tibbles) and then applies a function that
requires two inputs iteratively using the first pair of elements and
creating a single element and then applying the function again to the
output element and the next listed element and so on and so forth.</p>
<p>For example we will use a list of tibbles and the
<code>full_join()</code> function which requires two tibbles to combine.
This will first combine <code>CO2_emissions</code> and
<code>gdp_growth</code> and then take the resulting joined tibble and
combine this with the <code>energy_use</code> tibble.</p>
<p>You can see that this is a great option if you have many datasets to
combine!</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>data_wide <span class="ot">&lt;-</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(CO2_emissions, gdp_growth, energy_use) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(full_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Label&quot;</span>))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>data_wide <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 6
  Country                   Year Emissions Label                      GDP Energy
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt;
1 Angola                    1899        NA GDP Growth/Capita (%)    0.425     NA
2 Central African Republic  1974        NA GDP Growth/Capita (%)   -4.92      NA
3 Bahamas                   1832        NA CO2 Emissions (Metric … NA         NA
4 Montenegro                1843        NA CO2 Emissions (Metric … NA         NA
5 Croatia                   2015        NA Energy Use (kg, oil-eq… NA         NA
6 Israel                    1885        NA GDP Growth/Capita (%)    0.582     NA</code></pre>
</details>
</details>
<hr />
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>data_wide <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 102,638
Columns: 6
$ Country   &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, …
$ Year      &lt;dbl&gt; 1751, 1752, 1753, 1754, 1755, 1756, 1757, 1758, 1759, 1760, …
$ Emissions &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Label     &lt;chr&gt; &quot;CO2 Emissions (Metric Tons)&quot;, &quot;CO2 Emissions (Metric Tons)&quot;…
$ GDP       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Energy    &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</code></pre>
<p>Nice, looks good!</p>
<p>We will also make a long version of this data, where we will create
an new variable called <code>Indicator</code> that will indicate what
dataset the data came from.</p>
</div>
<div id="section-36" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Try to come up with the code to do this.</p>
</div>
<div id="section-37" class="section level4">
<h4></h4>
<hr />
<details>
<summary>
Click here to reveal the code.
</summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data_wide <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>Country, <span class="sc">-</span>Year, <span class="sc">-</span>Label),</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;Indicator&quot;</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>)</span></code></pre></div>
</details>
<hr />
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Country      Year Label                       Indicator   Value
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;       &lt;dbl&gt;
1 Ethiopia     1829 GDP Growth/Capita (%)       GDP        0.0197
2 Tanzania     1820 CO2 Emissions (Metric Tons) Energy    NA     
3 South Sudan  1907 CO2 Emissions (Metric Tons) GDP       NA     
4 Bangladesh   1931 GDP Growth/Capita (%)       GDP       -2     
5 Mongolia     1805 GDP Growth/Capita (%)       Emissions NA     
6 Spain        1805 CO2 Emissions (Metric Tons) Emissions NA     </code></pre>
<p>We will now combine this data with the US data about disasters and
temperatures.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>us_disaster <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
   Year Country       Indicator Value Label              
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;              
1  1980 United States Disasters     3 Number of Disasters
2  1981 United States Disasters     2 Number of Disasters
3  1982 United States Disasters     3 Number of Disasters
4  1983 United States Disasters     5 Number of Disasters
5  1984 United States Disasters     2 Number of Disasters
6  1985 United States Disasters     5 Number of Disasters</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>us_temperature <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
   Year Country       Indicator   Value Label                   
  &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                   
1  1895 United States Temperature  50.3 Temperature (Fahrenheit)
2  1896 United States Temperature  52.0 Temperature (Fahrenheit)
3  1897 United States Temperature  51.6 Temperature (Fahrenheit)
4  1898 United States Temperature  51.4 Temperature (Fahrenheit)
5  1899 United States Temperature  51.0 Temperature (Fahrenheit)
6  1900 United States Temperature  52.8 Temperature (Fahrenheit)</code></pre>
<p>We will now use the <code>bind_rows()</code> function of the
<code>dplyr</code> package which will just append the
<code>us_temperature</code> data and the <code>us_disaster</code> data
after the <code>data_long</code> data.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(data_long, us_disaster, us_temperature) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Country =</span> <span class="fu">as.factor</span>(Country))</span></code></pre></div>
<p>We also converted the <code>Country</code> column to a factor in the
last line of the code chunk.</p>
<p>We can check the top and bottom of the new <code>data_long</code>
tibble to see that our <code>us_temperature</code> data is at the
bottom. To see the end of our tibble we can use
<code>slice_tail()</code> function of the <code>dplyr</code>
package.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Country      Year Label                       Indicator Value
  &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;     &lt;dbl&gt;
1 Afghanistan  1751 CO2 Emissions (Metric Tons) Emissions    NA
2 Afghanistan  1751 CO2 Emissions (Metric Tons) GDP          NA
3 Afghanistan  1751 CO2 Emissions (Metric Tons) Energy       NA
4 Afghanistan  1752 CO2 Emissions (Metric Tons) Emissions    NA
5 Afghanistan  1752 CO2 Emissions (Metric Tons) GDP          NA
6 Afghanistan  1752 CO2 Emissions (Metric Tons) Energy       NA</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  Country        Year Label                    Indicator   Value
  &lt;fct&gt;         &lt;dbl&gt; &lt;chr&gt;                    &lt;chr&gt;       &lt;dbl&gt;
1 United States  2014 Temperature (Fahrenheit) Temperature  52.5
2 United States  2015 Temperature (Fahrenheit) Temperature  54.4
3 United States  2016 Temperature (Fahrenheit) Temperature  54.9
4 United States  2017 Temperature (Fahrenheit) Temperature  54.6
5 United States  2018 Temperature (Fahrenheit) Temperature  53.5
6 United States  2019 Temperature (Fahrenheit) Temperature  52.7</code></pre>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code># A tibble: 10 × 5
   Country      Year Label                       Indicator   Value
   &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;       &lt;dbl&gt;
 1 Ethiopia     1829 GDP Growth/Capita (%)       GDP        0.0197
 2 Tanzania     1820 CO2 Emissions (Metric Tons) Energy    NA     
 3 South Sudan  1907 CO2 Emissions (Metric Tons) GDP       NA     
 4 Bangladesh   1931 GDP Growth/Capita (%)       GDP       -2     
 5 Mongolia     1805 GDP Growth/Capita (%)       Emissions NA     
 6 Spain        1805 CO2 Emissions (Metric Tons) Emissions NA     
 7 Germany      1858 GDP Growth/Capita (%)       Emissions NA     
 8 Fiji         1837 CO2 Emissions (Metric Tons) GDP       NA     
 9 Jamaica      1823 CO2 Emissions (Metric Tons) Emissions NA     
10 Iceland      1926 CO2 Emissions (Metric Tons) Emissions NA     </code></pre>
<hr />
<details>
<summary>
Click here for details about the difference between
<code>full_join()</code> and <code>bind_rows()</code>
</summary>
<p>The difference between this function and the <code>full_join()</code>
function is that the <code>bind_rows()</code> function will essentially
just append each dataset to each other, whereas the
<code>full_join()</code> function collapses data that is comparable.
Here, you will see an example of what the data would have been like for
<code>data_wide</code> if we had made it using <code>bind_rows()</code>
and if <code>full_join()</code> had been used but was not joined by the
<code>Label</code> variable. Since the <code>Label</code> variable has
unique values for each type of <code>Indicator</code>, this causes the
<code>full_join()</code> result to be the same as
<code>bind_rows()</code>.</p>
<p>Let’s consider an example and look at the values for China in the
year of 1980.</p>
<p>First we will use the <code>bind_rows()</code> function which
automatically creates <code>NA</code> values for any variable that is
missing from a data object that is added by combining the data object
with another that contains that missing variable using this
function.</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>data_wide_br <span class="ot">&lt;-</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(CO2_emissions, gdp_growth, energy_use) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>data_wide_br <span class="sc">%&gt;%</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;China&quot;</span>,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>           Year <span class="sc">==</span> <span class="dv">1980</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 6
  Country  Year Emissions Label                             GDP Energy
  &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                           &lt;dbl&gt;  &lt;dbl&gt;
1 China    1980   1470000 CO2 Emissions (Metric Tons)     NA        NA
2 China    1980        NA GDP Growth/Capita (%)            2.16     NA
3 China    1980        NA Energy Use (kg, oil-eq./capita) NA       609</code></pre>
<p>We see that we have three rows of data.</p>
<p>Now we will use the <code>full_join()</code> function two ways. First
we will combine by <code>Country</code> and <code>Year</code> and
<code>Label</code>.</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>data_wide_fj_label <span class="ot">&lt;-</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(CO2_emissions, gdp_growth, energy_use) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(full_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Year&quot;</span>, <span class="st">&quot;Label&quot;</span>))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>data_wide_fj_label <span class="sc">%&gt;%</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;China&quot;</span>, Year <span class="sc">==</span> <span class="st">&quot;1980&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 6
  Country  Year Emissions Label                             GDP Energy
  &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                           &lt;dbl&gt;  &lt;dbl&gt;
1 China    1980   1470000 CO2 Emissions (Metric Tons)     NA        NA
2 China    1980        NA GDP Growth/Capita (%)            2.16     NA
3 China    1980        NA Energy Use (kg, oil-eq./capita) NA       609</code></pre>
<p>Again we have 3 rows of data. The data produced by
<code>bind_rows()</code> and <code>full_join()</code> is identical
(which we can check by using the <code>setequal()</code> function of the
<code>dplyr</code> package) and has the same dimensions (which we can
check by using the <code>dim()</code> base function).</p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_wide_br)</span></code></pre></div>
<pre><code>[1] 102638      6</code></pre>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_wide_fj_label)</span></code></pre></div>
<pre><code>[1] 102638      6</code></pre>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setequal</span>(data_wide_fj_label, data_wide_br)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>However, now we will join by only <code>Country</code> and
<code>Year</code>:</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>data_wide_fj <span class="ot">&lt;-</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(CO2_emissions, gdp_growth, energy_use) <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(full_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Year&quot;</span>))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>data_wide_fj <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;China&quot;</span>, Year <span class="sc">==</span> <span class="st">&quot;1980&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 8
  Country  Year Emissions Label.x                       GDP Label.y Energy Label
  &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
1 China    1980   1470000 CO2 Emissions (Metric Tons)  2.16 GDP Gr…    609 Ener…</code></pre>
<p>Now we see that we have only a single row. The data that corresponds
to the same year and country has been collapsed into a single but wider
row.</p>
<p>This is something to keep in mind when you are wrangling your data.
The choice of what function to use and how should depend on how you want
the data to be after you combine the different sources of data
together.</p>
</details>
<hr />
<p>We have a few more things to do before we leave the data wrangling
section.</p>
<p>We will create a new variable called <code>Region</code> that will
indicate if the data is about the United States or a different country
based on the values in the <code>Country</code> variable. To do this, we
will use the <code>case_when()</code> function of the <code>dplyr</code>
package.</p>
<p>For example, if the <code>Country</code> variable is equal to
<code>"United States"</code> the value for the new variable will also be
<code>"United States"</code>, where as if the <code>Country</code>
variable is not equal to <code>"United States"</code> but is some other
character string value, such as <code>"Afghanistan"</code>, then the
value for the new variable will be <code>"Rest of the World"</code>. We
can specify that something is not equal by using the <code>!=</code>
operator.</p>
<p>The new values for the new variable <code>Region</code> are indicated
after the specific conditional statements by using the <code>~</code>
symbol.</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&lt;&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span> <span class="sc">~</span> <span class="st">&quot;United States&quot;</span>,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                            Country <span class="sc">!=</span> <span class="st">&quot;United States&quot;</span> <span class="sc">~</span> <span class="st">&quot;Rest of the World&quot;</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>data_long  <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Country) <span class="sc">%&gt;%</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 6
  Country      Year Label                       Indicator Value Region          
  &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;           
1 Afghanistan  1751 CO2 Emissions (Metric Tons) Emissions    NA Rest of the Wor…
2 Afghanistan  1751 CO2 Emissions (Metric Tons) GDP          NA Rest of the Wor…
3 Afghanistan  1751 CO2 Emissions (Metric Tons) Energy       NA Rest of the Wor…
4 Afghanistan  1752 CO2 Emissions (Metric Tons) Emissions    NA Rest of the Wor…
5 Afghanistan  1752 CO2 Emissions (Metric Tons) GDP          NA Rest of the Wor…
6 Afghanistan  1752 CO2 Emissions (Metric Tons) Energy       NA Rest of the Wor…</code></pre>
<p>We can also remove rows for countries with <code>NA</code> values
using the <code>drop_na()</code> function of the <code>tidyr</code>
package to drop all years with missing data.</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>data_long_with_miss <span class="ot">&lt;-</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Country)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&lt;&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Country)</span></code></pre></div>
<p>You can see that by removing the NA values the data for Afghanistan
starts at 1949 instead of 1751.</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 6
  Country      Year Label                       Indicator Value Region          
  &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;           
1 Afghanistan  1949 CO2 Emissions (Metric Tons) Emissions  14.7 Rest of the Wor…
2 Afghanistan  1950 CO2 Emissions (Metric Tons) Emissions  84.3 Rest of the Wor…
3 Afghanistan  1951 CO2 Emissions (Metric Tons) Emissions  91.7 Rest of the Wor…
4 Afghanistan  1952 CO2 Emissions (Metric Tons) Emissions  91.7 Rest of the Wor…
5 Afghanistan  1953 CO2 Emissions (Metric Tons) Emissions 106   Rest of the Wor…
6 Afghanistan  1954 CO2 Emissions (Metric Tons) Emissions 106   Rest of the Wor…</code></pre>
</div>
<div id="section-38" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Using only data from the US, calculate the first and last year that a
value was reported for each variable (e.g. CO2 emissions, energy use,
etc).</p>
<p><b><u> Hint </u></b>: Use the <code>group_by()</code> and
<code>summarize()</code> functions in the <code>dplyr</code>
package.</p>
</div>
<div id="section-39" class="section level4">
<h4></h4>
<p>To allow users to skip import and wrangling we will save the data as
an RDA file as well as a CSV file as this is often useful to send our
data to collaborators. We will save this in a “wrangled” subdirectory of
our “data” directory of our working directory.</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(data_long, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_data.rda&quot;</span>))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(data_long, <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_data.csv&quot;</span>))</span></code></pre></div>
</div>
</div>
</div>
<div id="data-visualization" class="section level1">
<h1><strong>Data Visualization</strong></h1>
<hr />
<p>If you have been following along but stopped, we could load our
wrangled data like so:</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_data.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
If you skipped the data wrangling section click here.
</summary>
<p>First you need to install and load the <code>OCSdata</code>
package:</p>
<div class="sourceCode" id="cb121"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;OCSdata&quot;</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OCSdata)</span></code></pre></div>
<p>Then, you may load the wrangled data using the following code:</p>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrangled_rda</span>(<span class="st">&quot;ocs-bp-co2-emissions&quot;</span>, <span class="at">outpath =</span> <span class="fu">getwd</span>())</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;OCSdata&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_data.rda&quot;</span>))</span></code></pre></div>
<p>If the package does not work for you, alternatively, an RDA file
(stands for R data) of the data can be found <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/wrangled">here</a>
or slightly more directly <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/wrangled/wrangled_data.rda">here</a>.
Download this file and then place it in your current working directory
within a subdirectory called “wrangled” within a subdirectory called
“data” to copy and paste our code. We used an RStudio project and the <a
href="https://github.com/jennybc/here_here"><code>here</code>
package</a> to navigate to the file more easily.</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_data.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
Click here to see more about creating new projects in RStudio.
</summary>
<p>You can create a project by going to the File menu of RStudio like
so:</p>
<p><img src="img/New_project.png" width="60%" style="display: block; margin: auto;" /></p>
<p>You can also do so by clicking the project button:</p>
<p><img src="img/project_button.png" width="60%" style="display: block; margin: auto;" /></p>
<p>See <a
href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">here</a>
to learn more about using RStudio projects and <a
href="https://github.com/jennybc/here_here">here</a> to learn more about
the <code>here</code> package.</p>
</details>
<hr />
</details>
<hr />
<p>Now we will create some simple plots to examine the CO2 emissions
over time using the <code>ggplot2</code> package.</p>
<p>As you may have already seen, there are many functions available in
base R that can create plots (e.g. <code>plot()</code>,
<code>boxplot()</code>). Others include: <code>hist()</code>,
<code>qqplot()</code>, etc. These functions are great because they come
with a basic installation of R and can be quite powerful when you need a
quick visualization of something when you are exploring data.</p>
<p>We are choosing to introduce <code>ggplot2</code> because, in our
opinion, it is one of the simplest ways for beginners to create
relatively complicated plots that are intuitive and aesthetically
pleasing.</p>
<div id="the-ggplot2-r-package" class="section level2">
<h2><strong>The <code>ggplot2</code> R package</strong></h2>
<hr />
<p>The reasons <a
href="http://ggplot2.tidyverse.org"><code>ggplot2</code></a> is
generally intuitive for beginners is the use of <a
href="http://vita.had.co.nz/papers/layered-grammar.html">grammar of
graphics</a> or the <code>gg</code> in <code>ggplot2</code>. The idea is
that you can construct many sentences by learning just a few nouns,
adjectives, and verbs. There are specific “words” that we will
introduce, and once you are comfortable with them, you will be able to
create (or “write”) hundreds of different plots.</p>
<p>The critical part to making graphics using <code>ggplot2</code> is
the data needs to be in a <em>tidy</em> format. Given that we have just
spent time putting our data in <em>tidy</em> format, we are primed to
take advantage of all that <code>ggplot2</code> has to offer!</p>
<p>We will show how it is easy to pipe <em>tidy</em> data (output) as
input to other functions that create plots. This all works because we
are working within the <em>tidyverse</em>.</p>
<div id="what-is-the-ggplot-function" class="section level4">
<h4>What is the <code>ggplot()</code> function?</h4>
<p>As explained by Hadley Wickham:</p>
<blockquote>
<p>the grammar tells us that a statistical graphic is a mapping from
data to aesthetic attributes (colour, shape, size) of geometric objects
(points, lines, bars). The plot may also contain statistical
transformations of the data and is drawn on a specific coordinates
system.</p>
</blockquote>
</div>
<div id="ggplot2-terminology" class="section level4">
<h4><code>ggplot2</code> Terminology</h4>
<ul>
<li><strong>ggplot</strong> - the main function where you specify the
dataset and variables to plot (this is where we define the
<code>x</code> and <code>y</code> variable names)</li>
<li><strong>geoms</strong> - geometric objects
<ul>
<li>e.g. <code>geom_point()</code>, <code>geom_bar()</code>,
<code>geom_line()</code>, <code>geom_histogram()</code></li>
</ul></li>
<li><strong>aes</strong> - aesthetics
<ul>
<li>shape, transparency, color, fill, line types</li>
</ul></li>
<li><strong>scales</strong> - define how your data will be plotted
<ul>
<li>continuous, discrete, log, etc</li>
</ul></li>
</ul>
<p>The function <code>aes()</code> is an aesthetic mapping function
inside the <code>ggplot()</code> object. We use this function to specify
plot attributes (e.g. <code>x</code> and <code>y</code> variable names)
that will not change as we add more layers.</p>
<p>Anything that goes in the <code>ggplot()</code> object becomes a
global setting. From there, we use the <code>geom</code> objects to add
more layers to the base <code>ggplot()</code> object. These will define
what we are interested in illustrating using the data.</p>
</div>
</div>
<div id="co2-emissions" class="section level2">
<h2><strong>CO2 Emissions</strong></h2>
<p>Let’s start by plotting the CO2 emissions over time. Because our
dataset contains other variables, we first need to filter our data to
only include the CO2 emissions data by using the <code>filter()</code>
function of the <code>dplyr</code> package. To use this function we need
to specify what value (e.g. <code>Emissions</code>) we want for a given
variable or column (e.g. <code>Indicator</code>).</p>
<p>In this case, we filter to keep all rows where the
<code>Indicator</code> variable is equal to the word
<code>Emissions</code>. Notice that this needs to be in quotes, while
the variable name does not.</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 16,916 × 6
   Country      Year Label                       Indicator Value Region         
   &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;          
 1 Afghanistan  1949 CO2 Emissions (Metric Tons) Emissions  14.7 Rest of the Wo…
 2 Afghanistan  1950 CO2 Emissions (Metric Tons) Emissions  84.3 Rest of the Wo…
 3 Afghanistan  1951 CO2 Emissions (Metric Tons) Emissions  91.7 Rest of the Wo…
 4 Afghanistan  1952 CO2 Emissions (Metric Tons) Emissions  91.7 Rest of the Wo…
 5 Afghanistan  1953 CO2 Emissions (Metric Tons) Emissions 106   Rest of the Wo…
 6 Afghanistan  1954 CO2 Emissions (Metric Tons) Emissions 106   Rest of the Wo…
 7 Afghanistan  1955 CO2 Emissions (Metric Tons) Emissions 154   Rest of the Wo…
 8 Afghanistan  1956 CO2 Emissions (Metric Tons) Emissions 183   Rest of the Wo…
 9 Afghanistan  1957 CO2 Emissions (Metric Tons) Emissions 293   Rest of the Wo…
10 Afghanistan  1958 CO2 Emissions (Metric Tons) Emissions 330   Rest of the Wo…
# … with 16,906 more rows</code></pre>
<p>We also need to sum the emissions across countries for each year.
Here, we use the <code>group_by()</code> and <code>summarize()</code>
function that we previously learned about.</p>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value))</span></code></pre></div>
<pre><code># A tibble: 264 × 2
    Year Emissions
   &lt;dbl&gt;     &lt;dbl&gt;
 1  1751      9360
 2  1752      9360
 3  1753      9360
 4  1754      9370
 5  1755      9370
 6  1756     10000
 7  1757     10000
 8  1758     10000
 9  1759     10000
10  1760     10000
# … with 254 more rows</code></pre>
<p>Then, we use the <code>aes()</code> argument of the
<code>ggplot()</code> function to define that our x-axis will be the
<code>Year</code> variable, the y-axis will be the emission
<code>Value</code> variable, and that our data should be grouped or
separated by the <code>Country</code> variable.</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Emissions))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Looks like we got a blank plot. What happened? We need to tell R what
<em>type of plot</em> we want. To do that, we need to add another layer
to define how we want the plot to look. We do so by using the
<code>+</code> sign in between each command.</p>
<div id="line-plots" class="section level3">
<h3>Line plots</h3>
<p>To tell R what type of plot we want, we need to add another
<em>layer</em> to our ggplot object. To add a type of plot, we can use
one of the many <code>geom_*</code> functions in <code>ggplot2</code>.
For example, type <code>geom</code> into the RStudio console and you
will see many options to scroll through.</p>
<p><img src="img/geom_.png" width="800 px" style="display: block; margin: auto;" /></p>
<p>Here, we will use the <code>geom_line()</code> function because we
would like to create a line plot. We also use the <code>size</code>
argument in <code>geom_line()</code> to control the size of the
line.</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Emissions)) <span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-93-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Wow, the CO2 is really rising sharply!</p>
<p>Finally, let’s make this plot really nice by adding a few final
touches. To change title, caption, and the axis labels, we can use the
<code>labs()</code> function. Again, notice that a plus sign is used
between each layer that we add to the plot. To make CO2 appear with a
subscript we can use <code>~CO[2]~</code>.</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Emissions)) <span class="sc">+</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World &quot;</span> <span class="sc">~</span>CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot; Emissions per Year (1751-2014)&quot;</span>,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;Limited to reporting countries&quot;</span>,</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Emissions (Metric Tonnes)&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-94-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Next, we use the <code>theme()</code> function to change the font
size of the x-axis, y-axis, axis titles, and the caption as shown below.
To know what to call each element of the plot in this function to change
the size type <code>?theme()</code> in the console.</p>
<p>You will see a very large list that includes other plot aspects like
the background and the legend. This function can be used to modify your
plot to your specifications.</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Emissions)) <span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World &quot;</span> <span class="sc">~</span>CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot; Emissions per Year (1751-2014)&quot;</span>,</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;Limited to reporting countries&quot;</span>,</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Emissions (Metric Tonnes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-95-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can clearly see that global CO2 emissions have dramatically risen
since 1900.</p>
<p>Notice, we used the function <code>theme_linedraw()</code> of
<code>ggplot2</code> to change the general appearance of the plot.</p>
<p><strong>Useful tip</strong>: You can type <code>theme_</code> in the
RStudio console to see the various plot theme options available.</p>
<p><img src="img/themes.png" width="800 px" style="display: block; margin: auto;" /></p>
<p>Great! We’ve created our first plot.</p>
<p>Before we leave this section, let’s save this theme so we do not have
to keep typing the same code in future plots.</p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span></code></pre></div>
<p>In this way, we can just add another <em>layer</em> to our plot with
the <code>my_theme</code> we created with the specifications of the
sizes of the title and axis labels.</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>CO2_world <span class="ot">&lt;-</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Emissions =</span> <span class="fu">sum</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Emissions)) <span class="sc">+</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;World &quot;</span> <span class="sc">~</span>CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot; Emissions per Year (1751-2014)&quot;</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;Limited to reporting countries&quot;</span>,</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Emissions (Metric Tonnes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  my_theme</span></code></pre></div>
<p>We are also saving the plot to an object called
<code>CO2_world</code>. To show the plot we simply type the name of the
object:</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>CO2_world</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-99-1.png" width="90%" style="display: block; margin: auto;" />
Now let’s say we wanted to save this plot.</p>
<p>We could do so using the using the <code>save()</code> function to
save this to a “plot” directory in our working directory as an RDA file
and we can use the <code>png()</code> function to save a png for
collaborators. We need to use <code>dev.off()</code> function to close
the graphical device that we will use to create the png version of the
plot so that we are ready to make another plot like this.</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(CO2_world, <span class="at">file =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_world.rda&quot;</span>))</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_world.png&quot;</span>))</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>CO2_world</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>One thing that would be nice to know is which countries are
contributing the most or the least to CO2 emissions. Let’s continue to
explore the data to investigate how CO2 emissions from individual
countries have changed over time.</p>
<p>Next, we go back to using our <code>data_long</code> dataset. Here,
we use the <code>group</code> argument in <code>aes()</code> which
controls whether a line should be drawn</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">group =</span> Country)) <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Emissions&quot;</span>) <span class="sc">+</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  my_theme</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-101-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that many countries show a dramatic increase in emissions
over time with a handful of countries with particularly high levels.</p>
<div id="section-40" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<ul>
<li>What happens when you do not use the <code>group = Country</code>
argument?</li>
<li>What other aesthetic (i.e. <code>aes()</code> arguments) can be
changed?</li>
</ul>
</div>
<div id="section-41" class="section level4">
<h4></h4>
<p>Since we have many overlapping lines, we will make our lines slightly
transparent by using the <code>alpha</code> argument.</p>
<p>This takes values from 0 to 1, where 0 is completely transparent and
1 is completely opaque.</p>
<p>We also add our <code>my_theme</code> controlling the size of the
title and axis labels.</p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>CO2_countries <span class="ot">&lt;-</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">group =</span> Country)) <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Country&quot;</span> <span class="sc">~</span>CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot;Emissions per Year (1751-2014)&quot;</span>,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">caption =</span> <span class="st">&quot;Limited to reporting countries&quot;</span>,</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">&quot;Emissions (Metric Tonnes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  my_theme</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>CO2_countries</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-102-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Our plot is starting to look really good. One question you still
might have is which country corresponds to which line? Which line
indicates the emissions in the US?</p>
</div>
</div>
<div id="adding-color" class="section level3">
<h3>Adding color</h3>
<p>We can add another “layer” on top of our first plot to add a blue
line just for the US data. To do this we need to indicate what data we
would like to plot, so we need to filter for just the US data and then
we need to indicate that it will be colored by Country, even though in
this case we only have one line to color. The default color would be a
salmon pink color, but we would like blue. So we will use the
<code>scale_color_manual()</code> function to manually choose the color
that we want by using
<code>scale_colour_manual(values = c("blue"))</code>. Often you might
use red to highlight a subset of the data, however, this can be
difficult for viewers with certain types of colorblindness.</p>
<p>Notice how the color name needs to be in quotes and that the argument
<code>values =</code> is used to specify what color values to use.</p>
<p>We can add this line to the plot in two ways.</p>
<p><strong>Useful tip</strong>: Instead of retyping the original code to
create the <code>CO2_countries</code> plot, we can just use the
<code>+</code> operator:</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>CO2_countries <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                     Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>),</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">color =</span> Country)) <span class="sc">+</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-103-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It looks like the US has long been the largest CO2 emission producing
country until recently, when the US was surpassed by another
country.</p>
<p>Let’s figure out who are the top 10 emission producing countries in
2014. Here, we filter the data for the year 2014, which was the final
year of the data. Then, we can make a rank variable based on the
<code>Value</code> variable for the amount of emissions produced.</p>
<p>There are many functions in the <code>dplyr</code> package for
ranking values that are based on the <a
href="https://en.wikipedia.org/wiki/SQL" target="_blank">SQL</a> or
specifically <a
href="https://www.sqlshack.com/overview-of-sql-rank-functions/"
target="_blank">SQL rank functions</a>. SQL is another programming
language for managing large amounts of data. The difference in the rank
functions mostly has to do with how to deal with ties in the data.<br />
We will use <code>dense_rank()</code>, as we do not want gaps between
ranks.</p>
<p><img src="img/rank.png" width="600 px" style="display: block; margin: auto;" /></p>
<p>We want to do this in descending order because we want to rank by
largest to smallest, so we will use the <code>desc()</code> function of
the <code>dplyr</code> package. Then, we will arrange the output by rank
using the <code>arrange()</code> function of the <code>dplyr</code>
package.</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>top_10_count <span class="ot">&lt;-</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>, Year <span class="sc">==</span> <span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(Value))) <span class="sc">%&gt;%</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(rank)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>top_10_count</span></code></pre></div>
<pre><code># A tibble: 10 × 7
   Country        Year Label                       Indicator  Value Region  rank
   &lt;fct&gt;         &lt;dbl&gt; &lt;chr&gt;                       &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt;
 1 China          2014 CO2 Emissions (Metric Tons) Emissions 1.03e7 Rest …     1
 2 United States  2014 CO2 Emissions (Metric Tons) Emissions 5.25e6 Unite…     2
 3 India          2014 CO2 Emissions (Metric Tons) Emissions 2.24e6 Rest …     3
 4 Russia         2014 CO2 Emissions (Metric Tons) Emissions 1.71e6 Rest …     4
 5 Japan          2014 CO2 Emissions (Metric Tons) Emissions 1.21e6 Rest …     5
 6 Germany        2014 CO2 Emissions (Metric Tons) Emissions 7.2 e5 Rest …     6
 7 Iran           2014 CO2 Emissions (Metric Tons) Emissions 6.49e5 Rest …     7
 8 Saudi Arabia   2014 CO2 Emissions (Metric Tons) Emissions 6.01e5 Rest …     8
 9 South Korea    2014 CO2 Emissions (Metric Tons) Emissions 5.87e5 Rest …     9
10 Canada         2014 CO2 Emissions (Metric Tons) Emissions 5.37e5 Rest …    10</code></pre>
<p>We can see that China is now the top emission producing country.</p>
<div id="section-42" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What are the bottom 10 emission producing countries in 2014?</p>
</div>
<div id="section-43" class="section level4">
<h4></h4>
<p>Let’s make a plot of <em>just these top ten countries</em>.</p>
<p>To do this, we need to filter the data to just these top countries by
using the <code>%in%</code> operator to only keep countries in our
<code>Country</code> variable that are also in the <code>Country</code>
variable within <code>top_10_count</code>. We can use the
<code>pull()</code> function also of the <code>dplyr</code> package to
specifically grab just the <code>Country</code> data out of
<code>top_10_count</code>.</p>
<p>Since we have 10 countries we will want to differentiate them by
color.</p>
<p>To color our plot we will use the <code>viridis</code> color palette
which is compatible with color-blindness by using the
<code>scale_color_viridis_d()</code> function. This function is
available by loading the <code>ggplot2</code> package. There are a few
variations for discrete values as <code>_d</code>, or binned continuous
values as <code>_b</code>, or continuous values as <code>_c</code>. See
<a
href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">here</a>
for more information.</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="ot">&lt;-</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1900</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">color =</span> Country)) <span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top 10 Emissions-producing Countries in 2010 (1900-2014)&quot;</span>,</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Ordered by Emissions Produced in 2014&quot;</span>,</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Emissions (Metric Tons)&quot;</span>,</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    my_theme</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>Top10b</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-106-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It’s still a bit difficult to tell which line corresponds to which
country. So, let’s add a text label directly to the plot. .</p>
</div>
</div>
<div id="adding-text-labels" class="section level3">
<h3>Adding text labels</h3>
<p>One way to do this is to add text layer to our plot using the
<code>geom_text()</code> function of the <code>ggplot2</code> package.
We need to first specify what variable or column we will use. However,
we only want to pull the text labels for the top ten countries in the
last year. To do this, we use the <code>last()</code> function of the
<code>dplyr</code> package.</p>
<p>Then, we need to indicate that our text label will be based on the
<code>Country</code> variable using the <code>aes()</code> aesthetics
mapping argument. We will also get rid of our legend since we will not
need it anymore, by using the <code>theme()</code> function of the
<code>ggplot2</code> package.</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">last</span>(Year)),</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> Country)) <span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Not bad, but some of the labels are overlapping and difficult to
read. We can use the <code>check_overlap = TRUE</code> argument within
the <code>geom_text()</code> function to remove overlapping variables.
Also, we can expand the plot area horizontally so that the names are not
cutoff by using <code>scale_x_continuous(expand = c(0.2,0))</code>. This
takes a vector with two values. The first value indicates what
percentage to expand the x axis in both directions. In our case we will
expand by 15 percent. The second value indicates what absolute value to
expand the limit of the x axis. In our case <code>c(0.15,0)</code> will
achieve a similar result as <code>c(0, 17)</code>, as the range of
values from 1990 to 2014 is 114 years and 15% of this is 17.</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="sc">+</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">last</span>(Year)),</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> Country),</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This is easier to read now, but it also causes us to lose some of the
labels. There are several alternative ways we can keep all of our labels
and make them easier to read. The first package we will show is called
<code>directlabels</code>.</p>
<p>The most simple option is to use the <code>direct.label()</code>
function, which will automatically add labels at the end of the lines.
However, it is a bit difficult to see some of our labels as they get
automatically sized to fit the plot.</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">direct.label</span>(Top10b) <span class="sc">+</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-109-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Alternatively this can be done within the <code>ggplot2</code>
framework by layering using the <code>geom_dl()</code> function.</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> Country), <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;last.bumpup&quot;</span>)) <span class="sc">+</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This is more legible now. We have all 10 countries names listed and
they are in order of the last data point and they are relatively close
to the lines that they correspond to.</p>
<p>Another option is to use a different method in the
<code>directlables</code> package. <a
href="http://directlabels.r-forge.r-project.org/docs/index.html"
target="_blank">Here</a> is a list of options.</p>
<p>For example, the <code>"angled.boxes"</code> method looks nice for
some plots but does not work very well for our plot:</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">direct.label</span>(Top10b, <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;angled.boxes&quot;</span>)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-111-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>However the <code>"last.polygons"</code> method works quite well:</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">direct.label</span>(Top10b, <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;last.polygons&quot;</span>)) <span class="sc">+</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-112-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The second package is the <code>ggrepel</code> package, which is
especially good for crowded labels that might overlap one another. It
allows for more control than the <code>directlabels</code> package.</p>
<p>Specifically, we will use the <code>geom_text_repel()</code> function
from the <code>ggrepel</code> package. Just like with
<code>geom_text()</code>, first we need to specify what data we want to
include. Then, we specify with the <code>aes()</code> argument that our
label will be based on the <code>Country</code> variable and we again
specify what variable to use for our x axis and y axis, so that we
indicate where the labels should be plotted.</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="sc">+</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">last</span>(Year)),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> Country, <span class="at">x =</span> Year, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" width="90%" style="display: block; margin: auto;" />
You can see that this package creates segments that connect the label to
the line.</p>
<p>There are many arguments to use to style your labels just the way
that you want:</p>
<p><img src="img/ggrepel.png" width="600 px" style="display: block; margin: auto;" /></p>
<div id="source-11" class="section level5">
<h5><a
href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"
target="_blank">[source]</a></h5>
<p>See <a
href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"
target="_blank">the ggrepel vignette</a> for more details.</p>
<p>Let’s play around with some of these options in the table above.</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>Top10b <span class="sc">+</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">last</span>(Year)),</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> Country, <span class="at">x =</span> Year, <span class="at">y =</span> Value),</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_x =</span> <span class="dv">10</span>,</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.size =</span> <span class="fl">0.25</span>,</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">force =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-115-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Nice, that looks pretty good. For fun, let’s try showing our data in
an entirely different way.</p>
</div>
</div>
<div id="tile-plots" class="section level3">
<h3>Tile plots</h3>
<p>This time we will create a <code>geom_tile</code> plot.</p>
<p>To create this plot we will filter our data to include only the
Countries included in the <code>Country</code> variable of the
<code>top_10_count</code>.</p>
<p>Then, we will use the <code>fct_reorder()</code> function of the
<code>forcats</code> package to order our countries based on the last
emission value in 2014.</p>
<p>To use this function, the variable that is to be reordered is listed
first. The variable that is being used to determine the order is listed
second. Finally, a function to apply to the variable listed second is
listed third. This function is used to determine the order. In this
case, we want to determine the last value of the <code>Value</code>
variable using the <code>last()</code> function (recall that this is
also a function of the <code>dplyr</code> package). Then, the
<code>Country</code> variable will be ordered by the last value of the
<code>Value</code> variable.</p>
<p>To color our plot we will use the <code>viridis</code> color palette
again but this time we will use the <code>scale_fill_viridis_c()</code>
– recall that the <code>_c</code> indicates a continuous scale. See <a
href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">the
scale_viridis reference</a> for more information.</p>
<div class="sourceCode" id="cb150"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>Top10t <span class="ot">&lt;-</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> <span class="fu">pull</span>(top_10_count, Country)) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">&quot;Emissions&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1900</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Country, Value, last))) <span class="sc">+</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log</span>(Value))) <span class="sc">+</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p>Finally, let’s clean up the axes and the axes labels:</p>
<div class="sourceCode" id="cb151"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>Top10t <span class="ot">&lt;-</span> Top10t <span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1900</span>, <span class="dv">2014</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1900</span>, <span class="dv">2014</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top 10 &quot;</span> <span class="sc">~</span>CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot;Emission-producing Countries&quot;</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Ordered by Emissions Produced in 2014&quot;</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Ln(CO2 Emissions (Metric Tonnes))&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>Top10t</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-117-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now let’s say we wanted to save this plot.</p>
<p>We could do so using the using the <code>save()</code> function to
save this to a “plot” directory in our working directory as an RDA file
and we can use the <code>png()</code> function to save a png for
collaborators. We need to use <code>dev.off()</code> function to close
the graphical device that we will use to create the png version of the
plot so that we are ready to make another plot like this.</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(Top10t, <span class="at">file =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;Top10t.rda&quot;</span>))</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;Top10t.png&quot;</span>))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>Top10t</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>We see that Germany had very low emission rates at the end of World
War II. We also see that the US has consistently had high emission rates
since 1900, but the emission rates in China recently surpassed that of
the US. The portions of the plot that are white indicate that there is
no emission data for that country.</p>
<div id="section-44" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Think about what the pros and cons are of tile and line plots. In
what situations would a tile plot be a better choice for effective
scientific communication? In what situations would a line plot be a
better choice?</p>
</div>
<div id="section-45" class="section level4">
<h4></h4>
</div>
</div>
</div>
<div id="more-than-one-variable" class="section level2">
<h2><strong>More than one variable</strong></h2>
<hr />
<p>Now, we will visualize all the variables in our dataset.</p>
<div id="faceted-plots" class="section level3">
<h3>Faceted plots</h3>
<p>Here, we use the <code>facet_wrap()</code> function of the
<code>ggplot2</code> package, which plots multiple subplots
simultaneously.</p>
<p>To use <code>facet_wrap()</code> with the option for a different
y-axis scale for each subplot, we need to set the <code>scales</code>
argument equal to <code>"free_y"</code>. We can also indicate where we
would like the label for the subplots to be located by using the
<code>strip.position</code> argument.</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">group =</span> Country)) <span class="sc">+</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_long <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">color =</span> Country)) <span class="sc">+</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Indicators by Year and Value&quot;</span>,</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Indicator Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  my_theme <span class="sc">+</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="sc">+</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Indicator <span class="sc">~</span> .,</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-119-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Notice that we can change the size or style of the font for these
labels using the <code>strip.text =</code> argument of the
<code>theme()</code> function. We can also specify how many rows or
columns we would like the subplots to be shown.</p>
<p>We can also facet by more than one variable
(e.g. <code>Indicator</code> and <code>Region</code> to show the data
from the US compared to other countries).</p>
<p>In this case we want the same y-axis to be used across the rows. We
will use the <code>facet_grid()</code> function this time instead of
<code>facet_wrap()</code> because of the way that the two facet
variables are displayed. The <code>facet_grid()</code> function will as
you might expect, create an output of plots that are displayed in a
grid.</p>
<p>The syntax here is to put the name of the two variables on the left
or right side of the <code>~</code> symbol, which tells you to facet by
rows (left) or columns (right).</p>
<p>First, we will filter out the data about disasters and temperature as
this is only for the US, by using the <code>filter()</code> function and
<code>!</code> indicates that we want only values of the
<code>Indicator</code> variable not in the list containing
<code>"Disasters"</code> and <code>"Temperature"</code>.</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Disasters&quot;</span>, <span class="st">&quot;Temperature&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">group =</span> Country)) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Indicator <span class="sc">~</span> Region, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Indicators by Year and Value&quot;</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Indicator Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>    my_theme <span class="sc">+</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-120-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>From these plots we can see that each type of data spans a different
time span.</p>
<div id="section-46" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What happens when you create the same plot with
<code>facet_wrap()</code>? Why might this be preferable in certain
cases?</p>
</div>
<div id="section-47" class="section level4">
<h4></h4>
</div>
<div id="section-48" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>Calculate the total number of countries per year reporting C02
emissions, energy use and GDP. Plot this summary statistic (y-axis)
across the years (x-axis). What do you see?</p>
<p><b><u> Hint </u></b>: Use the <code>tally()</code> function in the
<code>dplyr</code> package.</p>
</div>
<div id="section-49" class="section level4">
<h4></h4>
</div>
</div>
<div id="line-segment-plots" class="section level3">
<h3>Line segment plots</h3>
<p>There are also some other common visualization techniques that are
good for showing the difference between a set of observations and a mean
value across time.</p>
<p>One of those is a line segment plot. For simplicity, let’s focus only
on the data from the US. Let’s calculate the mean across all years for
the CO2 emission and temperature from 1980 to 2010. Recall that our
<code>Indicator</code> variable describes what kind of data we have
(Emissions, Temperature, GDP, Energy, Disasters). We will calculate the
mean for each <code>Indicator</code> set of data by first grouping by
this variable and then calculating the mean of the values of the
<code>Value</code> variable for each set of data. We will call this new
variable <code>Mean</code>. Then, we calculate the difference between
each observation and the mean and create a new variable for these values
called <code>Diff_from_mean</code>. Again, all of this is performed for
each group of data separately. Once we have created the new variables,
we want to use the <code>ungroup()</code> function so that we no longer
perform functions on subsets of the data based on the
<code>Indicator</code> variable. Finally, we will also create a factor
variable about the sign of the <code>Diff_from_mean</code> value to
distinguish positive or negative changes. We will use this to color our
plots.</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>data_long_us <span class="ot">&lt;-</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>, Year <span class="sc">&gt;=</span> <span class="dv">1980</span>, Year <span class="sc">&lt;=</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Indicator) <span class="sc">%&gt;%</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(Value), <span class="at">Diff_from_mean =</span> Value <span class="sc">-</span> Mean) <span class="sc">%&gt;%</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff_color =</span> <span class="fu">sign</span>(Diff_from_mean)) <span class="sc">%&gt;%</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff_color =</span> <span class="fu">as.factor</span>(Diff_color))</span></code></pre></div>
<div class="sourceCode" id="cb156"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_long_us)</span></code></pre></div>
<pre><code>Rows: 155
Columns: 9
$ Country        &lt;fct&gt; &quot;United States&quot;, &quot;United States&quot;, &quot;United States&quot;, &quot;Uni…
$ Year           &lt;dbl&gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1…
$ Label          &lt;chr&gt; &quot;CO2 Emissions (Metric Tons)&quot;, &quot;CO2 Emissions (Metric T…
$ Indicator      &lt;chr&gt; &quot;Emissions&quot;, &quot;Emissions&quot;, &quot;Emissions&quot;, &quot;Emissions&quot;, &quot;Em…
$ Value          &lt;dbl&gt; 4720000, 4540000, 4310000, 4340000, 4480000, 4490000, 4…
$ Region         &lt;chr&gt; &quot;United States&quot;, &quot;United States&quot;, &quot;United States&quot;, &quot;Uni…
$ Mean           &lt;dbl&gt; 5134194, 5134194, 5134194, 5134194, 5134194, 5134194, 5…
$ Diff_from_mean &lt;dbl&gt; -414193.548, -594193.548, -824193.548, -794193.548, -65…
$ Diff_color     &lt;fct&gt; -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,…</code></pre>
<p>Next, we use the <code>geom_segment()</code> function to draw a
straight line between points (<code>x</code>, <code>y</code>) and
(<code>xend</code>, <code>yend</code>). In our case, this creates a plot
that shows a bar for the difference between the observation and the mean
across all the years.</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>data_long_us <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Emissions&quot;</span>, <span class="st">&quot;Temperature&quot;</span>, <span class="st">&quot;Disasters&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">xend =</span> Year,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yend =</span> Mean, <span class="at">color =</span> Diff_color),</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">3.25</span>) <span class="sc">+</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> Mean), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Indicator <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="sc">+</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US Disasters, Emissions, and Temperatures (1990-2010)&quot;</span>,</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Indicator Mean of 1990-2010 Represented by Solid Black Line&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-123-1.png" width="90%" style="display: block; margin: auto;" />
We can see from this plot that overall there has been an increase in
disasters, emissions and temperature in the most recent years.</p>
<div id="section-50" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What trends do you see in GDP and energy use across time?</p>
</div>
<div id="section-51" class="section level4">
<h4></h4>
</div>
</div>
<div id="scatter-plots" class="section level3">
<h3>Scatter plots</h3>
<p>Next, let’s zoom in on two of the variables: CO2 emissions and
temperature. We use years between 1980 and 2014 as we have values for
all of those years for these two variables.</p>
<p>We know that the datasets do not span the same amount of time. So
let’s limit this plot to only the years where the data overlaps for both
CO2 emissions and temperature.</p>
<p>We use the <code>geom_point()</code> function to create a scatter
plot between the <code>x</code> and <code>y</code> variable defined in
<code>aes()</code> where <code>x</code> is time and <code>y</code> is
one of the two variables. We also add a line on top of the scatter plot
that smooths the trend from the points. The smoother we used here is
<code>loess</code> <a
href="https://en.wikipedia.org/wiki/Local_regression"
target="_blank">locally estimated scatterplot smoothing</a>, a type of
<a href="https://en.wikipedia.org/wiki/Local_regression"
target="_blank">local polynomial regression</a> fitting. This is a
nonparametric regression that is also called a “moving regression” where
subsets of points that are close to one another (hence the term local)
are used in a least squares linear or nonlinear fit. Thus this results
in a fit that may curve with the data.</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>CO2_temp_US_facet <span class="ot">&lt;-</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>, Year <span class="sc">&gt;=</span> <span class="dv">1980</span>, Year <span class="sc">&lt;=</span> <span class="dv">2014</span>,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>         Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Emissions&quot;</span>, <span class="st">&quot;Temperature&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1980</span>, <span class="dv">2014</span>, <span class="at">by =</span> <span class="dv">5</span>),</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1980</span>, <span class="dv">2014</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Label <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US Emissions and Temperatures (1980-2014)&quot;</span>)</span></code></pre></div>
<pre><code>$title
[1] &quot;US Emissions and Temperatures (1980-2014)&quot;

attr(,&quot;class&quot;)
[1] &quot;labels&quot;</code></pre>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>CO2_temp_US_facet</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-124-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Note, we are showing a different <code>theme</code> here, namely the
<code>theme_classic()</code> theme. We can see that there are similar
patterns of CO2 emission levels and average annual temperatures.</p>
<p>We will save this plot now like so to our “plots” directory:</p>
<div class="sourceCode" id="cb162"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(CO2_temp_US_facet, <span class="at">file =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_temp_US_facet.rda&quot;</span>))</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_temp_US_facet.png&quot;</span>))</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>CO2_temp_US_facet</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div id="section-52" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<ul>
<li>Try show a similar plot without filtering by years and faceting by
the other three variables: energy use, GDP and disasters. Are there
other variables that look like they might have a similar pattern to CO2
emissions?</li>
<li>Try using a different smoother in <code>geom_smooth()</code>.</li>
</ul>
</div>
<div id="section-53" class="section level4">
<h4></h4>
<p>Next, instead of looking at the variables separately in faceted
plots, let’s look at the relationship between CO2 emissions and other
variables directly. Thus, it is useful to have each of these indicators
as their own variable.</p>
<p>We can do this by using <code>pivot_wider()</code> to transform our
long data table into a wide format.</p>
<div class="sourceCode" id="cb163"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>wide_US <span class="ot">&lt;-</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  data_long <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>, Year <span class="sc">&gt;=</span> <span class="dv">1980</span>, Year <span class="sc">&lt;=</span> <span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Label) <span class="sc">%&gt;%</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Indicator, <span class="at">values_from =</span> Value)</span></code></pre></div>
<p>Let’s save this data as an rda file for future use and as a csv file,
as this is often useful for collaborators. We will save this in a
“wrangled” subdirectory of our “data” directory of our working
directory.</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(wide_US, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_US_data.rda&quot;</span>))</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(wide_US, <span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_US_data.csv&quot;</span>))</span></code></pre></div>
<p>Now we can specify which indicators we want to look at, so now we can
specifically look at emissions and temperature.</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>CO2_temp_US <span class="ot">&lt;-</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  wide_US <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Emissions, <span class="at">y =</span> Temperature)) <span class="sc">+</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US Emissions and Temperature (1980-2014)&quot;</span>,</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Emissions (Metric Tonnes)&quot;</span>,</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Temperature (Fahrenheit)&quot;</span>)</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>CO2_temp_US</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-128-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>It might be helpful to add a trend line to this. We can do so by
using the <code>geom_smooth()</code> function of the
<code>ggplot2</code> package.</p>
<p>If we want to look at a linear trend we need to specify the method
using the <code>method = lm</code> argument. This adds a line to the
data based on a linear model of the data using the <code>lm</code>
function of the <code>stats</code> package. We will discuss the se =
FALSE argument later.</p>
<p>We can just add this to the plot object that we just created to
create a plot with this trend line.</p>
<div class="sourceCode" id="cb166"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>CO2_temp_US <span class="ot">&lt;-</span> CO2_temp_US <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>CO2_temp_US </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-129-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Indeed, it does look like there is a positive, linear trend.</p>
<p>We will also save this plot:</p>
<div class="sourceCode" id="cb167"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(CO2_temp_US, <span class="at">file =</span>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_temp_US.rda&quot;</span>))</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_temp_US.png&quot;</span>))</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>CO2_temp_US</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="section-54" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<ul>
<li>Make similar plots for between CO2 emissions and other
variables.</li>
<li>Are there other pairs variables that look like they might have a
similar pattern to CO2 emissions?</li>
<li>Does this match what we saw above?</li>
<li>Do these trend look linear or non-linear?</li>
</ul>
</div>
<div id="section-55" class="section level4">
<h4></h4>
<p>Now that we see that there might be a linear relationship between CO2
emissions and temperature, let’s learn about some statistical techniques
to measure the strength of that relationship.</p>
</div>
</div>
</div>
</div>
<div id="data-analysis" class="section level1">
<h1><strong>Data Analysis</strong></h1>
<hr />
<p>If you are following along and stopped you could load the data you
will need like so:</p>
<div class="sourceCode" id="cb168"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_US_data.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
If you skipped the previous sections click here.
</summary>
<p>First you need to install and load the <code>OCSdata</code>
package:</p>
<div class="sourceCode" id="cb169"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;OCSdata&quot;</span>)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OCSdata)</span></code></pre></div>
<p>Then, you may load the wrangled data using the following code:</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wrangled_rda</span>(<span class="st">&quot;ocs-bp-co2-emissions&quot;</span>, <span class="at">outpath =</span> <span class="fu">getwd</span>())</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;OCSdata&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_US_data.rda&quot;</span>))</span></code></pre></div>
<p>If the package does not work for you, alternatively, an RDA file
(stands for R data) of the data (called
<code>wrangled_US_data.rda</code>) can be found <a
href="https://github.com//opencasestudies/ocs-bp-co2-emissions/tree/master/data/wrangled">here</a>
or slightly more directly <a
href="https://raw.githubusercontent.com/opencasestudies/ocs-bp-co2-emissions/master/data/wrangled/wrangled_US_data.rda">here</a>.
Download this file and then place it in your current working directory
within a subdirectory called “wrangled” within a subdirectory called
“data” to copy and paste our code. We used an RStudio project and the <a
href="https://github.com/jennybc/here_here"><code>here</code>
package</a> to navigate to the file more easily.</p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wrangled&quot;</span>, <span class="st">&quot;wrangled_US_data.rda&quot;</span>))</span></code></pre></div>
<hr />
<details>
<summary>
Click here to see more about creating new projects in RStudio.
</summary>
<p>You can create a project by going to the File menu of RStudio like
so:</p>
<p><img src="img/New_project.png" width="60%" style="display: block; margin: auto;" /></p>
<p>You can also do so by clicking the project button:</p>
<p><img src="img/project_button.png" width="60%" style="display: block; margin: auto;" /></p>
<p>See <a
href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">here</a>
to learn more about using RStudio projects and <a
href="https://github.com/jennybc/here_here">here</a> to learn more about
the <code>here</code> package.</p>
</details>
<hr />
</details>
<hr />
<p>In this section, we are going to introduce some ways to better
understand how two variables move together. We will focus on the CO2
emissions and temperature, but you will be encouraged to explore the
relationship between CO2 emissions and the other variables.</p>
<div id="basic-summary-statistics" class="section level3">
<h3><strong>Basic summary statistics</strong></h3>
<hr />
<p>We can always calculate the sample mean and variance for two
variables.</p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>wide_US <span class="sc">%&gt;%</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(Emissions), <span class="fu">mean</span>(Temperature), <span class="fu">sd</span>(Emissions), <span class="fu">sd</span>(Temperature))</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  `mean(Emissions)` `mean(Temperature)` `sd(Emissions)` `sd(Temperature)`
              &lt;dbl&gt;               &lt;dbl&gt;           &lt;dbl&gt;             &lt;dbl&gt;
1          5142286.                52.9         450549.             0.891</code></pre>
<p>These are useful, but on their own they do not summarize whether or
not there is a relationship between <code>Emissions</code> and
<code>Temperature</code> (also these are on different scales
entirely).</p>
<p>What else could we use? Next, we are going to learn about the
correlation coefficient, which is a summary statistic that describes how
two variables are related or move together.</p>
</div>
<div id="correlation-coefficient" class="section level3">
<h3><strong>Correlation coefficient</strong></h3>
<hr />
<p>We can use the <a
href="https://rafalab.github.io/dsbook/regression.html#corr-coefl"
target="_blank">correlation coefficient</a>. Here, we are using this
summary statistic to measure the strength of a <em>linear</em>
relationship between two variables.</p>
<p>If we plot one variable on the x-axis and the other variable on the
y-axis, we can see:</p>
<ol style="list-style-type: decimal">
<li>The strength of the relationship - based on how well the points form
a line<br />
</li>
<li>The direction of the relationship - based on if the points progress
upward or downward</li>
</ol>
<p>If the variables point upward in a very clear line, then there is a
strong positive relationship. If the points do not really form a line,
then there is a weak linear relationship or no linear relationship.
There may however be a nonlinear relationship if the points create a
different but defined shape.</p>
<p>See <a
href="https://towardsdatascience.com/estimating-non-linear-correlation-in-r-62c6571cb1db"
target="_blank">here</a> for more information on nonlinear
relationships.</p>
<p>If the points form a downward sloping line, then there is a negative
relationship.</p>
<p><img src="https://www.mathsisfun.com/data/images/correlation-examples.svg" width="800 px" style="display: block; margin: auto;" /></p>
<div id="source-12" class="section level5">
<h5><a href="https://www.mathsisfun.com/data/correlation.html"
target="_blank">[source]</a></h5>
<p>The numbers below each plot above are called correlation
coefficients. They range from -1 to 1. A value of zero indicates that
there is no correlation between the variables. While a value of 1 or -1
indicates perfect correlation, the closer the coefficient is to 1 or -1,
the stronger the relationship. The sign of the coefficient indicates the
direction of the relationship. If there is a negative relationship then
the variables show opposing changes from each other - as one gets larger
the other gets smaller. If the sign is positive, then the variables
increase similarly.</p>
<p>We previously made this plot:</p>
<p><img src="plots/CO2_temp_US.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s calculate the Pearson’s correlation coefficient called “Rho”
<span class="math inline">\(\rho\)</span> between CO2 emissions and
temperature in the US. There are a few ways to calculate a correlation
coefficient and this is one of the most common.</p>
<p>Formally, if we have a pair of observations <span
class="math inline">\((x_1, y_1), \dots, (x_n,y_n)\)</span>, the
correlation coefficient <span class="math inline">\(\rho\)</span>
between <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> is defined as</p>
<p><span class="math display">\[
\rho = \frac{1}{n-1} \sum_{i=1}^n \left( \frac{x_i-\mu_x}{\sigma_x}
\right)\left( \frac{y_i-\mu_y}{\sigma_y} \right)
\]</span> where <span class="math inline">\(\mu_x, \mu_y\)</span> are
the means of <span class="math inline">\(x_1,\dots, x_n\)</span> and
<span class="math inline">\(y_1, \dots, y_n\)</span>, respectively, and
<span class="math inline">\(\sigma_x, \sigma_y\)</span> are the standard
deviations.</p>
<p>Therefore, we can standardize the two variables and essentially
average (the denominator is n-1) the standardized values to calculate
the correlation coefficient <code>rho</code>.</p>
<p>Here we will manually perform the calculation. We will use the
<code>tally()</code> function of the <code>dplyr</code> package to get
the number of samples <span class="math inline">\(n\)</span>. In this
case this is equivalent to the number of rows in the
<code>wide_US</code> tibble. We need to then use the <code>pull()</code>
function to specifically grab the value out of the tibble that is
created from using this function. As you can see from using the base
<code>class()</code> function that this is a <code>tbl_df</code> which
is short for tibble data frame (the tidyverse version of a data frame)
rather than just a number.</p>
<div class="sourceCode" id="cb174"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(wide_US)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    35</code></pre>
<div class="sourceCode" id="cb176"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">tally</span>(wide_US))</span></code></pre></div>
<pre><code>[1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>When we check the class after using the <code>pull()</code> function
we see that it is an integer.</p>
<div class="sourceCode" id="cb178"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pull</span>(<span class="fu">tally</span>(wide_US), n)</span></code></pre></div>
<pre><code>[1] 35</code></pre>
<div class="sourceCode" id="cb180"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">pull</span>(<span class="fu">tally</span>(wide_US), n))</span></code></pre></div>
<pre><code>[1] &quot;integer&quot;</code></pre>
<p>We will also use the base <code>scale()</code> function to
standardize the <code>Emissions</code> and <code>Temperature</code>
values.</p>
<div class="sourceCode" id="cb182"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>wide_US <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rho =</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="fu">pull</span>(<span class="fu">tally</span>(wide_US), n) <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span>(<span class="fu">sum</span>(<span class="fu">scale</span>(Emissions) <span class="sc">*</span> <span class="fu">scale</span>(Temperature)))) <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(rho)</span></code></pre></div>
<pre><code>[1] 0.4711717</code></pre>
<p>Alternatively, you can use the <code>cor()</code> function in base R
like so:</p>
<div class="sourceCode" id="cb184"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>wide_US <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(<span class="at">x =</span> Emissions,</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> Temperature, </span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(r)</span></code></pre></div>
<pre><code>[1] 0.4711717</code></pre>
<p>If you want to learn more about why this is the calculation to
determine the strength of the relationship between two variables, see
this <a
href="https://bcheggeseth.github.io/Stat155Notes/two-quantitative-variables.html">link</a>.</p>
</div>
<div id="section-56" class="section level4 recall_code_question_block">
<h4 class="recall_code_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>There are different types of correlation coefficients. Look at the
help file for the <code>cor()</code> function by typing
<code>?cor()</code> into the RStudio Console to learn more and then try
a different <code>method</code>.</p>
<p>What are the differences?</p>
</div>
<div id="section-57" class="section level4">
<h4></h4>
</div>
<div id="section-58" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<ul>
<li>Try calculating the correlation coefficient between CO2 emissions
and the other variables.</li>
<li>What do you expect?</li>
</ul>
</div>
<div id="section-59" class="section level4">
<h4></h4>
<p>To test if the association between a pair of variables is <a
href="https://en.wikipedia.org/wiki/Statistical_significance">statistically
significant</a>, you can use the <code>cor.test()</code> of the
<code>stats</code> package to calculate the correlation coefficient, as
well as confidence intervals for correlation coefficients.</p>
<p>We can use the <code>tidy()</code> function of the <code>broom</code>
package to make the output more usable for working with in R. The role
of this function is to pull numeric values from outputs and create a
data frame of the values.</p>
<div class="sourceCode" id="cb186"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">pull</span>(wide_US, Emissions),</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">pull</span>(wide_US, Temperature))</span></code></pre></div>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  pull(wide_US, Emissions) and pull(wide_US, Temperature)
t = 3.0686, df = 33, p-value = 0.004277
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1636155 0.6952523
sample estimates:
      cor 
0.4711717 </code></pre>
<div class="sourceCode" id="cb188"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">cor.test</span>(<span class="fu">pull</span>(wide_US, Emissions),</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">pull</span>(wide_US, Temperature)))</span></code></pre></div>
<pre><code># A tibble: 1 × 8
  estimate statistic p.value parameter conf.low conf.high method         alter…¹
     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  
1    0.471      3.07 0.00428        33    0.164     0.695 Pearson&#39;s pro… two.si…
# … with abbreviated variable name ¹​alternative</code></pre>
<p>We see that the correlation coefficient quantifying the strength of
the linear relationship between C02 emissions and temperature is
statistically significant.</p>
</div>
</div>
<div id="relationship-between-correlation-and-linear-regression"
class="section level3">
<h3><strong>Relationship between correlation and linear
regression</strong></h3>
<hr />
<p>Let’s briefly discuss the relationship between correlation and linear
regression, which is further described in the <a
href="https://rafalab.github.io/dsbook/regression.html">Introduction to
Data Science book</a>.</p>
<p>We can use a regression line to predict a random variable <span
class="math inline">\(Y\)</span> given that we have gathered or observed
some data about another variable <span
class="math inline">\(X=x\)</span>. The regression line formally is
defined as:</p>
<p><span class="math display">\[ \left( \frac{Y-\mu_Y}{\sigma_Y} \right)
= \rho \left( \frac{x-\mu_X}{\sigma_X} \right) \]</span> where <span
class="math inline">\(\mu_X\)</span> and <span
class="math inline">\(\sigma_X\)</span> (<span
class="math inline">\(\mu_Y\)</span> and <span
class="math inline">\(\sigma_Y\)</span>) are the mean and standard
deviation of <span class="math inline">\(X\)</span> (<span
class="math inline">\(Y\)</span>), and <span
class="math inline">\(\rho\)</span> is correlation between <span
class="math inline">\(X\)</span> and <span
class="math inline">\(Y\)</span>. If <span
class="math inline">\(x\)</span> is larger than <span
class="math inline">\(\mu_X\)</span>, then for every <span
class="math inline">\(\sigma_X\)</span>, then <span
class="math inline">\(Y\)</span> will also increase <span
class="math inline">\(\rho\)</span> standard deviations above <span
class="math inline">\(\mu_Y\)</span>.</p>
<p>Re-organizing the terms so that <span
class="math inline">\(Y\)</span> is on the left side and everything else
is on the right side, we get:</p>
<p><span class="math display">\[ Y = \mu_Y + \rho \left(
\frac{x-\mu_X}{\sigma_X} \right) \sigma_Y \]</span> Thinking about some
extreme examples:</p>
<ul>
<li>If <span class="math inline">\(\rho\)</span> = 0 (i.e. no
correlation), we ignore the <span class="math inline">\(x\)</span> term
entirely and only predict <span class="math inline">\(Y\)</span> using
the mean <span class="math inline">\(\mu_Y\)</span>.</li>
<li>If <span class="math inline">\(\rho\)</span> = 1 (or -1)
(i.e. perfect correlation), the regression line predicts an increase (or
decrease) that is the same number of SDs.</li>
<li>If <span class="math inline">\(\rho\)</span> is between -1 and 1,
then we predict using both terms on the right hand side.</li>
</ul>
<p>To add regression lines to plots, we will need the above formula in
the form:</p>
<p><span class="math display">\[
y= b + mx \mbox{ with slope } m = \rho \frac{\sigma_y}{\sigma_x} \mbox{
and intercept } b=\mu_y - m \mu_x
\]</span></p>
<p>In our example, we can calculate the slope and intercept using the
formula above and plot the line.</p>
<div class="sourceCode" id="cb190"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>wide_US_summary <span class="ot">&lt;-</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  wide_US <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mu_x =</span> <span class="fu">mean</span>(Emissions), <span class="at">sd_x =</span> <span class="fu">sd</span>(Emissions),</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mu_y =</span> <span class="fu">mean</span>(Temperature), <span class="at">sd_y =</span> <span class="fu">sd</span>(Temperature),</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">rho =</span> <span class="fu">cor</span>(Emissions, Temperature),</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">slope =</span> rho <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x,</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">intercept =</span> mu_y <span class="sc">-</span> rho <span class="sc">*</span> sd_y <span class="sc">/</span> sd_x <span class="sc">*</span> mu_x)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>wide_US <span class="sc">%&gt;%</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Emissions, <span class="at">y =</span> Temperature)) <span class="sc">+</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope =</span> wide_US_summary<span class="sc">$</span>slope,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">intercept =</span> wide_US_summary<span class="sc">$</span>intercept) <span class="sc">+</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-145-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Note</strong>: In the plot above, we use the scale of the
original variables (CO2 emission and temperature), but the formula above
implies that standardization of the variables (i.e. subtracting the mean
and dividing by the standard deviation) allows the regression line to
have an intercept of 0 and slope equal to <span
class="math inline">\(\rho\)</span>. A similar plot in standardized
units is given below.</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>CO2_temp_US_scaled<span class="ot">&lt;-</span>wide_US <span class="sc">%&gt;%</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">scale</span>(Emissions), <span class="at">y =</span> <span class="fu">scale</span>(Temperature))) <span class="sc">+</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;US&quot;</span> <span class="sc">~</span> CO[<span class="dv">2</span>]<span class="sc">~</span> <span class="st">&quot;Emissions and Temperature (1980-2014)&quot;</span>,</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Scaled Temperature (Fahrenheit)&quot;</span>,</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Scaled Emissions (Metric Tonnes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>CO2_temp_US_scaled</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-146-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Notice that we also use the <code>geom_smooth(method = "lm")</code>
function that we previously used. Again, this adds a line corresponding
to the slope and intercept from the <code>lm()</code> function from the
<code>stats</code> R package.</p>
<div id="section-60" class="section level4 think_question_block">
<h4 class="think_question_block"></h4>
<p><b><u> Question Opportunity </u></b></p>
<p>What does <code>se = FALSE</code> mean? Try turning it to TRUE. What
happens?</p>
</div>
<div id="section-61" class="section level4">
<h4></h4>
<hr />
<details>
<summary>
Click here for the answer.
</summary>
<code>se</code> stands for standard error. The gray shading shows the <a
href="https://stattrek.com/regression/slope-confidence-interval.aspx"
target="_blank">confidence interval</a> of the smooth line.
</details>
<hr />
</div>
</div>
<div id="limitations-of-correlation" class="section level3">
<h3><strong>Limitations of Correlation</strong></h3>
<hr />
<p>While correlation is useful in many settings to understand how two
variables move together, correlation is not always a useful summary. For
example, here are ways it might not be useful:</p>
<ul>
<li>A linear relationship might not be the best way to capture the
relationship.</li>
<li>If an individual were interested in understanding a <em>causal</em>
relationship between two variables, as <a
href="https://dfrieds.com/math/correlation-does-not-imply-causation.html"
target="_blank">correlation does not imply causation</a>. Another way of
stating this is that simply showing there is a linear trend over time
does not imply there is a causal relationship between these two
variables.</li>
</ul>
<p>As you can see from this plot, often data may show a similar pattern
over time by random chance. See this <a
href="https://www.tylervigen.com/spurious-correlations"
target="_blank">website</a> for more examples.</p>
<p><img src="img/causation.png" width="600px" style="display: block; margin: auto;" /></p>
<div id="source-13" class="section level5">
<h5><a href="http://tylervigen.com/spurious-correlations"
target="_blank">[source]</a></h5>
<p>In this example and in our case study, data was collected over time.
This type of data will often have what is called <a
href="https://en.wikipedia.org/wiki/Autocorrelation"
target="_blank">autocorrleation</a> or serial correlation. This means
that data points from one year to the next may be similar to one another
or have some sort of internal structure related to time (such as
seasonality). Let’s think about our CO2 emission and temperature data.
You may be able to see how one year of CO2 emissions might be fairly
similar to next year, because the number of sources (such as industrial
factories and cars) in the US will change slightly from year to year,
but they will be related to that of the previous years. Anytime we look
at correlation between two variables that each have autocorrelation,
this can result in a higher likelihood of correlation between these
variables.</p>
<p>Indeed if we look at correlation between two random variables with
autocorrelation we can see an inflation in the correlation rho values
between the two variables, as compared to that of variables that do not
have autocorrelation.</p>
<p><img src="index_files/figure-html/unnamed-chunk-148-1.png" width="90%" style="display: block; margin: auto;" /><img src="index_files/figure-html/unnamed-chunk-148-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This is something to keep in mind when you evaluate how two things
are related to one another over time. There are <a
href="https://online.stat.psu.edu/stat462/node/188/">methods</a> that
have been developed to account for this in <a
href="https://en.wikipedia.org/wiki/Time_series">time series</a>
analysis (analyzing data over time). This does not mean that two
variables (such as CO2 and temperature) may not be in fact correlated,
it just means that we need to account for the autocorrelation within
each variable, however this is beyond the scope of this case study.</p>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1><strong>Summary</strong></h1>
<hr />
<div id="summary-plot" class="section level2">
<h2><strong>Summary Plot</strong></h2>
<hr />
<p>The last thing we will do here is to create a plot that summarizes
our major findings. We will use the <code>plot_layout()</code> function
of the <code>patchwork</code> R package. The <code>patchwork</code>
allows you to create a plot layout based on mathematical-like formulas.
As you can see in this example we want the <code>CO2_world</code> and
<code>Top10t</code> plot on top and we want another row with the
<code>CO2_temp_US_facet</code> and the <code>CO2_temp_US</code> plot on
the bottom. The plot_layout() function of the <code>patchwork</code>
package then allows us to specify heights and widths for the plots.</p>
<p>We will also save the figure using the <code>grDevices</code>
<code>png()</code> function. We can specify the name of our plot file
and where we want it to be saved using the <code>here()</code> function
of the <code>here</code> package. In this case in the <code>img</code>
subdirectory of the directory containing our .Rproj file. We can also
specify the size of the plot and the resolution using the
<code>res</code> argument. The <code>grDevices</code>
<code>dev.off()</code> function is necessary to close the graphics
device.</p>
<p>This will include a few plots that we made previously in other
sections. We saved these in the “plots” directory and will load these
now for users who stopped and restarted or started at the data analysis
section.</p>
<div class="sourceCode" id="cb192"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_world.rda&quot;</span>))</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;Top10t.rda&quot;</span>))</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;plots&quot;</span>, <span class="st">&quot;CO2_temp_US_facet.rda&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb193"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;mainplot.png&quot;</span>), <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>(CO2_world <span class="sc">|</span> Top10t) <span class="sc">/</span> (CO2_temp_US_facet <span class="sc">|</span> CO2_temp_US_scaled) <span class="sc">+</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">heights =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>), <span class="fu">c</span>(<span class="st">&#39;cm&#39;</span>, <span class="st">&#39;cm&#39;</span>)))</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="img/mainplot.png" width="800 px" style="display: block; margin: auto;" /></p>
</div>
<div id="synopsis" class="section level2">
<h2><strong>Synopsis</strong></h2>
<hr />
<p>In this case study we evaluated CO2 emissions from as far back as
1751 for some countries to 2014. We discovered that global levels of CO2
emissions have dramatically increased over time. We also learned that
some countries have been responsible for particularly high levels.</p>
<p>We also took a look at how CO2 emissions might relate to other
factors, such as temperature, energy use, and natural disasters. We
learned that we can summarize the relationship between two sets of data
using <strong>correlation coefficients</strong>. We also learned that we
can use <strong>regression</strong> to predict or describe how changes
in one variable may influence changes in another variable. Importantly,
we also learned that just because two variables show strong correlation
or show an association, it does not necessarily indicate that they are
causally related.</p>
<p>However, there is quite a bit of scientific evidence to indicate that
in fact CO2 emissions trap heat and lead to increased global
temperatures. Yet, it is important to realize that there are other
factors involved in the relationship between US CO2 emissions and US
annual average temperatures. For example there are CO2 emissions from
other countries in the atmosphere, there are other greenhouse gases,
there is already existing CO2 in the atmosphere that will continue to
trap heat for many years, and finally there is heat trapped in the ocean
due to previous emissions that will cause delayed changes in surface
temperatures. However, it is vital that we work around the globe to
reduce future greenhouse gas emissions to mitigate the increased
temperatures that we will experience due to previous and existing CO2
emissions, so that the warming temperatures aren’t as extreme as they
could be. Furthermore, we need to prepare for increased rates of natural
disasters and how these may influence people around the world. Evidence
suggests that impoverished people are the <a
href="https://ourworldindata.org/natural-disasters" target="_blank">most
affected by disasters</a>. We need to be particularly mindful of this as
we prepare for the future.</p>
</div>
</div>
<div id="suggested-homework" class="section level1">
<h1><strong>Suggested Homework</strong></h1>
<hr />
<p>Ask students to create a plot with labels showing the countries with
the lowest CO2 emission levels.</p>
<p>Ask students to plot CO2 emissions and other variables (e.g. energy
use) on a scatter plot, calculate the Pearson’s correlation coefficient,
and discuss results.</p>
</div>
<div id="additional-information" class="section level1">
<h1><strong>Additional information</strong></h1>
<hr />
<div id="helpful-links" class="section level2">
<h2><strong>Helpful Links</strong></h2>
<hr />
<p><a href="https://www.tidyverse.org/"
target="_blank">Tidyverse</a><br />
<a href="https://rstudio.com/resources/cheatsheets/"
target="_blank">RStudio cheatsheets</a> <a
href="https://www.mathsisfun.com/data/correlation.html"
target="_blank">Introduction to correlation</a> <a
href="https://rafalab.github.io/dsbook/regression.html#corr-coefl"
target="_blank">Correlation coefficient</a><br />
<a
href="https://dfrieds.com/math/correlation-does-not-imply-causation.html"
target="_blank">Correlation does not imply causation</a><br />
<a href="https://rafalab.github.io/dsbook/regression.html"
target="_blank">Regression</a><br />
<a href="https://en.wikipedia.org/wiki/Local_regression"
target="_blank">Locally estimated scatterplot smoothing</a><br />
<a href="https://en.wikipedia.org/wiki/Local_regression"
target="_blank">Local polynomial regression</a><br />
<a href="https://en.wikipedia.org/wiki/Autocorrelation"
target="_blank">Autocorrleation</a><br />
<a href="https://en.wikipedia.org/wiki/Time_series" target="_blank">Time
series</a><br />
<a href="https://online.stat.psu.edu/stat462/node/188/"
target="_blank">Methods to account for autocorrelation</a><br />
<a
href="https://www.epa.gov/sites/production/files/2020-04/documents/us-ghg-inventory-2020-main-text.pdf"
target="_blank">US Environmental Protection Agency (EPA) Inventory of
U.S. Greenhouse Gas Emissions and Sinks 2020 Report</a><br />
<a href="https://data.globalchange.gov/report/nca3-overview"
target="_blank">National Climate Assessment Report</a><br />
<a href="https://www.epa.gov/report-environment/greenhouse-gases"
target="_blank">Greenhouse gases</a> <a
href="https://world101.cfr.org/global-era-issues/climate-change/climate-change-adaptations"
target="_blank">Climate change</a></p>
<p><u><strong>Packages used in this case study:</strong> </u></p>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use in this case study</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here"
target="_blank"><code>here</code></a></td>
<td>to easily load and save data</td>
</tr>
<tr class="even">
<td><a href="https://readxl.tidyverse.org/"
target="_blank"><code>readxl</code></a></td>
<td>to import the excel file data</td>
</tr>
<tr class="odd">
<td><a href="https://readr.tidyverse.org/"
target="_blank"><code>readr</code></a></td>
<td>to import the csv file data</td>
</tr>
<tr class="even">
<td><a href="https://dplyr.tidyverse.org/"
target="_blank"><code>dplyr</code></a></td>
<td>o view and wrangle the data, by modifying variables, renaming
variables, selecting variables, creating variables, and arranging values
within a variable</td>
</tr>
<tr class="odd">
<td><a
href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html"
target="_blank"><code>magrittr</code></a></td>
<td>to use and reassign data objects using the
<code>%&lt;&gt;%</code>pipe operator</td>
</tr>
<tr class="even">
<td><a href="https://stringr.tidyverse.org/"
target="_blank"><code>stringr</code></a></td>
<td>to select only the first 4 characters of date data</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/"
target="_blank"><code>purrr</code></a></td>
<td>to apply a function on a list of tibbles (tibbles are the tidyverse
version of a data frame)</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/"
target="_blank"><code>tidyr</code></a></td>
<td>to drop rows with <code>NA</code> values from a tibble</td>
</tr>
<tr class="odd">
<td><a href="https://forcats.tidyverse.org/"
target="_blank"><code>forcats</code></a></td>
<td>to reorder the levels of a factor</td>
</tr>
<tr class="even">
<td><a href="https://ggplot2.tidyverse.org/"
target="_blank"><code>ggplot2</code></a></td>
<td>to make visualizations</td>
</tr>
<tr class="odd">
<td><a href="http://directlabels.r-forge.r-project.org/docs/index.html"
target="_blank"><code>directlabels</code></a></td>
<td>to add labels to plots easily</td>
</tr>
<tr class="even">
<td><a
href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"
target="_blank"><code>ggrepel</code></a></td>
<td>to add labels that don’t overlap to plots</td>
</tr>
<tr class="odd">
<td><a
href="https://www.tidyverse.org/blog/2018/07/broom-0-5-0/"><code>broom</code></a></td>
<td>to make the output form statistical tests easier to work with</td>
</tr>
<tr class="even">
<td><a href="https://github.com/thomasp85/patchwork"
target="_blank"><code>patchwork</code></a></td>
<td>to combine plots</td>
</tr>
</tbody>
</table>
</div>
<div id="session-info" class="section level2">
<h2><strong>Session Info</strong></h2>
<hr />
<div class="sourceCode" id="cb194"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.2.2 (2022-10-31)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur ... 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] OCSdata_1.0.2             patchwork_1.1.1          
 [3] broom_1.0.2               ggrepel_0.9.2            
 [5] directlabels_2021.1.13    ggplot2_3.4.0            
 [7] forcats_0.5.2             tidyr_1.2.1              
 [9] purrr_1.0.1               stringr_1.5.0            
[11] dplyr_1.0.10              readr_2.1.3              
[13] readxl_1.4.1              koRpus.lang.en_0.1-4     
[15] koRpus_0.13-8             sylly_0.1-6              
[17] read.so_0.1.1             wordcountaddin_0.3.0.9000
[19] magrittr_2.0.3            knitr_1.41               
[21] here_1.0.1               

loaded via a namespace (and not attached):
 [1] httr_1.4.4        sass_0.4.4        splines_4.2.2     viridisLite_0.4.1
 [5] bit64_4.0.5       vroom_1.6.0       jsonlite_1.8.4    bslib_0.4.2      
 [9] assertthat_0.2.1  highr_0.10        cellranger_1.1.0  yaml_2.3.6       
[13] remotes_2.4.2     pillar_1.8.1      backports_1.4.1   lattice_0.20-45  
[17] glue_1.6.2        quadprog_1.5-8    digest_0.6.31     colorspace_2.0-3 
[21] htmltools_0.5.4   Matrix_1.5-1      pkgconfig_2.0.3   scales_1.2.1     
[25] tzdb_0.3.0        tibble_3.1.8      mgcv_1.8-41       generics_0.1.3   
[29] farver_2.1.1      usethis_2.1.6     ellipsis_0.3.2    cachem_1.0.6     
[33] withr_2.5.0       cli_3.6.0         crayon_1.5.2      evaluate_0.19    
[37] fs_1.5.2          fansi_1.0.3       nlme_3.1-160      tools_4.2.2      
[41] data.table_1.14.6 hms_1.1.2         lifecycle_1.0.3   munsell_0.5.0    
[45] compiler_4.2.2    jquerylib_0.1.4   rlang_1.0.6       grid_4.2.2       
[49] rstudioapi_0.14   labeling_0.4.2    rmarkdown_2.19    gtable_0.3.1     
[53] DBI_1.1.3         curl_4.3.3        R6_2.5.1          sylly.en_0.1-3   
[57] fastmap_1.1.0     bit_4.0.5         utf8_1.2.2        rprojroot_2.0.3  
[61] stringi_1.7.8     parallel_4.2.2    Rcpp_1.0.9        vctrs_0.5.1      
[65] tidyselect_1.2.0  xfun_0.36        </code></pre>
<p><strong>Estimate of RMarkdown Compilation Time: </strong></p>
<pre><code>About 34 - 44 seconds</code></pre>
<p>This compilation time was measured on a PC machine operating on
Windows 10. This range should only be used as an estimate as compilation
time will vary with different machines and operating systems.</p>
</div>
<div id="acknowledgments" class="section level2">
<h2><strong>Acknowledgments</strong></h2>
<hr />
<p>We would like to acknowledge <a
href="https://www.jhsph.edu/faculty/directory/profile/1708/megan-weil-latshaw">Megan
Latshaw</a> for assisting in framing the major direction of the case
study.</p>
<p>We would like to acknowledge <a
href="https://www.opencasestudies.org/authors/qmeng/">Qier Meng</a> and
<a href="https://mbreshock.github.io/">Michael Breshock</a> for their
contributions to this case study.</p>
<p>We would also like to acknowledge the <a
href="https://americanhealth.jhu.edu/">Bloomberg American Health
Initiative</a> for funding this work.</p>
<script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=080808&w=a&t=tt&d=rkeJy7szR2zgko6SzQvOjgSAKPG6aHwfgP338ysqAyE&co=ffffff&cmo=3acc3a&cmn=ff5353&ct=808080'></script>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXM6IEV4cGxvcmluZyBDTzIgZW1pc3Npb25zIGFjcm9zcyB0aW1lIgpjc3M6IHN0eWxlLmNzcwpvdXRwdXQ6CiAgaHRtbF9kb2N1bWVudDoKICAgIGluY2x1ZGVzOgogICAgICBpbl9oZWFkZXI6IEdBX1NjcmlwdC5SaHRtbAogICAgc2VsZl9jb250YWluZWQ6IHllcwogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBoaWdobGlnaHQ6IHRhbmdvCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogIHBkZl9kb2N1bWVudDoKICAgIHRvYzogeWVzCiAgd29yZF9kb2N1bWVudDoKICAgIHRvYzogeWVzCi0tLQoKPHN0eWxlPgojVE9DIHsKICBiYWNrZ3JvdW5kOiB1cmwoImh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9pbWcvaWNvbi1iYWhpLnBuZyIpOwogIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjsKICBwYWRkaW5nLXRvcDogMjQwcHggIWltcG9ydGFudDsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0Owp9Cjwvc3R5bGU+CgoKCjwhLS0gT3BlbiBhbGwgbGlua3MgaW4gbmV3IHRhYi0tPiAgCjxiYXNlIHRhcmdldD0iX2JsYW5rIi8+IAoKPGRpdiBpZD0iZ29vZ2xlX3RyYW5zbGF0ZV9lbGVtZW50Ij48L2Rpdj4KCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Jy8vdHJhbnNsYXRlLmdvb2dsZS5jb20vdHJhbnNsYXRlX2EvZWxlbWVudC5qcz9jYj1nb29nbGVUcmFuc2xhdGVFbGVtZW50SW5pdCc+PC9zY3JpcHQ+Cgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CmZ1bmN0aW9uIGdvb2dsZVRyYW5zbGF0ZUVsZW1lbnRJbml0KCkgewogIG5ldyBnb29nbGUudHJhbnNsYXRlLlRyYW5zbGF0ZUVsZW1lbnQoe3BhZ2VMYW5ndWFnZTogJ2VuJ30sICdnb29nbGVfdHJhbnNsYXRlX2VsZW1lbnQnKTsKfQo8L3NjcmlwdD4KCgoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldChpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFLCBjYWNoZSA9IEZBTFNFLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmFsaWduID0gImNlbnRlciIsIG91dC53aWR0aCA9ICc5MCUnKQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkoa25pdHIpCmxpYnJhcnkobWFncml0dHIpCnJlbW90ZXM6Omluc3RhbGxfZ2l0aHViKCJiZW5tYXJ3aWNrL3dvcmRjb3VudGFkZGluIiwgdHlwZSA9ICJzb3VyY2UiLCBkZXBlbmRlbmNpZXMgPSBUUlVFKQpyZW1vdGVzOjppbnN0YWxsX2dpdGh1YigiYWxpc3RhaXJlNDcvcmVhZC5zbyIpCmxpYnJhcnkod29yZGNvdW50YWRkaW4pCmxpYnJhcnkocmVhZC5zbykKCnJtYXJrZG93bjo6OnBlcmZfdGltZXJfcmVzZXRfYWxsKCkKcm1hcmtkb3duOjo6cGVyZl90aW1lcl9zdGFydCgicmVuZGVyIikKYGBgCgojIyMjIHsub3V0bGluZSB9CmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgiLCBkcGk9MzAwfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAibWFpbnBsb3QucG5nIikpCmBgYAoKIyMjIwoKIyMjIyB7LmRpc2NsYWltZXJfYmxvY2t9CgoqKkRpc2NsYWltZXIqKjogVGhlIHB1cnBvc2Ugb2YgdGhlIFtPcGVuIENhc2UgU3R1ZGllc10oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvKXt0YXJnZXQ9Il9ibGFuayJ9IHByb2plY3QgaXMgKip0byBkZW1vbnN0cmF0ZSB0aGUgdXNlIG9mIHZhcmlvdXMgZGF0YSBzY2llbmNlIG1ldGhvZHMsIHRvb2xzLCBhbmQgc29mdHdhcmUgaW4gdGhlIGNvbnRleHQgb2YgbWVzc3ksIHJlYWwtd29ybGQgZGF0YSoqLiBBIGdpdmVuIGNhc2Ugc3R1ZHkgZG9lcyBub3QgY292ZXIgYWxsIGFzcGVjdHMgb2YgdGhlIHJlc2VhcmNoIHByb2Nlc3MsIGlzIG5vdCBjbGFpbWluZyB0byBiZSB0aGUgbW9zdCBhcHByb3ByaWF0ZSB3YXkgdG8gYW5hbHl6ZSBhIGdpdmVuIGRhdGFzZXQsIGFuZCBzaG91bGQgbm90IGJlIHVzZWQgaW4gdGhlIGNvbnRleHQgb2YgbWFraW5nIHBvbGljeSBkZWNpc2lvbnMgd2l0aG91dCBleHRlcm5hbCBjb25zdWx0YXRpb24gZnJvbSBzY2llbnRpZmljIGV4cGVydHMuIAoKIyMjIwoKIyMjIyB7LmxpY2Vuc2VfYmxvY2t9CgpUaGlzIHdvcmsgaXMgbGljZW5zZWQgdW5kZXIgdGhlIENyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24tTm9uQ29tbWVyY2lhbCAzLjAgWyhDQyBCWS1OQyAzLjApXShodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktbmMvMy4wL3VzLyl7dGFyZ2V0PSJfYmxhbmsifSAgVW5pdGVkIFN0YXRlcyBMaWNlbnNlLgoKIyMjIwoKIyMjIyB7LnJlZmVyZW5jZV9ibG9ja30KClRvIGNpdGUgdGhpcyBjYXNlIHN0dWR5IHBsZWFzZSB1c2U6CgpXcmlnaHQsIENhcnJpZSBhbmQgT250aXZlcm9zLCBNaWNoYWVsIGFuZCBKYWdlciwgTGVhaCBhbmQgVGF1YiwgTWFyZ2FyZXQgYW5kIEhpY2tzLCBTdGVwaGFuaWUuICgyMDIwKS4gaHR0cHM6Ly9naXRodWIuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy4gRXhwbG9yaW5nIENPMiBlbWlzc2lvbnMgYWNyb3NzIHRpbWUgKFZlcnNpb24gdjEuMC4wKS4KCiMjIyMKClRvIGFjY2VzcyB0aGUgR2l0SHViIHJlcG9zaXRvcnkgZm9yIHRoaXMgY2FzZSBzdHVkeSBzZWUgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tLy9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMuCgpZb3UgbWF5IGFsc28gYWNjZXNzIGFuZCBkb3dubG9hZCB0aGUgZGF0YSB1c2luZyBvdXIgYE9DU2RhdGFgIHBhY2thZ2UuIFRvIGxlYXJuIG1vcmUgYWJvdXQgdGhpcyBwYWNrYWdlIGluY2x1ZGluZyBleGFtcGxlcywgc2VlIHRoaXMgW2xpbmtdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY2FzZXN0dWRpZXMvT0NTZGF0YSkuIEhlcmUgaXMgaG93IHlvdSB3b3VsZCBpbnN0YWxsIHRoaXMgcGFja2FnZToKCmBgYHtyLCBldmFsPUZBTFNFfQppbnN0YWxsLnBhY2thZ2VzKCJPQ1NkYXRhIikKYGBgCgpUaGlzIGNhc2Ugc3R1ZHkgaXMgcGFydCBvZiBhIHNlcmllcyBvZiBwdWJsaWMgaGVhbHRoIGNhc2Ugc3R1ZGllcyBmb3IgdGhlIFtCbG9vbWJlcmcgQW1lcmljYW4gSGVhbHRoIEluaXRpYXRpdmVdKGh0dHBzOi8vYW1lcmljYW5oZWFsdGguamh1LmVkdS9vcGVuLWNhc2Utc3R1ZGllcykuCgoqKioKClRoZSB0b3RhbCByZWFkaW5nIHRpbWUgZm9yIHRoaXMgY2FzZSBzdHVkeSBpcyBjYWxjdWxhdGVkIHZpYSBba29ScHVzXShodHRwczovL2dpdGh1Yi5jb20vdW5Eb2NVTWVhbnRJdC9rb1JwdXMpIGFuZCBzaG93biBiZWxvdzogCgpgYGB7ciwgZWNobz1GQUxTRX0KcmVhZHRhYmxlID0gdGV4dF9zdGF0cygiaW5kZXguUm1kIikgIyBwcm9kdWNpbmcgcmVhZGluZyB0aW1lIG1hcmtkb3duIHRhYmxlCnJlYWR0aW1lID0gcmVhZC5zbzo6cmVhZC5tZChyZWFkdGFibGUpICU+JSBkcGx5cjo6c2VsZWN0KE1ldGhvZCwga29ScHVzKSAlPiUgIyByZWFkaW5nIHRhYmxlIGludG8gZGF0YWZyYW1lLCBzZWxlY3RpbmcgcmVsZXZhbnQgZmFjdG9ycwogIGRwbHlyOjpmaWx0ZXIoTWV0aG9kID09ICJSZWFkaW5nIHRpbWUiKSAlPiUgIyBkcm9wcGluZyB1bm5lY2Vzc2FyeSByb3dzCiAgZHBseXI6Om11dGF0ZShrb1JwdXMgPSBwYXN0ZShyb3VuZChhcy5udW1lcmljKHN0cmluZ3I6OnN0cl9zcGxpdChrb1JwdXMsICIgIilbWzFdXVsxXSkpLCAibWludXRlcyIpKSAlPiUgIyByb3VuZGluZyByZWFkaW5nIHRpbWUgZXN0aW1hdGUKICBkcGx5cjo6bXV0YXRlKE1ldGhvZCA9ICJrb1JwdXMiKSAlPiUgZHBseXI6OnJlbG9jYXRlKGtvUnB1cywgLmJlZm9yZSA9IE1ldGhvZCkgJT4lIGRwbHlyOjpyZW5hbWUoYFJlYWRpbmcgVGltZWAgPSBrb1JwdXMpICMgcmVvcmdhbml6aW5nIHRhYmxlCmtuaXRyOjprYWJsZShyZWFkdGltZSwgZm9ybWF0PSJtYXJrZG93biIpCmBgYAoKKioqCgoqKlJlYWRhYmlsaXR5IFNjb3JlOiAqKgoKQSByZWFkYWJpbGl0eSBpbmRleCBlc3RpbWF0ZXMgdGhlIHJlYWRpbmcgZGlmZmljdWx0eSBsZXZlbCBvZiBhIHBhcnRpY3VsYXIgdGV4dC4gRmxlc2NoLUtpbmNhaWQsIEZPUkNBU1QsIGFuZCBTTU9HIGFyZSB0aHJlZSBjb21tb24gcmVhZGFiaWxpdHkgaW5kaWNlcyB0aGF0IHdlcmUgY2FsY3VsYXRlZCBmb3IgdGhpcyBjYXNlIHN0dWR5IHZpYSBba29ScHVzXShodHRwczovL2dpdGh1Yi5jb20vdW5Eb2NVTWVhbnRJdC9rb1JwdXMpLiBUaGVzZSBpbmRpY2VzIHByb3ZpZGUgYW4gZXN0aW1hdGlvbiBvZiB0aGUgbWluaW11bSByZWFkaW5nIGxldmVsIHJlcXVpcmVkIHRvIGNvbXByZWhlbmQgdGhpcyBjYXNlIHN0dWR5IGJ5IGdyYWRlIGFuZCBhZ2UuIAoKYGBge3IsIGVjaG89RkFMU0V9CnJ0ID0gd29yZGNvdW50YWRkaW46OnJlYWRhYmlsaXR5KCJpbmRleC5SbWQiLCBxdWlldD1UUlVFKSAjIHByb2R1Y2luZyByZWFkYWJpbGl0eSBtYXJrZG93biB0YWJsZQpkZiA9IHJlYWQuc286OnJlYWQubWQocnQpICU+JSBkcGx5cjo6c2VsZWN0KGluZGV4LCBncmFkZSwgYWdlKSAlPiUgICMgcmVhZGluZyB0YWJsZSBpbnRvIGRhdGFmcmFtZSwgc2VsZWN0aW5nIHJlbGV2YW50IGZhY3RvcnMKICB0aWR5cjo6ZHJvcF9uYSgpICU+JSBkcGx5cjo6bXV0YXRlKGdyYWRlID0gcm91bmQoYXMubnVtZXJpYyhncmFkZSkpLCAjIGRyb3BwaW5nIHJvd3Mgd2l0aCBtaXNzaW5nIHZhbHVlcywgcm91bmRpbmcgYWdlIGFuZCBncmFkZSBjb2x1bW5zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZ2UgPSByb3VuZChhcy5udW1lcmljKGFnZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCmtuaXRyOjprYWJsZShkZiwgZm9ybWF0PSJtYXJrZG93biIpCmBgYAoKKioqCgpQbGVhc2UgaGVscCB1cyBieSBmaWxsaW5nIG91dCBvdXIgc3VydmV5LgoKCjxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogY2VudGVyOyI+PGlmcmFtZSBzcmM9Imh0dHBzOi8vZG9jcy5nb29nbGUuY29tL2Zvcm1zL2QvZS8xRkFJcFFMU2ZwTjRGTjNLRUxxQk5FZ2YyQXRwaTdXeTdOcXkyYmVTa0ZRSU5MN1k1c0FNVjVfdy92aWV3Zm9ybT9lbWJlZGRlZD10cnVlIiB3aWR0aD0iMTIwMCIgaGVpZ2h0PSI3MDAiIGZyYW1lYm9yZGVyPSIwIiBtYXJnaW5oZWlnaHQ9IjAiIG1hcmdpbndpZHRoPSIwIj5Mb2FkaW5n4oCmPC9pZnJhbWU+PC9kaXY+CgoKIyAqKk1vdGl2YXRpb24qKgoqKiogCgpUaGlzIGNhc2Ugc3R1ZHkgZXhwbG9yZXMgaG93IGRpZmZlcmVudCBjb3VudHJpZXMgaGF2ZSBjb250cmlidXRlZCB0byBDYXJib24gRGlveGlkZSAoQ08yKSBlbWlzc2lvbnMgb3ZlciB0aW1lIGFuZCBob3cgQ08yIGVtaXNzaW9uIHJhdGVzIG1heSByZWxhdGUgdG8gaW5jcmVhc2luZyBnbG9iYWwgdGVtcGVyYXR1cmVzIGFuZCBpbmNyZWFzZWQgcmF0ZXMgb2YgbmF0dXJhbCBkaXNhc3RlcnMgYW5kIHN0b3Jtcy4KV2UgdXNlZCB0aGlzIFtyZXBvcnQgZnJvbSB0aGUgRVBBXShodHRwczovL3d3dy5lcGEuZ292L3JlcG9ydC1lbnZpcm9ubWVudC9ncmVlbmhvdXNlLWdhc2VzKXt0YXJnZXQ9Il9ibGFuayJ9IGFzIHRoZSBiYXNpcyBmb3IgbW90aXZhdGluZyB0aGlzIGNhc2Ugc3R1ZHksIGFzIGl0IHByb3ZpZGVzIGJhY2tncm91bmQgaW5mb3JtYXRpb24gYWJvdXQgaG93IENPMiBlbWlzc2lvbnMgYW5kIG90aGVyIGdyZWVuaG91c2UgZ2FzZXMgaGF2ZSBpbmZsdWVuY2VkIHRoZSBjbGltYXRlIGFuZCB3ZWF0aGVyIHBhdHRlcm5zLgoKQ08yIG1ha2VzIHVwIHRoZSBsYXJnZXN0IHByb3BvcnRpb24gb2YgZ3JlZW5ob3VzZSBnYXMgZW1pc3Npb25zIGluIHRoZSBVbml0ZWQgU3RhdGVzOgoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iNTAwcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiZW1pc3Npb25zLmpwZyIpKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuZXBhLmdvdi9naGdlbWlzc2lvbnMvaW52ZW50b3J5LXVzLWdyZWVuaG91c2UtZ2FzLWVtaXNzaW9ucy1hbmQtc2lua3Mpe3RhcmdldD0iX2JsYW5rIn0gCgpBIHZhcmlldHkgb2Ygc291cmNlcyBhbmQgc2VjdG9ycyBjb250cmlidXRlIHRvIGdyZWVuaG91c2UgZ2FzIGVtaXNzaW9uczoKCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjUwMHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInNlY3Rvci5wbmciKSkKYGBgCgojIyMjIyBbW3NvdXJjZV1dKGh0dHBzOi8vd3d3LmVwYS5nb3YvZ2hnZW1pc3Npb25zL2ludmVudG9yeS11cy1ncmVlbmhvdXNlLWdhcy1lbWlzc2lvbnMtYW5kLXNpbmtzKXt0YXJnZXQ9Il9ibGFuayJ9CgpUcmFuc3BvcnRhdGlvbiBhbmQgRWxlY3RyaWNpdHkgY29udHJpYnV0ZSB0aGUgbW9zdCBtZXRyaWMgdG9ucyBvZiBDTzI6CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjUwMHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInNvdXJjZXNfcGllLmpwZyIpKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuZXBhLmdvdi9naGdlbWlzc2lvbnMvaW52ZW50b3J5LXVzLWdyZWVuaG91c2UtZ2FzLWVtaXNzaW9ucy1hbmQtc2lua3Mpe3RhcmdldD0iX2JsYW5rIn0KCgpTbyB3aHkgc2hvdWxkIHdlIHBheSBhdHRlbnRpb24gdG8gZ3JlZW5ob3VzZSBnYXNlcz8KCkFjY29yZGluZyB0byB0aGUgW1VTIEVudmlyb25tZW50YWwgUHJvdGVjdGlvbiBBZ2VuY3kgKEVQQSkgSW52ZW50b3J5IG9mIFUuUy4gR3JlZW5ob3VzZSBHYXMgRW1pc3Npb25zIGFuZCBTaW5rcyAyMDIwIFJlcG9ydF0oaHR0cHM6Ly93d3cuZXBhLmdvdi9zaXRlcy9wcm9kdWN0aW9uL2ZpbGVzLzIwMjAtMDQvZG9jdW1lbnRzL3VzLWdoZy1pbnZlbnRvcnktMjAyMC1tYWluLXRleHQucGRmKXt0YXJnZXQ9Il9ibGFuayJ9OiAKCj4gR3JlZW5ob3VzZSBnYXNlcyBhYnNvcmIgaW5mcmFyZWQgcmFkaWF0aW9uLCB0aGVyZWJ5IHRyYXBwaW5nIGhlYXQgaW4gdGhlIGF0bW9zcGhlcmUgYW5kIG1ha2luZyB0aGUgcGxhbmV0IHdhcm1lci4gVGhlIG1vc3QgaW1wb3J0YW50IGdyZWVuaG91c2UgZ2FzZXMgZGlyZWN0bHkgZW1pdHRlZCBieSBodW1hbnMgaW5jbHVkZSBjYXJib24gZGlveGlkZSAoQ08yKSwgbWV0aGFuZSAoQ0g0KSwgbml0cm91cyBveGlkZSAoTjJPKSwgYW5kIHNldmVyYWwgZmx1b3JpbmUtY29udGFpbmluZyBoYWxvZ2VuYXRlZCBzdWJzdGFuY2VzLiBBbHRob3VnaCBDTzIsIENINCwgYW5kIE4yTyBvY2N1ciBuYXR1cmFsbHkgaW4gdGhlIGF0bW9zcGhlcmUsIGh1bWFuIGFjdGl2aXRpZXMgaGF2ZSBjaGFuZ2VkIHRoZWlyIGF0bW9zcGhlcmljIGNvbmNlbnRyYXRpb25zLiBGcm9tIHRoZSBwcmUtIGluZHVzdHJpYWwgZXJhIChpLmUuLCBlbmRpbmcgYWJvdXQgMTc1MCkgdG8gMjAxOCwgY29uY2VudHJhdGlvbnMgb2YgdGhlc2UgZ3JlZW5ob3VzZSBnYXNlcyBoYXZlIGluY3JlYXNlZCBnbG9iYWxseSBieSA0NiwgMTY1LCBhbmQgMjMgcGVyY2VudCwgcmVzcGVjdGl2ZWx5IChJUENDIDIwMTM7IE5PQUEvRVNSTCAyMDE5YSwgMjAxOWIsIDIwMTljKS4gCgpcKiBJUENDIHN0YW5kcyBmb3IgdGhlIEludGVyZ292ZXJubWVudGFsIFBhbmVsIG9uIENsaW1hdGUgQ2hhbmdlCgpJbiBmYWN0LCB0aGVyZSBhcmUgbWFueSBzaWducyB0aGF0IG91ciBwbGFuZXQgaXMgZXhwZXJpZW5jaW5nIHdhcm1lciB0ZW1wZXJhdHVyZXM6CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjUwMHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIndhcm1pbmcucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL2RhdGEuZ2xvYmFsY2hhbmdlLmdvdi9yZXBvcnQvbmNhMy1vdmVydmlldyl7dGFyZ2V0PSJfYmxhbmsifQoKVGhlIGNvbm5lY3Rpb24gYmV0d2VlbiBncmVlbmhvdXNlIGdhcyBsZXZlbHMgYW5kIGdsb2JhbCB0ZW1wZXJhdHVyZXMgYW5kIHRoZSBpbmZsdWVuY2Ugb2YgaW5jcmVhc2VkIGdsb2JhbCB0ZW1wZXJhdHVyZXMgb24gaHVtYW4gaGVhbHRoIGFyZSBtb3RpdmF0ZWQgYnkgdGhlc2UgcmVwb3J0czoKCiMjIyMgey5yZWZlcmVuY2VfYmxvY2t9CgotIE1lbGlsbG8sIEouTS4sIFQuQy4gUmljaG1vbmQsIGFuZCBHLlcuIFlvaGUgKGVkcy4pLiAyMDE0LiBDbGltYXRlIGNoYW5nZSBpbXBhY3RzIGluIHRoZSBVbml0ZWQgU3RhdGVzOiBUaGUgdGhpcmQgTmF0aW9uYWwgQ2xpbWF0ZSBBc3Nlc3NtZW50LiBVLlMuIEdsb2JhbCBDaGFuZ2UgUmVzZWFyY2ggUHJvZ3JhbS4gIAoKLSAyMDIwLiDigJxJbnZlbnRvcnkgb2YgVVMgR3JlZW5ob3VzZSBHYXMgRW1pc3Npb25zIGFuZCBTaW5rczogMTk5MC0tMjAxOC7igJ0gRVBBIDQzMC1SLTIwLTAwMiwgVGVjaC4gUmVwLiBodHRwczovL3d3dy5lcGEuZ292L2doZ2VtaXNzaW9ucy9pbnZlbnRvcnktdXMtZ3JlZW5ob3VzZS1nYXMtZW1pc3Npb25zLWFuZC1zaW5rcy4KCgojIyMjCgpUaGUgW05hdGlvbmFsIENsaW1hdGUgQXNzZXNzbWVudCBSZXBvcnRdKGh0dHBzOi8vZGF0YS5nbG9iYWxjaGFuZ2UuZ292L3JlcG9ydC9uY2EzLW92ZXJ2aWV3KXt0YXJnZXQ9Il9ibGFuayJ9IHN0YXRlcyB0aGF0OgoKPiBIZWF0LXRyYXBwaW5nIGdhc2VzIGFscmVhZHkgaW4gdGhlIGF0bW9zcGhlcmUgaGF2ZSBjb21taXR0ZWQgdXMgdG8gYSBob3R0ZXIgZnV0dXJlIHdpdGggbW9yZSBjbGltYXRlLXJlbGF0ZWQgaW1wYWN0cyBvdmVyIHRoZSBuZXh0IGZldyBkZWNhZGVzLiBUaGUgbWFnbml0dWRlIG9mIGNsaW1hdGUgY2hhbmdlIGJleW9uZCB0aGUgbmV4dCBmZXcgZGVjYWRlcyBkZXBlbmRzIHByaW1hcmlseSBvbiB0aGUgYW1vdW50IG9mIGhlYXQtdHJhcHBpbmcgZ2FzZXMgdGhhdCBodW1hbiBhY3Rpdml0aWVzIGVtaXQgZ2xvYmFsbHksIG5vdyBhbmQgaW4gdGhlIGZ1dHVyZS4KClNlZSB0aGUgZm9sbG93aW5nIGxpbmtzIGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGhvdyBncmVlbmhvdXNlIGdhc2VzIGhhdmUgaW5mbHVlbmNlZCBnbG9iYWwgdGVtcGVyYXR1cmVzOgoxKSBUaGUgRVBBIFtyZXBvcnRdKGh0dHBzOi8vd3d3LmVwYS5nb3YvcmVwb3J0LWVudmlyb25tZW50L2dyZWVuaG91c2UtZ2FzZXMpe3RhcmdldD0iX2JsYW5rIn0gb24gZ3JlZW4gaG91c2UgZ2FzZXMgIAoyKSBUaGUgTmF0aW9uYWwgQ2xpbWF0ZSBBc3Nlc3NtZW50IChOQ0EpIFtzdW1tYXJ5IGZyb20gMjAxNF0oaHR0cHM6Ly9uY2EyMDE0Lmdsb2JhbGNoYW5nZS5nb3YvKXt0YXJnZXQ9Il9ibGFuayJ9KSAKMykgVGhlIFtXb3JsZDEwMSB3ZWJzaXRlXShodHRwczovL3dvcmxkMTAxLmNmci5vcmcvZ2xvYmFsLWVyYS1pc3N1ZXMvY2xpbWF0ZS1jaGFuZ2UvY2xpbWF0ZS1jaGFuZ2UtYWRhcHRhdGlvbnMpe3RhcmdldD0iX2JsYW5rIn0gYWJvdXQgaG93IGNvdW50cmllcyBhcmUgYWRhcHRpbmcgdG8gY2xpbWF0ZSBjaGFuZ2UKCiMgKipNYWluIFF1ZXN0aW9ucyoqCioqKiAKCiMjIyMgey5tYWluX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gT3VyIG1haW4gcXVlc3Rpb25zOiA8L3U+PC9iPgoKMS4gSG93IGhhdmUgZ2xvYmFsIENPMiBlbWlzc2lvbiByYXRlcyBjaGFuZ2VkIG92ZXIgdGltZT8gSW4gcGFydGljdWxhciBmb3IgdGhlIFVTLCBhbmQgaG93IGRvZXMgdGhlIFVTIGNvbXBhcmUgdG8gb3RoZXIgY291bnRyaWVzPyAKMi4gQXJlIENPMiBlbWlzc2lvbnMgaW4gdGhlIFVTLCBnbG9iYWwgdGVtcGVyYXR1cmVzLCBhbmQgbmF0dXJhbCBkaXNhc3RlciByYXRlcyBpbiB0aGUgVVMgYXNzb2NpYXRlZD8gCgojIyMjCgojICoqTGVhcm5pbmcgT2JqZWN0aXZlcyoqIAoqKiogCgpJbiB0aGlzIGNhc2Ugc3R1ZHksIHdlIHdpbGwgZXhwbG9yZSBDTzIgZW1pc3Npb24gZGF0YSBmcm9tIGFyb3VuZCB0aGUgd29ybGQuIApXZSB3aWxsIGFsc28gZm9jdXMgb24gdGhlIFVTIHNwZWNpZmljYWxseSB0byBldmFsdWF0ZSBwYXR0ZXJucyBvZiB0ZW1wZXJhdHVyZXMgYW5kIG5hdHVyYWwgZGlzYXN0ZXIgYWN0aXZpdHkuIAoKVGhpcyBjYXNlIHN0dWR5IHdpbGwgcGFydGljdWxhcmx5IGZvY3VzIG9uIGhvdyB0byB1c2UgZGlmZmVyZW50IGRhdGFzZXRzIHRoYXQgc3BhbiBkaWZmZXJlbnQgcmFuZ2VzIG9mIHRpbWUsIGFzIHdlbGwgYXMgaG93IHRvIGNyZWF0ZSB2aXN1YWxpemF0aW9ucyBvZiBwYXR0ZXJucyBvdmVyIHRpbWUuIApXZSB3aWxsIGVzcGVjaWFsbHkgZm9jdXMgb24gdXNpbmcgcGFja2FnZXMgYW5kIGZ1bmN0aW9ucyBmcm9tIHRoZSBbYHRpZHl2ZXJzZWBdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9LCBzdWNoIGFzIGBkcGx5cmAsIGB0aWR5cmAsIGFuZCBgZ2dwbG90MmAuIAoKVGhlIHRpZHl2ZXJzZSBpcyBhIGxpYnJhcnkgb2YgcGFja2FnZXMgY3JlYXRlZCBieSBSU3R1ZGlvLiAKV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBSIHByb2dyYW1taW5nIHBhY2thZ2VzLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgbGVnaWJsZSBhbmQgaW50dWl0aXZlLgoKVGhlIHNraWxscywgbWV0aG9kcywgYW5kIGNvbmNlcHRzIHRoYXQgc3R1ZGVudHMgd2lsbCBiZSBmYW1pbGlhciB3aXRoIGJ5IHRoZSBlbmQgb2YgdGhpcyBjYXNlIHN0dWR5IGFyZToKCjx1PioqRGF0YSBTY2llbmNlIExlYXJuaW5nIE9iamVjdGl2ZXM6Kio8L3U+ICAKCjEuIEltcG9ydGluZyBkYXRhIGZyb20gdmFyaW91cyB0eXBlcyBvZiBFeGNlbCBmaWxlcyBhbmQgQ1NWIGZpbGVzCjIuIEFwcGx5IGFjdGlvbiB2ZXJicyBpbiBgZHBseXJgIGZvciBkYXRhIHdyYW5nbGluZwozLiBIb3cgdG8gcGl2b3QgYmV0d2VlbiAibG9uZyIgYW5kICJ3aWRlIiBkYXRhc2V0cwo0LiBKb2luaW5nIHRvZ2V0aGVyIG11bHRpcGxlIGRhdGFzZXRzIHVzaW5nIGBkcGx5cmAKNS4gSG93IHRvIGNyZWF0ZSBlZmZlY3RpdmUgbG9uZ2l0dWRpbmFsIGRhdGEgdmlzdWFsaXphdGlvbnMgd2l0aCBgZ2dwbG90MmAKNi4gSG93IHRvIGFkZCB0ZXh0LCBjb2xvciwgYW5kIGxhYmVscyB0byBgZ2dwbG90MmAgcGxvdHMKNy4gSG93IHRvIGNyZWF0ZSBmYWNldGVkIGBnZ3Bsb3QyYCBwbG90cwoKPHU+KipTdGF0aXN0aWNhbCBMZWFybmluZyBPYmplY3RpdmVzOioqPC91PiAgCgoxLiBJbnRyb2R1Y3Rpb24gdG8gY29ycmVsYXRpb24gY29lZmZpY2llbnQgYXMgYSBzdW1tYXJ5IHN0YXRpc3RpYwoyLiBSZWxhdGlvbnNoaXAgYmV0d2VlbiBjb3JyZWxhdGlvbiBhbmQgbGluZWFyIHJlZ3Jlc3Npb24KMy4gQ29ycmVsYXRpb24gaXMgbm90IGNhdXNhdGlvbgoKYGBge3IsIG91dC53aWR0aCA9ICIyMCUiLCBlY2hvID0gRkFMU0UsIGZpZy5hbGlnbiA9ICJjZW50ZXIifQppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3RpZHl2ZXJzZS50aWR5dmVyc2Uub3JnL2xvZ28ucG5nIikKYGBgCgoqKiogCgoKV2Ugd2lsbCBiZWdpbiBieSBsb2FkaW5nIHRoZSBwYWNrYWdlcyB0aGF0IHdlIHdpbGwgbmVlZDoKCmBgYHtyfQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkocmVhZHhsKQpsaWJyYXJ5KHJlYWRyKQpsaWJyYXJ5KGRwbHlyKQpsaWJyYXJ5KG1hZ3JpdHRyKQpsaWJyYXJ5KHN0cmluZ3IpCmxpYnJhcnkocHVycnIpCmxpYnJhcnkodGlkeXIpCmxpYnJhcnkoZm9yY2F0cykKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KGRpcmVjdGxhYmVscykKbGlicmFyeShnZ3JlcGVsKQpsaWJyYXJ5KGJyb29tKQpsaWJyYXJ5KHBhdGNod29yaykKbGlicmFyeShPQ1NkYXRhKQpgYGAKCjx1PioqUGFja2FnZXMgdXNlZCBpbiB0aGlzIGNhc2Ugc3R1ZHk6KiogPC91PgoKCiBQYWNrYWdlICAgfCBVc2UgaW4gdGhpcyBjYXNlIHN0dWR5ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tCltgaGVyZWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSl7dGFyZ2V0PSJfYmxhbmsifSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEKW2ByZWFkeGxgXShodHRwczovL3JlYWR4bC50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBpbXBvcnQgdGhlIEV4Y2VsIGZpbGUgZGF0YQpbYHJlYWRyYF0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBpbXBvcnQgdGhlIGNzdiBmaWxlIGRhdGEKW2BkcGx5cmBdKGh0dHBzOi8vZHBseXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gIHwgIHRvIHZpZXcgYW5kIHdyYW5nbGUgdGhlIGRhdGEsIGJ5IG1vZGlmeWluZyB2YXJpYWJsZXMsIHJlbmFtaW5nIHZhcmlhYmxlcywgc2VsZWN0aW5nIHZhcmlhYmxlcywgY3JlYXRpbmcgdmFyaWFibGVzLCBhbmQgYXJyYW5naW5nIHZhbHVlcyB3aXRoaW4gYSB2YXJpYWJsZSAgIApbYG1hZ3JpdHRyYF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL21hZ3JpdHRyL3ZpZ25ldHRlcy9tYWdyaXR0ci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICB8ICB0byB1c2UgYW5kIHJlYXNzaWduIGRhdGEgb2JqZWN0cyB1c2luZyB0aGUgYCU8PiVgcGlwZSBvcGVyYXRvcgpbYHN0cmluZ3JgXShodHRwczovL3N0cmluZ3IudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gIHwgdG8gc2VsZWN0IG9ubHkgdGhlIGZpcnN0IDQgY2hhcmFjdGVycyBvZiBkYXRlIGRhdGEKW2BwdXJycmBdKGh0dHBzOi8vcHVycnIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gIHwgdG8gYXBwbHkgYSBmdW5jdGlvbiBvbiBhIGxpc3Qgb2YgdGliYmxlcyAodGliYmxlcyBhcmUgdGhlIHRpZHl2ZXJzZSB2ZXJzaW9uIG9mIGEgZGF0YSBmcmFtZSkgIApbYHRpZHlyYF0oaHR0cHM6Ly90aWR5ci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBkcm9wIHJvd3Mgd2l0aCBgTkFgIHZhbHVlcyBmcm9tIGEgdGliYmxlCltgZm9yY2F0c2BdKGh0dHBzOi8vZm9yY2F0cy50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byByZW9yZGVyIHRoZSBsZXZlbHMgb2YgYSBmYWN0b3IKW2BnZ3Bsb3QyYF0oaHR0cHM6Ly9nZ3Bsb3QyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucwpbYGRpcmVjdGxhYmVsc2BdKGh0dHA6Ly9kaXJlY3RsYWJlbHMuci1mb3JnZS5yLXByb2plY3Qub3JnL2RvY3MvaW5kZXguaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSB8IHRvIGFkZCBsYWJlbHMgdG8gcGxvdHMgZWFzaWx5CltgZ2dyZXBlbGBdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9nZ3JlcGVsL3ZpZ25ldHRlcy9nZ3JlcGVsLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gfCB0byBhZGQgbGFiZWxzIHRoYXQgZG9uJ3Qgb3ZlcmxhcCB0byBwbG90cwpbYGJyb29tYF0oaHR0cHM6Ly93d3cudGlkeXZlcnNlLm9yZy9ibG9nLzIwMTgvMDcvYnJvb20tMC01LTAvKSB8IHRvIG1ha2UgdGhlIG91dHB1dCBmb3JtIHN0YXRpc3RpY2FsIHRlc3RzIGVhc2llciB0byB3b3JrIHdpdGgKW2BwYXRjaHdvcmtgXShodHRwczovL2dpdGh1Yi5jb20vdGhvbWFzcDg1L3BhdGNod29yayl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBjb21iaW5lIHBsb3RzCltgT0NTZGF0YWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY2FzZXN0dWRpZXMvT0NTZGF0YSl7dGFyZ2V0PSJfYmxhbmsifSB8IHRvIGFjY2VzcyBhbmQgZG93bmxvYWQgT0NTIGRhdGEgZmlsZXMKClRoZSBmaXJzdCB0aW1lIHdlIHVzZSBhIGZ1bmN0aW9uLCB3ZSB3aWxsIHVzZSB0aGUgYDo6YCB0byBpbmRpY2F0ZSB3aGljaCBwYWNrYWdlIHdlIGFyZSB1c2luZy4gVW5sZXNzIHdlIGhhdmUgb3ZlcmxhcHBpbmcgZnVuY3Rpb24gbmFtZXMsIHRoaXMgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IHdlIHdpbGwgaW5jbHVkZSBpdCBoZXJlIHRvIGJlIGluZm9ybWF0aXZlIGFib3V0IHdoZXJlIHRoZSBmdW5jdGlvbnMgd2Ugd2lsbCB1c2UgY29tZSBmcm9tLgoKCiMgKipDb250ZXh0KioKKioqIAoKTm93IHdlIHdpbGwgZGVzY3JpYmUgYSBiaXQgbW9yZSBiYWNrZ3JvdW5kIGFib3V0IGdyZWVuaG91c2UgZ2FzIGVtaXNzaW9ucyBhbmQgdGhlIHBvdGVudGlhbCBpbmZsdWVuY2Ugb2YgdGhlc2UgZW1pc3Npb25zIG9uIHB1YmxpYyBoZWFsdGguIAoKR3JlZW5ob3VzZSBnYXMgZW1pc3Npb25zIGFyZSBkdWUgdG8gYm90aCBuYXR1cmFsIHByb2Nlc3NlcyBhbmQgYW50aHJvcG9nZW5pYyAoaHVtYW4tZGVyaXZlZCkgYWN0aXZpdGllcy4gCgpUaGVzZSBlbWlzc2lvbnMgYXJlIG9uZSBvZiB0aGUgY29udHJpYnV0aW5nIGZhY3RvcnMgdG8gcmlzaW5nIGdsb2JhbCB0ZW1wZXJhdHVyZXMsIHdoaWNoIGNhbiBoYXZlIGEgZ3JlYXQgaW5mbHVlbmNlIG9uIFtwdWJsaWMgaGVhbHRoXShodHRwczovL3d3dy5lcGEuZ292L2NsaW1hdGUtaW5kaWNhdG9ycy91bmRlcnN0YW5kaW5nLWNvbm5lY3Rpb25zLWJldHdlZW4tY2xpbWF0ZS1jaGFuZ2UtYW5kLWh1bWFuLWhlYWx0aCl7dGFyZ2V0PSJfYmxhbmsifSAgYXMgaWxsdXN0cmF0ZWQgaW4gdGhlIGZvbGxvd2luZyBpbWFnZToKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iODAwcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiY2xpbWF0ZV9jaGFuZ2VfaGVhbHRoX2ltcGFjdHMuanBnIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5jZGMuZ292L2NsaW1hdGVhbmRoZWFsdGgvZWZmZWN0cy9kZWZhdWx0Lmh0bSl7dGFyZ2V0PSJfYmxhbmsifQoKCkFjY29yZGluZyB0byB0aGUgW1VTIEVudmlyb25tZW50YWwgUHJvdGVjdGlvbiBBZ2VuY3kgKEVQQSkgSW52ZW50b3J5IG9mIFUuUy4gR3JlZW5ob3VzZSBHYXMgRW1pc3Npb25zIGFuZCBTaW5rcyAyMDIwIFJlcG9ydF0oaHR0cHM6Ly93d3cuZXBhLmdvdi9zaXRlcy9wcm9kdWN0aW9uL2ZpbGVzLzIwMjAtMDQvZG9jdW1lbnRzL3VzLWdoZy1pbnZlbnRvcnktMjAyMC1tYWluLXRleHQucGRmKXt0YXJnZXQ9Il9ibGFuayJ9OgoKPiBHYXNlcyBpbiB0aGUgYXRtb3NwaGVyZSBjYW4gY29udHJpYnV0ZSB0byBjbGltYXRlIGNoYW5nZSBib3RoIGRpcmVjdGx5IGFuZCBpbmRpcmVjdGx5LiBEaXJlY3QgZWZmZWN0cyBvY2N1ciB3aGVuIHRoZSBnYXMgaXRzZWxmIGFic29yYnMgcmFkaWF0aW9uLiBJbmRpcmVjdCByYWRpYXRpdmUgZm9yY2luZyBvY2N1cnMgd2hlbiBjaGVtaWNhbCB0cmFuc2Zvcm1hdGlvbnMgb2YgdGhlIHN1YnN0YW5jZSBwcm9kdWNlIG90aGVyIGdyZWVuaG91c2UgZ2FzZXMsIHdoZW4gYSBnYXMgaW5mbHVlbmNlcyB0aGUgYXRtb3NwaGVyaWMgbGlmZXRpbWVzIG9mIG90aGVyIGdhc2VzLCBhbmQvb3Igd2hlbiBhIGdhcyBhZmZlY3RzIGF0bW9zcGhlcmljIHByb2Nlc3NlcyB0aGF0IGFsdGVyIHRoZSByYWRpYXRpdmUgYmFsYW5jZSBvZiB0aGUgZWFydGggKGUuZy4sIGFmZmVjdCBjbG91ZCBmb3JtYXRpb24gb3IgW2FsYmVkb10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQWxiZWRvKXt0YXJnZXQ9Il9ibGFuayJ9KS4gCgpUaGUgKipHbG9iYWwgV2FybWluZyBQb3RlbnRpYWwgKEdXUCkqKiBjb21wYXJlcyB0aGUgKiphYmlsaXR5IG9mIGEgZ3JlZW5ob3VzZSBnYXMgdG8gdHJhcCBoZWF0IGluIHRoZSBhdG1vc3BoZXJlIHJlbGF0aXZlIHRvIGFub3RoZXIgZ2FzKiouCgo+VGhlIEdXUCBvZiBhIGdyZWVuaG91c2UgZ2FzIGlzIGRlZmluZWQgYXMgdGhlIHJhdGlvIG9mIHRoZSBhY2N1bXVsYXRlZCByYWRpYXRpdmUgZm9yY2luZyB3aXRoaW4gYSBzcGVjaWZpYyB0aW1lIGhvcml6b24gY2F1c2VkIGJ5IGVtaXR0aW5nIDEga2lsb2dyYW0gb2YgdGhlIGdhcywgcmVsYXRpdmUgdG8gdGhhdCBvZiB0aGUgcmVmZXJlbmNlIGdhcyBDTzIgKElQQ0MgMjAxMykuIFRoZXJlZm9yZSBHV1Atd2VpZ2h0ZWQgZW1pc3Npb25zIGFyZSBwcm92aWRlZCBpbiBtaWxsaW9uIG1ldHJpYyB0b25zIG9mIENPMiBlcXVpdmFsZW50IChNTVQgQ08yIEVxLikKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cuZXBhLmdvdi9zaXRlcy9wcm9kdWN0aW9uL2ZpbGVzLzIwMjAtMDQvZG9jdW1lbnRzL3VzLWdoZy1pbnZlbnRvcnktMjAyMC1tYWluLXRleHQucGRmKXt0YXJnZXQ9Il9ibGFuayJ9CgpDTzIgaXMgYWN0dWFsbHkgdGhlIGxlYXN0IGhlYXQtdHJhcHBpbmcgZ2FzIG9mIHRoZSBncmVlbmhvdXNlIGdhc2VzOgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI4MDBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJHV1AucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5lcGEuZ292L3NpdGVzL3Byb2R1Y3Rpb24vZmlsZXMvMjAyMC0wNC9kb2N1bWVudHMvdXMtZ2hnLWludmVudG9yeS0yMDIwLW1haW4tdGV4dC5wZGYpe3RhcmdldD0iX2JsYW5rIn0KCkhvd2V2ZXIsIGJlY2F1c2UgQ08yIGlzIHNvIG11Y2ggbW9yZSBhYnVuZGFudCBhbmQgc3RheXMgaW4gdGhlIGF0bW9zcGhlcmUgc28gbXVjaCBsb25nZXIgdGhhbiBvdGhlciBncmVlbmhvdXNlIGdhc2VzLCBpdCBoYXMgYmVlbiB0aGUgbGFyZ2VzdCBjb250cmlidXRvciB0byBnbG9iYWwgd2FybWluZy4KU2VlIFtoZXJlXShodHRwczovL3d3dy51Y3N1c2Eub3JnL3Jlc291cmNlcy93aHktZG9lcy1jbzItZ2V0LW1vcmUtYXR0ZW50aW9uLW90aGVyLWdhc2VzIzp+OnRleHQ9Q08yJTIwc3RpY2tzJTIwYXJvdW5kLG94aWRlJTIwKE4yTykpe3RhcmdldD0iX2JsYW5rIn0gZm9yIG1vcmUgZGV0YWlscy4KCkl0IGlzIGFsc28gaW1wb3J0YW50IHRvIGtlZXAgaW4gbWluZCB0aGF0IHRoZXJlIGlzIGEgW2xhZ10oaHR0cHM6Ly9lYXJ0aG9ic2VydmF0b3J5Lm5hc2EuZ292L2Jsb2dzL2NsaW1hdGVxYS93b3VsZC1ndy1zdG9wLXdpdGgtZ3JlZW5ob3VzZS1nYXNlcy8pIGJldHdlZW4gZ3JlZW5ob3VzZSBnYXMgZW1pc3Npb25zIGFuZCB0ZW1wZXJhdHVyZSBjaGFuZ2VzIHRoYXQgd2UgZXhwZXJpZW5jZSBiZWNhdXNlIG11Y2ggb2YgRWFydGgncyB0aGVybWFsIGVuZXJneSAoYW5kIENPMikgZ2V0cyBzdG9yZWQgaW4gdGhlIG9jZWFuLiAKCkR1ZSB0byBhIHByb2Nlc3MgY2FsbGVkIFt0aGVybWFsIGluZXJ0aWFdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1ZvbHVtZXRyaWNfaGVhdF9jYXBhY2l0eSNUaGVybWFsX2luZXJ0aWEpLCB0aGUgaGVhdCBzdG9yZWQgaW4gdGhlIG9jZWFuIHdpbGwgZXZlbnR1YWxseSBiZSB0cmFuc2ZlcmVkIHRvIHRoZSBzdXJmYWNlIG9mIHRoZSBFYXJ0aCBsb25nIGFmdGVyIHRoZSBnYXNlcyB3ZXJlIGVtaXR0ZWQgdGhhdCByZXN1bHRlZCBpbiB0aGUgaW5jcmVhc2VkIG9jZWFuIHRlbXBlcmF0dXJlLgoKU2VlIFtoZXJlXShodHRwczovL2VhcnRob2JzZXJ2YXRvcnkubmFzYS5nb3YvYmxvZ3MvY2xpbWF0ZXFhL3dvdWxkLWd3LXN0b3Atd2l0aC1ncmVlbmhvdXNlLWdhc2VzLykgZm9yIG1vcmUgZXhwbGFuYXRpb24uCgpGdXJ0aGVybW9yZSwgcmlzaW5nIENPMiBsZXZlbHMgaW4gdGhlIG9jZWFuIGFsc28gaW5mbHVlbmNlIG9jZWFuIGFjaWRpdHk6CgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI1MDBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJvY2VhbnMucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL2RhdGEuZ2xvYmFsY2hhbmdlLmdvdi9yZXBvcnQvbmNhMy1vdmVydmlldyl7dGFyZ2V0PSJfYmxhbmsifQoKCkFzIENPMiBsZXZlbHMgcmlzZSBpbiB0aGUgb2NlYW4sIHRoZSBwSCBiZWNvbWVzIG1vcmUgYWNpZGljLCB3aGljaCBtYWtlcyBpdCBkaWZmaWN1bHQgZm9yIG9yZ2FuaXNtcyB0byBtYWludGFpbiB0aGVpciBzaGVsbHMgb3Igc2tlbGV0b25zIHRoYXQgYXJlIG1hZGUgb2YgY2FsY2l1bSBjYXJib25hdGUsIHRodXMgbWFraW5nIGl0IG1vcmUgZGlmZmljdWx0IGZvciB0aGVzZSBvcmdhbmlzbXMgdG8gc3Vydml2ZSBhbmQgaW1wYWN0aW5nIHRoZWlyIHJvbGUgaW4gdGhlIGVjb3N5c3RlbSBhbmQgZm9vZCBjaGFpbi4gCgoKRnVydGhlcm1vcmUsIGdyZWVuaG91c2UgZ2FzIGVtaXNzaW9ucyBhcmUgYmVsaWV2ZWQgdG8gaW5mbHVlbmNlIHdlYXRoZXIgcGF0dGVybnMgYXMgc2hvd24gaW4gdGhpcyBbcmVwb3J0XShodHRwczovL2RhdGEuZ2xvYmFsY2hhbmdlLmdvdi9yZXBvcnQvbmNhMy1vdmVydmlldyl7dGFyZ2V0PSJfYmxhbmsifS4gCgpJbmRlZWQsIGV2ZW50cyB3aXRoIGhpZ2ggbGV2ZWxzIG9mIHByZWNpcGl0YXRpb24gd2hpY2ggY2FuIGluZHVjZSBmbG9vZGluZyBhbmQgcHJvcGVydHkgZGFtYWdlIGFyZSBnZW5lcmFsbHkgaW5jcmVhc2luZyBhcm91bmQgdGhlIGNvdW50cnk6CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjUwMHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInN0b3Jtcy5wbmciKSkKYGBgCgojIyMjIyBbW3NvdXJjZV1dKGh0dHBzOi8vZGF0YS5nbG9iYWxjaGFuZ2UuZ292L3JlcG9ydC9uY2EzLW92ZXJ2aWV3KXt0YXJnZXQ9Il9ibGFuayJ9CgoKIyAqKkxpbWl0YXRpb25zKioKKioqIAoKQW4gaW1wb3J0YW50IGxpbWl0YXRpb24gcmVnYXJkaW5nIHRoaXMgZGF0YSBhbmFseXNpcyB0byBrZWVwIGluIG1pbmQgaXMgdGhlIGRhdGFzZXRzIG9ubHkgaW5jbHVkZSBjb3VudHJpZXMgYW5kIHllYXJzIGluIHdoaWNoIGNvdW50cmllcyB3ZXJlIHJlcG9ydGluZyBzdWNoIGluZm9ybWF0aW9uIHRvIHRoZSBhZ2VuY2llcyB0aGF0IGNvbGxlY3RlZCB0aGUgZGF0YS4gClRodXMsIHRoZSBkYXRhIGFyZSBpbmNvbXBsZXRlLiAKRm9yIGV4YW1wbGUsIHdoaWxlIHdlIGhhdmUgYSBmYWlybHkgZ29vZCBzZW5zZSBvZiBDTzIgZW1pc3Npb25zIGdsb2JhbGx5IGZvciBsYXRlciB5ZWFycywgYWRkaXRpb25hbCBlbWlzc2lvbnMgd2VyZSBhbHNvIHByb2R1Y2VkIGJ5IGNvdW50cmllcyB0aGF0IGFyZSBub3QgaW5jbHVkZWQgaW4gdGhlIGRhdGEuCgoKIyAqKldoYXQgYXJlIHRoZSBkYXRhPyoqCioqKiAKCkluIHRoaXMgY2FzZSBzdHVkeSB3ZSB3aWxsIGJlIHVzaW5nIGRhdGEgcmVsYXRlZCB0byBDTzIgZW1pc3Npb25zLCBhcyB3ZWxsIGFzIG90aGVyIGRhdGEgdGhhdCBtYXkgaW5mbHVlbmNlLCBiZSBpbmZsdWVuY2VkIG9yIHJlbGF0ZSB0byBDTzIgZW1pc3Npb25zLiAKTW9zdCBvZiBvdXIgZGF0YSBpcyBmcm9tIFtHYXBtaW5kZXJdKGh0dHBzOi8vd3d3LmdhcG1pbmRlci5vcmcvZGF0YS8pe3RhcmdldD0iX2JsYW5rIn0gdGhhdCB3YXMgb3JpZ2luYWxseSBvYnRhaW5lZCBmcm9tIHRoZSBbV29ybGQgQmFua10oaHR0cHM6Ly93d3cud29ybGRiYW5rLm9yZy9lbi93aGF0LXdlLWRvKXt0YXJnZXQ9Il9ibGFuayJ9LgoKSW4gYWRkaXRpb24sIHdlIHdpbGwgdXNlIHNvbWUgZGF0YSB0aGF0IGlzIHNwZWNpZmljIHRvIHRoZSBVbml0ZWQgU3RhdGVzIGZyb20gdGhlIFtOYXRpb25hbCBPY2VhbmljIGFuZCBBdG1vc3BoZXJpYyBBZG1pbmlzdHJhdGlvbiAoTk9BQSldKGh0dHBzOi8vd3d3Lm5vYWEuZ292Lyl7dGFyZ2V0PSJfYmxhbmsifSwgd2hpY2ggaXMgYW4gYWdlbmN5IHRoYXQgY29sbGVjdHMgd2VhdGhlciBhbmQgY2xpbWF0ZSBkYXRhLgoKCgpEYXRhICAgfCBUaW1lIHNwYW4gfCBTb3VyY2UgIHwgT3JpZ2luYWwgU291cmNlICAgfCBEZXNjcmlwdGlvbiB8IENpdGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tCioqQ08yIGVtaXNzaW9ucyoqICB8MTc1MS0yMDE0IHwgW0dhcG1pbmRlcl0oaHR0cHM6Ly93d3cuZ2FwbWluZGVyLm9yZy9kYXRhLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCBbQ2FyYm9uIERpb3hpZGUgSW5mb3JtYXRpb24gQW5hbHlzaXMgQ2VudGVyIChDRElBQyldKGh0dHBzOi8vY2RpYWMuZXNzLWRpdmUubGJsLmdvdi8pe3RhcmdldD0iX2JsYW5rIn0gIHwgIENPMiBlbWlzc2lvbnMgaW4gdG9ubmVzIG9yIG1ldHJpYyB0b25zIChlcXVpdmFsZW50IHRvIGFwcHJveGltYXRlbHkgMiwyMDQuNiBwb3VuZHMpIHBlciBwZXJzb24gYnkgY291bnRyeXwgTkEKKipHRFAgcGVyIGNhcGl0YSAocGVyY2VudCB5ZWFybHkgZ3Jvd3RoKSoqIHwgMTgwMS0yMDE5fCBbR2FwbWluZGVyXShodHRwczovL3d3dy5nYXBtaW5kZXIub3JnL2RhdGEvKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IFtXb3JsZCBCYW5rXShodHRwczovL2RhdGEud29ybGRiYW5rLm9yZy9pbmRpY2F0b3IvTlkuR0RQLlBDQVAuS0QuWkcpe3RhcmdldD0iX2JsYW5rIn0gIHwgIFtHcm93dGggRG9tZXN0aWMgUHJvZHVjdF0oaHR0cHM6Ly93d3cuaW52ZXN0b3BlZGlhLmNvbS90ZXJtcy9nL2dkcC5hc3AjOn46dGV4dD1Hcm9zcyUyMERvbWVzdGljJTIwUHJvZHVjdCUyMChHRFApJTIwaXMlMjB0aGUlMjBtb25ldGFyeSUyMHZhbHVlJTIwb2YlMjBhbGwsZXhwZW5kaXR1cmVzJTJDJTIwcHJvZHVjdGlvbiUyQyUyMG9yJTIwaW5jb21lcy4pe3RhcmdldD0iX2JsYW5rIn0gICh3aGljaCBpcyBhbiBvdmVyYWxsIG1lYXN1cmUgb2YgdGhlIGhlYWx0aCBvZiBuYXRpb24ncyBlY29ub215KSBwZXIgcGVyc29uIGJ5IGNvdW50cnl8IE5BCioqRW5lcmd5IHVzZSBwZXIgcGVyc29uKiogfDE5NjAtMjAxNSB8IFtHYXBtaW5kZXJdKGh0dHBzOi8vd3d3LmdhcG1pbmRlci5vcmcvZGF0YS8pe3RhcmdldD0iX2JsYW5rIn0gIHwgW1dvcmxkIEJhbmtdKGh0dHBzOi8vZGF0YS53b3JsZGJhbmsub3JnL2luZGljYXRvci9FRy5VU0UuUENBUC5LRy5PRSl7dGFyZ2V0PSJfYmxhbmsifSAgfCAgVXNlIG9mIHByaW1hcnkgZW5lcmd5IGJlZm9yZSB0cmFuc2Zvcm1hdGlvbiB0byBvdGhlciBlbmQtdXNlIGZ1ZWxzLCBieSBjb3VudHJ5IHwgTkEKKipVUyBOYXR1cmFsIERpc2FzdGVycyoqIHwgMTk4MC0yMDE5IHwgW1RoZSBOYXRpb25hbCBPY2VhbmljIGFuZCBBdG1vc3BoZXJpYyBBZG1pbmlzdHJhdGlvbiAoTk9BQSldKGh0dHBzOi8vd3d3Lm5jZGMubm9hYS5nb3YvYmlsbGlvbnMvdGltZS1zZXJpZXMpe3RhcmdldD0iX2JsYW5rIn18IFtUaGUgTmF0aW9uYWwgT2NlYW5pYyBhbmQgQXRtb3NwaGVyaWMgQWRtaW5pc3RyYXRpb24gKE5PQUEpIF0oaHR0cHM6Ly93d3cubmNkYy5ub2FhLmdvdi9iaWxsaW9ucy90aW1lLXNlcmllcyl7dGFyZ2V0PSJfYmxhbmsifXwgIFVTIGRhdGEgYWJvdXQ6IDxicj4gLS0gRHJvdWdodHMgPGJyPiAtLSBGbG9vZHMgPGJyPiAtLSBGcmVlemVzIDxicj4gLS0gU2V2ZXJlIFN0b3JtcyA8YnI+IC0tIFRyb3BpY2FsIEN5Y2xvbmVzIDxicj4gLS0gV2lsZGZpcmVzPGJyPiAtLSBXaW50ZXIgU3Rvcm1zIHwgTk9BQSBOYXRpb25hbCBDZW50ZXJzIGZvciBFbnZpcm9ubWVudGFsIEluZm9ybWF0aW9uIChOQ0VJKSBVLlMuIEJpbGxpb24tRG9sbGFyIFdlYXRoZXIgYW5kIENsaW1hdGUgRGlzYXN0ZXJzICgyMDIwKS4gaHR0cHM6Ly93d3cubmNkYy5ub2FhLmdvdi9iaWxsaW9ucy8sIERPSTogMTAuMjU5MjEvc3Rrdy03dzczCioqVGVtcGVyYXR1cmUqKiAgfCAxODk1LTIwMTl8ICBbVGhlIE5hdGlvbmFsIE9jZWFuaWMgYW5kIEF0bW9zcGhlcmljIEFkbWluaXN0cmF0aW9uIChOT0FBKV0oaHR0cHM6Ly93d3cubmNkYy5ub2FhLmdvdi9jYWcvbmF0aW9uYWwvdGltZS1zZXJpZXMpe3RhcmdldD0iX2JsYW5rIn0gIHwgW1RoZSBOYXRpb25hbCBPY2VhbmljIGFuZCBBdG1vc3BoZXJpYyBBZG1pbmlzdHJhdGlvbiAoTk9BQSldKGh0dHBzOi8vd3d3Lm5jZGMubm9hYS5nb3YvY2FnL25hdGlvbmFsL3RpbWUtc2VyaWVzKXt0YXJnZXQ9Il9ibGFuayJ9IHwgVVMgTmF0aW9uYWwgeWVhcmx5IGF2ZXJhZ2UgdGVtcGVyYXR1cmUgKGluIEZhaHJlbmhlaXQpIGZyb20gMTg5NSB0byAyMDE5IHwgTk9BQSBOYXRpb25hbCBDZW50ZXJzIGZvciBFbnZpcm9ubWVudGFsIGluZm9ybWF0aW9uLCBDbGltYXRlIGF0IGEgR2xhbmNlOiBOYXRpb25hbCBUaW1lIFNlcmllcywgcHVibGlzaGVkIEp1bmUgMjAyMCwgcmV0cmlldmVkIG9uIEp1bmUgMjYsIDIwMjAgZnJvbSBodHRwczovL3d3dy5uY2RjLm5vYWEuZ292L2NhZy8KCgpUbyBvYnRhaW4gdGhlIHRlbXBlcmF0dXJlIGRhdGEsIHRoZSBhbm51YWwgYXZlcmFnZSB0ZW1wZXJhdHVyZXMgd2VyZSBzZWxlY3RlZCBhcyBzaG93biBpbiB0aGlzIGltYWdlOgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGggPSAiODAwIHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInRlbXAucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwczovL3d3dy5uY2RjLm5vYWEuZ292L2NhZy9uYXRpb25hbC90aW1lLXNlcmllcyl7dGFyZ2V0PSJfYmxhbmsifQoKCkltcG9ydGFudGx5LCBub3RpY2UgdGhhdCB0aGUgZGF0YSB3ZSB3b3VsZCBsaWtlIHRvIHVzZSBzcGFuIGRpZmZlcmVudCB0aW1lIHBlcmlvZHM6CgpEYXRhICAgfCBUaW1lIHNwYW4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKLS0tLS0tLS0tLSB8LS0tLS0tLS0tLS0tLQoqKkNPMiBlbWlzc2lvbnMqKiAgfDE3NTEgdG8gMjAxNCAKKipHRFAgcGVyIGNhcGl0YSAoeWVhcmx5IGdyb3d0aCkqKiB8IDE4MDEgdG8gMjAxOQoqKkVuZXJneSB1c2UgcGVyIHBlcnNvbioqIHwxOTYwIHRvIDIwMTUgCioqVVMgTmF0dXJhbCBEaXNhc3RlcnMqKiB8IDE5ODAgdG8gMjAxOSAKKipUZW1wZXJhdHVyZSoqICB8IDE4OTUgdG8gMjAxOQoKV2Ugd2lsbCBleHBsb3JlIG1vcmUgYWJvdXQgdGhpcyBhIGJpdCBsYXRlci4gCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKV2hhdCBjb25jZXJucyBtaWdodCBhcmlzZSBhYm91dCByZWxpYWJpbGl0eSBhbmQgdmFyaWF0aW9uIG9mIG1lYXN1cmVtZW50IHByYWN0aWNlcyBvdmVyIHRpbWU/CgojIyMjCgojICoqRGF0YSBJbXBvcnQqKgoqKiogCkluIG91ciBjYXNlLCB3ZSBkb3dubG9hZGVkIHRoZSBkYXRhIGZvciB0aGUgZmlsZXMgZnJvbSB0aGUgdmFyaW91cyBzb3VyY2VzIGFzIGluZGljYXRlZCBpbiB0aGUgdGFibGUgYWJvdmUgYW5kIHB1dCB0aGVtIHdpdGhpbiBhICJyYXciIHN1YmRpcmVjdG9yeSBvZiBhICJkYXRhIiBkaXJlY3RvcnkgZm9yIG91ciBwcm9qZWN0LiBJZiB5b3UgdXNlIGFuIFJTdHVkaW8gcHJvamVjdCwgdGhlbiB5b3UgY2FuIHVzZSB0aGUgYGhlcmUoKWAgZnVuY3Rpb24gb2YgdGhlIGBoZXJlYCBwYWNrYWdlIHRvIG1ha2UgdGhlIHBhdGggZm9yIGltcG9ydGluZyB0aGlzIGRhdGEgc2ltcGxlci4gVGhlIGBoZXJlYCBwYWNrYWdlIGF1dG9tYXRpY2FsbHkgc3RhcnRzIGxvb2tpbmcgZm9yIGZpbGVzIGJhc2VkIG9uIHdoZXJlIHlvdSBoYXZlIGEgYC5ScHJvamAgZmlsZSB3aGljaCBpcyBjcmVhdGVkIHdoZW4geW91IHN0YXJ0IGEgbmV3IFJTdHVkaW8gcHJvamVjdC4gV2UgY2FuIHNwZWNpZnkgdGhhdCB3ZSB3YW50IHRvIGxvb2sgZm9yIHRoZSAieWVhcmx5X2NvMl9lbWlzc2lvbnNfMTAwMF90b25uZXMueGxzeCIgZmlsZSB3aXRoaW4gdGhlICJyYXciIGRpcmVjdG9yeSB3aXRoaW4gdGhlICJkYXRhIiBkaXJlY3Rvcnkgd2l0aGluIGEgZGlyZWN0b3J5IHdoZXJlIG91ciBgLlJwcm9qYCBmaWxlIGlzIGxvY2F0ZWQgYnkgc2VwYXJhdGluZyB0aGUgbmFtZXMgb2YgdGhlc2UgZGlyZWN0b3JpZXMgdXNpbmcgY29tbWFzIGFuZCBsaXN0aW5nICJkYXRhIiBmaXJzdC4gCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHNlZSBtb3JlIGFib3V0IGNyZWF0aW5nIG5ldyBwcm9qZWN0cyBpbiBSU3R1ZGlvLiA8L3N1bW1hcnk+CgpZb3UgY2FuIGNyZWF0ZSBhIHByb2plY3QgYnkgZ29pbmcgdG8gdGhlIEZpbGUgbWVudSBvZiBSU3R1ZGlvIGxpa2Ugc286CgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI2MCUifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiTmV3X3Byb2plY3QucG5nIikpCmBgYAoKWW91IGNhbiBhbHNvIGRvIHNvIGJ5IGNsaWNraW5nIHRoZSBwcm9qZWN0IGJ1dHRvbjoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iNjAlIn0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInByb2plY3RfYnV0dG9uLnBuZyIpKQpgYGAKClNlZSBbaGVyZV0oaHR0cHM6Ly9zdXBwb3J0LnJzdHVkaW8uY29tL2hjL2VuLXVzL2FydGljbGVzLzIwMDUyNjIwNy1Vc2luZy1Qcm9qZWN0cykgdG8gbGVhcm4gbW9yZSBhYm91dCB1c2luZyBSU3R1ZGlvIHByb2plY3RzIGFuZCBbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKSB0byBsZWFybiBtb3JlIGFib3V0IHRoZSBgaGVyZWAgcGFja2FnZS4KCjwvZGV0YWlscz4KCioqKgoKVG8gcmVhZCBpbiB0aGUgZmlsZXMgdGhhdCB3ZXJlIGRvd25sb2FkZWQgZnJvbSB0aGUgdmFyaW91cyBzb3VyY2VzIGFzIGluZGljYXRlZCBpbiB0aGUgdGFibGUgYWJvdmUsIHdlIHdpbGwgdXNlIHRoZSBgcmVhZF94bHN4KClgIGFuZCBgcmVhZF94bHMoKWAgZnVuY3Rpb25zIG9mIHRoZSBgcmVhZHhsYCBwYWNrYWdlIHRvIGltcG9ydCB0aGUgZGF0YSBmcm9tIHRoZSBgLnhsc3hgIGFuZCBgLnhsc2AgZmlsZXMsIHJlc3BlY3RpdmVseS4gV2Ugd2lsbCBhbHNvIHVzZSB0aGUgYGhlcmUoKWAgZnVuY3Rpb24gb2YgdGhlIGBoZXJlYCBwYWNrYWdlIHRvIG1vcmUgZWFzaWx5IHNwZWNpZnkgdGhlIHBhdGggdG8gb3VyIGZpbGVzIHJlbGF0aXZlIHRvIHRoZSBkaXJlY3Rvcnkgd2hlcmUgdGhlIC5ScHJvaiBmaWxlIGlzIGxvY2F0ZWQuIAoKYGBge3J9CkNPMl9lbWlzc2lvbnMgPC0gcmVhZHhsOjpyZWFkX3hsc3goaGVyZSgiZGF0YSIsInJhdyIsICJ5ZWFybHlfY28yX2VtaXNzaW9uc18xMDAwX3Rvbm5lcy54bHN4IikpCmdkcF9ncm93dGggICAgPC0gcmVhZHhsOjpyZWFkX3hsc3goaGVyZSgiZGF0YSIsICJyYXciLCAiZ2RwX3Blcl9jYXBpdGFfeWVhcmx5X2dyb3d0aC54bHN4IikpCmVuZXJneV91c2UgICAgPC0gcmVhZHhsOjpyZWFkX3hsc3goaGVyZSgiZGF0YSIsICJyYXciLCAiZW5lcmd5X3VzZV9wZXJfcGVyc29uLnhsc3giKSkKYGBgCgpJZiB5b3UgaGFkIHRyb3VibGUgZG93bmxvYWRpbmcgdGhlc2UgZmlsZXMsIHlvdSBjYW4gZG8gc28gYXQgb3VyIFtHaXRIdWIgcmVwb10oaHR0cHM6Ly9naXRodWIuY29tLy9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMvdHJlZS9tYXN0ZXIvZGF0YS9yYXcvKSBvciBtb3JlIGRpcmVjdGx5IGJ5IGNsaWNraW5nIFtoZXJlXShodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy1icC1jbzItZW1pc3Npb25zL21hc3Rlci9kYXRhL3Jhdy95ZWFybHlfY28yX2VtaXNzaW9uc18xMDAwX3Rvbm5lcy54bHN4KSwgW2hlcmVdKGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMvbWFzdGVyL2RhdGEvcmF3L2dkcF9wZXJfY2FwaXRhX3llYXJseV9ncm93dGgueGxzeCksIGFuZCBbaGVyZV0oaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy9tYXN0ZXIvZGF0YS9yYXcvZW5lcmd5X3VzZV9wZXJfcGVyc29uLnhsc3gpLgoKWW91IG1heSBhbHNvIGRvd25sb2FkIHRoZXNlIGZpbGVzIHVzaW5nIHRoZSBgT0NTZGF0YWAgcGFja2FnZToKCmBgYHtyLCBldmFsPUZBTFNFfQojIGluc3RhbGwucGFja2FnZXMoIk9DU2RhdGEiKQpsaWJyYXJ5KE9DU2RhdGEpCnJhd19kYXRhKCJvY3MtYnAtY28yLWVtaXNzaW9ucyIsIG91dHBhdGggPSBnZXR3ZCgpKQojIFRoaXMgd2lsbCBzYXZlIHRoZSByYXcgZGF0YSBmaWxlcyBpbiBhICJPQ1NkYXRhL2RhdGEvcmF3LyIgc3ViZm9sZGVyIAojIGluIHlvdXIgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeQpgYGAKCldlIHdpbGwgdXNlIHRoZSBgcmVhZF9jc3YoKWAgZnVuY3Rpb24gb2YgdGhlIGByZWFkcmAgcGFja2FnZSB0byBpbXBvcnQgdGhlIGRhdGEgZnJvbSB0aGUgYC5jc3ZgIGZpbGVzLgoKSG93ZXZlciwgZm9yIHRoZXNlIGZpbGVzIHRoZXJlIGFyZSBzb21lIGxpbmVzIHRoYXQgd2Ugd291bGQgbGlrZSB0byBub3QgaW1wb3J0IGJlY2F1c2UgdGhlIG51bWJlciBvZiBjb2x1bW5zIGRpZmZlciBmb3Igc29tZSByb3dzLiBJZiB3ZSBkb24ndCBhY2NvdW50IGZvciB0aGlzLCB0aGVuIHdlIG1heSBlbmQgdXAgaW1wb3J0aW5nIGZld2VyIGNvbHVtbnMgb2YgdGhlIGRhdGEgdGhhdCB3ZSB3b3VsZCBsaWtlLgoKSW4gdGhlIGZpcnN0IDUgcm93cyBzaG93biBiZWxvdyBpbiB0aGUgYGRhdGEvZGlzYXN0ZXJzLmNzdmAgZmlsZSwgeW91IGNhbiBzZWUgdGhhdCB0aGUgZmlyc3QgdHdvIHJvd3MgZG9lcyBub3QgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgY29sdW1ucyBhcyB0aGUgc3Vic2VxdWVudCByb3dzIGFuZCBhcmUganVzdCAoc3ViKXRpdGxlcy4gCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGggPSAiNjAwIHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIkRpc2FzdGVycy5wbmciKSkKYGBgCgpUbyBkbyB0aGlzLCB3ZSBjYW4gc2tpcCByb3dzIHVzaW5nIHRoZSBgc2tpcCA9IDJgIGFyZ3VtZW50IG9mIHRoZSBgcmVhZF9jc3YoKWAgZnVuY3Rpb24uIAoKYGBge3J9CnVzX2Rpc2FzdGVyIDwtIHJlYWRyOjpyZWFkX2NzdihoZXJlKCJkYXRhIiwgInJhdyIsICJkaXNhc3RlcnMuY3N2IiksIHNraXAgPSAyKQpgYGAKCklmIHlvdSBoYWQgdHJvdWJsZSBkb3dubG9hZGluZyB0aGlzIGZpbGUsIHlvdSBjYW4gZG8gc28gYXQgb3VyIFtHaXRIdWIgcmVwb10oaHR0cHM6Ly9naXRodWIuY29tLy9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMvdHJlZS9tYXN0ZXIvZGF0YS9yYXcpIG9yIG1vcmUgZGlyZWN0bHkgYnkgY2xpY2tpbmcgW2hlcmVdKGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMvbWFzdGVyL2RhdGEvcmF3L2Rpc2FzdGVycy5jc3YpLgoKTm93IGxvb2tpbmcgYXQgdGhlIGBkYXRhL3RlbXBlcmF0dXJlLmNzdmAgZmlsZSwgd2Ugc2VlIHRoYXQgdGhlIGZpcnN0IGZvdXIgbGluZXMgZG8gbm90IGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIGNvbHVtbnMgYXMgdGhlIHN1YnNlcXVlbnQgbGluZXMuIAoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjYwMCBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJ0ZW1wZGF0YS5wbmciKSkKYGBgCgpXZSB3aWxsIHNraXAgaW1wb3J0aW5nIGFsbCA0IGxpbmVzIGJ5IHVzaW5nIGBza2lwID0gNGAuIApXZSBjYW4gYWxzbyByZXBsYWNlIGFsbCBpbnN0YW5jZXMgb2YgYCItOTkiYCB3aXRoIGBOQWAgdXNpbmcgdGhlIGBuYSA9ICItOTkiYCBhcmd1bWVudCBvZiB0aGUgYHJlYWRfY3N2KClgIGZ1bmN0aW9uLgpUaGUgIi05OSIgbmVlZHMgdG8gYmUgaW4gcXVvdGF0aW9uIG1hcmtzIGJlY2F1c2UgdGhpcyBhcmd1bWVudCBleHBlY3RzIGNoYXJhY3RlcnMuCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIGZvciBhbiBleHBsYW5hdGlvbiBhYm91dCBkYXRhIHR5cGVzIGluIFIgYW5kIGFib3V0IGNoYXJhY3RlciBzdHJpbmdzLjwvc3VtbWFyeT4KClRoZXJlIGFyZSBzZXZlcmFsIFtjbGFzc2VzIG9mIGRhdGEgaW4gUiBwcm9ncmFtbWluZ10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUl8ocHJvZ3JhbW1pbmdfbGFuZ3VhZ2UpKSwgbWVhbmluZyB0aGF0IGNlcnRhaW4gb2JqZWN0cyB3aWxsIGJlIHRyZWF0ZWQgb3IgaW50ZXJwcmV0ZWQgZGlmZmVyZW50bHkuIENoYXJhY3RlciBpcyBvbmUgb2YgdGhlc2UgY2xhc3Nlcy4gQSBjaGFyYWN0ZXIgc3RyaW5nIGlzIGFuIGluZGl2aWR1YWwgZGF0YSB2YWx1ZSBtYWRlIHVwIG9mIGNoYXJhY3RlcnMuIFRoaXMgY2FuIGJlIGEgcGFyYWdyYXBoLCBsaWtlIHRoZSBsZWdlbmQgZm9yIHRoZSB0YWJsZSwgb3IgaXQgY2FuIGJlIGEgc2luZ2xlIGxldHRlciBvciBudW1iZXIgbGlrZSB0aGUgbGV0dGVyICJhIiBvciB0aGUgbnVtYmVyICIzIi4gSWYgZGF0YSBhcmUgb2YgY2xhc3MgY2hhcmFjdGVyLCB0aGFuIHRoZSBudW1lcmljIHZhbHVlcyB3aWxsIG5vdCBiZSBwcm9jZXNzZWQgbGlrZSBhIG51bWVyaWMgdmFsdWUgaW4gYSBtYXRoZW1hdGljYWwgc2Vuc2UuIElmIHlvdSB3YW50IHlvdXIgbnVtZXJpYyB2YWx1ZXMgdG8gYmUgaW50ZXJwcmV0ZWQgdGhhdCB3YXksIHRoZXkgbmVlZCB0byBiZSBjb252ZXJ0ZWQgdG8gYSBudW1lcmljIGNsYXNzLiBUaGUgb3B0aW9ucyB0eXBpY2FsbHkgdXNlZCBhcmUgaW50ZWdlciAod2hpY2ggaGFzIG5vIGRlY2ltYWwgcGxhY2UpIGFuZCBkb3VibGUgcHJlY2lzaW9uICh3aGljaCBoYXMgYSBkZWNpbWFsIHBsYWNlKS4KCkEgdmFyaWFibGUgdGhhdCBpcyBhIGZhY3RvciBoYXMgYSBzZXQgb2YgcGFydGljdWxhciB2YWx1ZXMgY2FsbGVkIGxldmVscyAodGhpcyBjYW4gYmUgbnVtYmVycyBvciBjaGFyYWN0ZXJzKS4gRXZlbiBpZiB0aGVzZSBhcmUgbnVtZXJpYywgdGhleSB3aWxsIGJlIGludGVycHJldGVkIGFzIGxldmVscyAoaS5lLiwgYXMgaWYgdGhleSB3ZXJlIGNoYXJhY3RlcnMpIG5vdCBhcyBtYXRoZW1hdGljYWwgbnVtYmVycy4gVGhlIHZhbHVlcyBvZiBhIGZhY3RvciBhcmUgYXNzdW1lZCB0byBoYXZlIGEgcGFydGljdWxhciBvcmRlcmluZzsgYnkgZGVmYXVsdCB0aGUgb3JkZXIgaXMgYWxwaGFiZXRpY2FsLCBidXQgdGhpcyBpcyBub3QgYWx3YXlzIHRoZSBjb3JyZWN0L2ludHVpdGl2ZSBvcmRlcmluZy4gWW91IGNhbiBtb2RpZnkgdGhlIG9yZGVyIG9mIHRoZXNlIGxldmVscyB3aXRoIHRoZSBgZm9yY2F0c2AgcGFja2FnZS4KCjwvZGV0YWlscz4gCioqKgoKYGBge3J9CnVzX3RlbXBlcmF0dXJlIDwtIHJlYWRyOjpyZWFkX2NzdihoZXJlKCJkYXRhIiwgInJhdyIsICJ0ZW1wZXJhdHVyZS5jc3YiKSwgc2tpcCA9IDQsIG5hID0gIi05OSIpCmBgYAoKSWYgeW91IGhhZCB0cm91YmxlIGRvd25sb2FkaW5nIHRoaXMgZmlsZSwgeW91IGNhbiBkbyBzbyBhdCBvdXIgW0dpdEh1YiByZXBvXShodHRwczovL2dpdGh1Yi5jb20vL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy90cmVlL21hc3Rlci9kYXRhL3Jhdykgb3IgbW9yZSBkaXJlY3RseSBieSBjbGlja2luZyBbaGVyZV0oaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy9tYXN0ZXIvZGF0YS9yYXcvdGVtcGVyYXR1cmUuY3N2KS4KCkdyZWF0ISBub3cgd2UgaGF2ZSBpbXBvcnRlZCBhbGwgb2YgdGhlIGRhdGEgdGhhdCB3ZSB3aWxsIG5lZWQuCgpUbyBhbGxvdyB1c2VycyB0byBza2lwIGltcG9ydCB3ZSB3aWxsIHNhdmUgdGhlIGRhdGEgYXMgYW4gUkRBIGZpbGU6CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpzYXZlKENPMl9lbWlzc2lvbnMsIAogICAgIGdkcF9ncm93dGgsCiAgICAgZW5lcmd5X3VzZSwgCiAgICAgdXNfZGlzYXN0ZXIsIAogICAgIHVzX3RlbXBlcmF0dXJlLCAKICAgICBmaWxlID0gaGVyZTo6aGVyZSgiZGF0YSIsICJpbXBvcnRlZCIsICJjbzJfZGF0YV9pbXBvcnRlZC5yZGEiKSkKYGBgCgojICoqRGF0YSBXcmFuZ2xpbmcqKgoqKiogCklmIHlvdSBoYXZlIGJlZW4gZm9sbG93aW5nIGFsb25nIGJ1dCBzdG9wcGVkLCB3ZSBjb3VsZCBsb2FkIG91ciBpbXBvcnRlZCBkYXRhIGxpa2Ugc286CgpgYGB7cn0KbG9hZChoZXJlOjpoZXJlKCJkYXRhIiwgImltcG9ydGVkIiwgImNvMl9kYXRhX2ltcG9ydGVkLnJkYSIpKQpgYGAKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IElmIHlvdSBza2lwcGVkIHRoZSBkYXRhIGltcG9ydCBzZWN0aW9uIGNsaWNrIGhlcmUuIDwvc3VtbWFyeT4KCkZpcnN0IHlvdSBuZWVkIHRvIGluc3RhbGwgYW5kIGxvYWQgdGhlIGBPQ1NkYXRhYCBwYWNrYWdlOgoKYGBge3IsIGV2YWw9RkFMU0V9Cmluc3RhbGwucGFja2FnZXMoIk9DU2RhdGEiKQpsaWJyYXJ5KE9DU2RhdGEpCmBgYAoKVGhlbiwgeW91IG1heSBsb2FkIHRoZSBpbXBvcnRlZCBkYXRhIHVzaW5nIHRoZSBmb2xsb3dpbmcgY29kZToKCmBgYHtyLCBldmFsPUZBTFNFfQppbXBvcnRlZF9kYXRhKCJvY3MtYnAtY28yLWVtaXNzaW9ucyIsIG91dHBhdGggPSBnZXR3ZCgpKQpsb2FkKGhlcmU6OmhlcmUoIk9DU2RhdGEiLCAiZGF0YSIsICJpbXBvcnRlZCIsICJjbzJfZGF0YV9pbXBvcnRlZC5yZGEiKSkKYGBgCgpJZiB0aGUgcGFja2FnZSBkb2VzIG5vdCB3b3JrIGZvciB5b3UsIGFsdGVybmF0aXZlbHksIGFuIFJEQSBmaWxlIChzdGFuZHMgZm9yIFIgZGF0YSkgb2YgdGhlIGRhdGEgY2FuIGJlIGZvdW5kIFtoZXJlXShodHRwczovL2dpdGh1Yi5jb20vL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy90cmVlL21hc3Rlci9kYXRhL2ltcG9ydGVkKSBvciBzbGlnaHRseSBtb3JlIGRpcmVjdGx5IFtoZXJlXShodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy1icC1jbzItZW1pc3Npb25zL21hc3Rlci9kYXRhL2ltcG9ydGVkL2NvMl9kYXRhX2ltcG9ydGVkLnJkYSkuIERvd25sb2FkIHRoaXMgZmlsZSBhbmQgdGhlbiBwbGFjZSBpdCBpbiB5b3VyIGN1cnJlbnQgd29ya2luZyBkaXJlY3Rvcnkgd2l0aGluIGEgc3ViZGlyZWN0b3J5IGNhbGxlZCAiaW1wb3J0ZWQiIHdpdGhpbiBhIGRpcmVjdG9yeSBjYWxsZWQgImRhdGEiIHRvIGNvcHkgYW5kIHBhc3RlIG91ciBjb2RlLiBXZSB1c2VkIGFuIFJTdHVkaW8gcHJvamVjdCBhbmQgdGhlIFtgaGVyZWAgcGFja2FnZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKSB0byBuYXZpZ2F0ZSB0byB0aGUgZmlsZSBtb3JlIGVhc2lseS4KCmBgYHtyfQpsb2FkKGhlcmU6OmhlcmUoImRhdGEiLCAiaW1wb3J0ZWQiLCAiY28yX2RhdGFfaW1wb3J0ZWQucmRhIikpCmBgYAoKKioqCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byBzZWUgbW9yZSBhYm91dCBjcmVhdGluZyBuZXcgcHJvamVjdHMgaW4gUlN0dWRpby4gPC9zdW1tYXJ5PgoKWW91IGNhbiBjcmVhdGUgYSBwcm9qZWN0IGJ5IGdvaW5nIHRvIHRoZSBGaWxlIG1lbnUgb2YgUlN0dWRpbyBsaWtlIHNvOgoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iNjAlIn0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIk5ld19wcm9qZWN0LnBuZyIpKQpgYGAKCllvdSBjYW4gYWxzbyBkbyBzbyBieSBjbGlja2luZyB0aGUgcHJvamVjdCBidXR0b246CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjYwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJwcm9qZWN0X2J1dHRvbi5wbmciKSkKYGBgCgpTZWUgW2hlcmVdKGh0dHBzOi8vc3VwcG9ydC5yc3R1ZGlvLmNvbS9oYy9lbi11cy9hcnRpY2xlcy8yMDA1MjYyMDctVXNpbmctUHJvamVjdHMpIHRvIGxlYXJuIG1vcmUgYWJvdXQgdXNpbmcgUlN0dWRpbyBwcm9qZWN0cyBhbmQgW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSkgdG8gbGVhcm4gbW9yZSBhYm91dCB0aGUgYGhlcmVgIHBhY2thZ2UuCgo8L2RldGFpbHM+CioqKgo8L2RldGFpbHM+CioqKgoKCk5leHQsIHdlIHRha2UgYSBsb29rIGF0IG91ciBkYXRhIHRoYXQgd2UganVzdCBpbXBvcnRlZC4gCldlIHdpbGwgbmVlZCB0byBkbyBzb21lIGRhdGEgd3JhbmdsaW5nIHRvIGFsbG93IHVzIHRvIGV2YWx1YXRlIGhvdyBDTzIgZW1pc3Npb25zIGhhdmUgY2hhbmdlZCBvdmVyIHRpbWUgYW5kIGhvdyBlbWlzc2lvbnMgbWF5IHJlbGF0ZSB0byBlbmVyZ3kgdXNlLCBHRFAsIGV0Yy4KTGV0J3MgZXhwbG9yZSBob3cgdG8gZG8gdGhhdCB3aXRoIHVzZWZ1bCBmdW5jdGlvbnMgYW5kIHBhY2thZ2VzIGZyb20gdGhlIGB0aWR5dmVyc2VgLiAKCiMjICoqWWVhcmx5IENPfjJ+IEVtaXNzaW9ucyoqCioqKgoKRmlyc3QsIGxldCdzIHRha2UgYSBsb29rIGF0IHRoZSBDTzIgZGF0YSAoYENPMl9lbWlzc2lvbnNgKS4gCldlIGNhbiB1c2UgdGhlIGBzbGljZV9oZWFkKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gc2VlIGp1c3QgdGhlIGZpcnN0IHJvd3Mgb2Ygb3VyIGRhdGEuIApXZSBjYW4gc3BlY2lmeSBob3cgbWFueSByb3dzIHdlIHdvdWxkIGxpa2UgdG8gc2VlIGJ5IHVzaW5nIHRoZSBgbiA9YCBhcmd1bWVudC4gCgpXZSB3aWxsIHVzZSB0aGUgYCU+JWAgcGlwZSBmcm9tIHRoZSBgbWFncml0dHJgIHBhY2thZ2UgKGFsdGhvdWdoIGl0IGlzIGFsc28gaW1wb3J0ZWQgYnkgb3RoZXIgYHRpZHl2ZXJzZWAgcGFja2FnZXMsIGxpa2UgYGRwbHlyYCksIHdoaWNoIGNhbiBiZSB1c2VkIHRvIGRlZmluZSB0aGUgaW5wdXQgZm9yIGxhdGVyIHNlcXVlbnRpYWwgc3RlcHMuIApUaGlzIHdpbGwgbWFrZSBtb3JlIHNlbnNlIHdoZW4gd2UgaGF2ZSBtdWx0aXBsZSBzZXF1ZW50aWFsIHN0ZXBzIHVzaW5nIHRoZSBzYW1lIGRhdGEgb2JqZWN0LiAKCmBgYHtyfQpDTzJfZW1pc3Npb25zICU+JQogIHNsaWNlX2hlYWQobiA9IDMpCmBgYAoKQW5vdGhlciB1c2VmdWwgZnVuY3Rpb24gaXMgYHNsaWNlX3NhbXBsZSgpYCB0byBsb29rIGF0IGEgKipzZWxlY3Rpb24gb2YgcmFuZG9tIHJvd3MqKiB1c2luZyBbcHNldWRvcmFuZG9tXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Qc2V1ZG9yYW5kb21uZXNzKXt0YXJnZXQ9Il9ibGFuayJ9IG51bWJlcnMgZm9yIHRoZSBpbmRleCBvZiByb3dzIHRvIHNob3cuIFRvIGNvbnRpbnVlIHRvIGdldCB0aGUgc2FtZSByYW5kb20gdmFsdWVzIG9yIGZvciBvdGhlcnMgdG8gZ2V0IHRoZSBzYW1lIHZhbHVlcywgd2UgbmVlZCB0byBzZXQgYSBzZWVkIGZpcnN0LiBXZSBjYW4gZG8gdGhpcyB3aXRoIHRoZSBgc2V0LnNlZWQoKWAgYmFzZSBmdW5jdGlvbi4gV2UganVzdCBzcGVjaWZ5IGEgbnVtYmVyIHdpdGggdGhpcyBmdW5jdGlvbiBhbmQgdGhhdCB3aWxsIGFsbG93IHVzIHRvIGdldCB0aGUgc2FtZSBzdWJzZXQgb2YgdmFsdWVzIGZyb20gdGhlIGBzbGljZV9zYW1wbGUoKWAgZnVuY3Rpb24uIElmIHR3byBkaWZmZXJlbnQgcGVvcGxlIHJhbiB0aGlzIGNvZGUgKHdpdGhvdXQgc2V0LnNlZWQoKSksIHRoZXkgd291bGQgZWFjaCBzZWUgYSBkaWZmZXJlbnQgc3Vic2V0IG9mIHJvd3MuIEZvciBkYXRhIGV4cGxvcmF0aW9uLCB0aGlzIGlzbid0IGEgaHVnZSBkZWFsLCBidXQgaWYgd2UnZCBsaWtlIHNlcGFyYXRlIGFuYWx5c3RzIHJ1bm5pbmcgdGhlIHNhbWUgY29kZSB0byBzZWUgdGhlIHNhbWUgb3V0cHV0LCB3ZSB3aWxsIHVzZSBzZXQuc2VlZCgpLiBJZiB3ZSBjaGFuZ2VkIHNldC5zZWVkKDEyMykgdG8gc2V0LnNlZWQoMzMzKSwgd2Ugd291bGQgb2J0YWluIGEgZGlmZmVyZW50IHJhbmRvbSBzYW1wbGUgb2Ygcm93cy4gCgpgYGB7cn0Kc2V0LnNlZWQoMTIzKQoKQ08yX2VtaXNzaW9ucyAlPiUKICBzbGljZV9zYW1wbGUobiA9IDMpCmBgYAoKIyMjIyB7LnRoaW5rX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRyeSBzZXR0aW5nIGEgZGlmZmVyZW50IHNlZWQgdG8gc2VlIHRoZSBkaWZmZXJlbmNlIGluIHRoZSBvdXRwdXQuCgojIyMjCgpPSywgd2Ugc2VlIGVhY2ggY291bnRyeSBpcyByZXByZXNlbnRlZCBhbG9uZyBvbmUgcm93IGFuZCBlYWNoIGNvbHVtbiBjb250YWlucyB5ZWFybHkgQ08yIGVtaXNzaW9ucy4gCldlIGFsc28gc2VlIHRoYXQgdGhlcmUgYXJlIGEgbG90IG9mIGBOQWAgdmFsdWVzLgoKV2UgY2FuIGFsc28gdXNlIHRoZSBgZ2xpbXBzZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIHZpZXcgb3VyIGRhdGEuIApUaGlzIGFsbG93cyB1cyB0byBzZWUgYWxsIG9mIG91ciB2YXJpYWJsZXMgYXQgb25jZS4gCldlIHdpbGwgc2VlIGEgdGlueSBiaXQgb2YgZWFjaCB2YXJpYWJsZS9jb2x1bW4gd2l0aCB0aGUgZGF0YSBkaXNwbGF5ZWQgb24gdGhlIHJpZ2h0LgoKIyMjIyB7LnNjcm9sbGFibGUgfQpgYGB7cn0KIyBTY3JvbGwgdGhyb3VnaCB0aGUgb3V0cHV0IQpDTzJfZW1pc3Npb25zICU+JQogIGRwbHlyOjpnbGltcHNlKCkKYGBgCiMjIyMKCgpXZSBjYW4gYWxzbyBzZWUgdGhhdCB3ZSBoYXZlIGEgbGFyZ2UgW3RpYmJsZV0oaHR0cHM6Ly90aWJibGUudGlkeXZlcnNlLm9yZy8pLiAKYGBge3J9CkNPMl9lbWlzc2lvbnMgJT4lCiAgY2xhc3MoKQpgYGAKClRoaXMgaXMgdGhlIG9iamVjdCB0aGF0IGlzIGNyZWF0ZWQgd2hlbiB3ZSByZWFkIGluIHRoZSBkYXRhIHdpdGggYHJlYWRyYC4gCkEgdGliYmxlIChvciBgdGJsX2RmYCkgaXMgdGhlIGB0aWR5dmVyc2VgIHZlcnNpb24gb2YgYSBgZGF0YS5mcmFtZWAgb2JqZWN0LiAKU2ltaWxhciB0byBgZGF0YS5mcmFtZWAsIGl0IGlzIGEgdGFibGUgd2l0aCB2YXJpYWJsZSBpbmZvcm1hdGlvbiBhcnJhbmdlZCBhcyBjb2x1bW5zLCBhbmQgaW5kaXZpZHVhbCBvYnNlcnZhdGlvbnMgYXJyYW5nZWQgYXMgcm93cy4gCkhvd2V2ZXIgc29tZSBuaWNlIGRpZmZlcmVuY2VzIGFyZSB0aGV5IGRvIG5vdCBjaGFuZ2UgdmFyaWFibGUgbmFtZXMgb3IgZGF0YSB0eXBlcyBhbmQgdGhleSBnaXZlIG1vcmUgbWVzc2FnZXMgd2hlbiBzb21ldGhpbmcgaXMgd3JvbmcgKGUuZy4gd2hlbiBhIHZhcmlhYmxlIGRvZXMgbm90IGV4aXN0KSwgd2hpY2ggZm9yY2VzIHRoZSBhbmFseXN0IHRvIGNvbmZyb250IHByb2JsZW1zIGVhcmxpZXIuIApUaWJibGVzIGFsc28gZ2l2ZSB1cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgY2xhc3Mgb2YgZWFjaCB2YXJpYWJsZS4gCgpGb3IgZXhhbXBsZSB0aGUgYGNvdW50cnlgIHZhcmlhYmxlIGlzIG1hZGUgdXAgb2YgY2hhcmFjdGVyIChhYmJyZXZpYXRlZCBhcyBgY2hyYCkgdmFsdWVzLgpgYGB7cn0KQ08yX2VtaXNzaW9ucyAlPiUKICBzZWxlY3QoY291bnRyeSkKYGBgCgpXZSBzZWUgdGhhdCB3ZSBoYXZlIGByIG5yb3coQ08yX2VtaXNzaW9ucylgIHJvd3MgZGlmZmVyZW50IGNvdW50cnkgdmFyaWFibGVzIGFuZCBDTzIgZW1pc3Npb24gdmFsdWVzIGZvciBgciBuY29sKENPMl9lbWlzc2lvbnMpIC0gMWAgZGlmZmVyZW50IHllYXJzIChmcm9tIDE3NTEgdG8gMjAxNCkuIApgYGB7cn0KbmFtZXMoQ08yX2VtaXNzaW9ucykKYGBgCgpSZWNhbGwsIHRoZSB2YWx1ZXMgYXJlIGVtaXNzaW9ucyBpbiBtZXRyaWMgdG9ucywgYWxzbyBjYWxsZWQgdG9ubmVzLgpTY3JvbGxpbmcgdGhyb3VnaCB0aGUgYGdsaW1wc2UoKWAgZnVuY3Rpb24gYWJvdmUsIHdlIGNhbiBhbHNvIHNlZSB0aGF0IHRoZXJlIGFyZSBmZXdlciBgTkFgIHZhbHVlcyBmb3IgbGF0ZXIgeWVhcnMuCgpJbiB0aGlzIG5leHQgY29kZSBjaHVuaywgd2Ugd2lsbCBpbnRyb2R1Y2UgdGhlIGAlPD4lYCBvcGVyYXRvciBmcm9tIHRoZSBgbWFncml0dHJgIHBhY2thZ2UuIApUaGlzIGFsbG93cyB1cyB0byB1c2Ugb3VyIGBDTzJfZW1pc3Npb25zYCBkYXRhIGFuZCByZWFzc2lnbiBpdCB0byBhIG1vZGlmaWVkIHZlcnNpb24gYXQgdGhlIHNhbWUgdGltZS4gCkxldCdzIG1vZGlmeSBgQ08yX2VtaXNzaW9uc2AgdG8gbWFrZSBpdCBtb3JlIHVzYWJsZSBmb3IgbWFraW5nIHZpc3VhbGl6YXRpb25zLiAKU3BlY2lmaWNhbGx5LCB3ZSB3aWxsIHVzZSB0aGUgYHBpdm90X2xvbmdlcigpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIGNvbnZlcnQgb3VyIGRhdGEgaW50byB3aGF0IGlzIGNhbGxlZCAqKiJsb25nIioqIGZvcm1hdC4gVGhpcyBpcyBhbHNvIHNvbWV0aW1lcyByZWZlcnJlZCB0byBhcyAqKiJuYXJyb3ciKiogZm9ybWF0LgoKVGhpcyBtZWFucyB0aGF0IHdlIHdpbGwgaGF2ZSBtb3JlIHJvd3MgYW5kIGZld2VyIGNvbHVtbnMgdGhhbiBvdXIgY3VycmVudCBmb3JtYXQuCgpSaWdodCBub3cgb3VyIGRhdGEgaXMgaW4gd2hhdCBpcyBjYWxsZWQgKioid2lkZSIqKiBmb3JtYXQuIApJbiB3aWRlIGZvcm1hdCwgZWFjaCB2YXJpYWJsZSBpcyBsaXN0ZWQgYXMgaXRzIG93biBjb2x1bW4uIApJbiBjb250cmFzdCwgaW4gbG9uZyBmb3JtYXQsIHZhcmlhYmxlcyBtYXliZSBjb2xsYXBzZWQgaW50byBhIGNvbHVtbiB0aGF0IGlkZW50aWZpZXMgdGhlIHZhcmlhYmxlcyBhbmQgYSBjb2x1bW4gb2YgdmFsdWVzLiAKU2VlIFtoZXJlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9XaWRlX2FuZF9uYXJyb3dfZGF0YSl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSB0d28gZm9ybWF0cy4KCldlIHdhbnQgdG8gY29sbGFwc2UgYWxsIG9mIHRoZSB2YWx1ZXMgZm9yIHRoZSBlbWlzc2lvbiBkYXRhIGFjcm9zcyB0aGUgZGlmZmVyZW50IGluZGl2aWR1YWwgeWVhciB2YXJpYWJsZXMgaW50byBvbmUgbmV3IGBFbWlzc2lvbnNgIHZhcmlhYmxlLiBXZSB3aWxsIGlkZW50aWZ5IHdoYXQgeWVhciB0aGV5IGFyZSBmcm9tIGJ5IGNyZWF0aW5nIGEgbmV3IGBZZWFyYCB2YXJpYWJsZS4gVGhlIGBjb2xzID1gIGFyZ3VtZW50IGFsbG93cyB1cyB0byBzcGVjaWZ5IHdoaWNoIGNvbHVtbnMgd2Ugd2FudCB0byBwaXZvdCAob3Igbm90IHBpdm90KSB0byBjcmVhdGUgdGhlc2UgbmV3IGNvbHVtbnMuIFdlIHdhbnQgdG8ga2VlcCBvdXIgYGNvdW50cnlgIGRhdGEgYXMgYW4gSUQgdmFyaWFibGUgc28gd2Ugd2lsbCBleGNsdWRlIGl0IHVzaW5nIHRoZSBgLWAgc2lnbiwgYnkgZGVmYXVsdCBhbGwgb3RoZXIgY29sdW1ucyB3aWxsIGJlIHVzZWQuCgpgYGB7cn0KCkNPMl9lbWlzc2lvbnMgICU8PiUKICBwaXZvdF9sb25nZXIoY29scyA9IC1jb3VudHJ5LAogICAgICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwKICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIkVtaXNzaW9ucyIpCgpzZXQuc2VlZCgxMjMpCgpDTzJfZW1pc3Npb25zICU+JQogIHNsaWNlX3NhbXBsZShuID0gNikKYGBgCgoKIyMjIyB7LnJlY2FsbF9jb2RlX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRoaW5rIGEgbW9tZW50IGFib3V0IHdoYXQgdGhlIGRpbWVuc2lvbnMgb2YgdGhlICBgQ08yX2VtaXNzaW9uc2AgdGliYmxlIGFyZSBub3cgYW5kIHdoeT8gSG93IHdvdWxkIHlvdSBjaGVjayB0aGlzPwoKPGI+PHU+IEhpbnQgPC91PjwvYj46IENoZWNraW5nIGhhcyBzb21ldGhpbmcgdG8gZG8gd2l0aCBhIHVuaXF1ZSBhc3BlY3QgYWJvdXQgdGliYmxlcy4gCgojIyMjCgoKTGV0J3Mgc2F5IHdlIGFsc28gd2FudCB0byByZW5hbWUgdGhlIGBjb3VudHJ5YCB2YXJpYWJsZSB0byBiZSBjYXBpdGFsaXplZC4KVG8gZG8gdGhpcywgd2UgY2FuIHVzZSB0aGUgYHJlbmFtZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIHJlbmFtZSB0aGlzIHZhcmlhYmxlLiAKV2hlbiByZW5hbWluZyB2YXJpYWJsZXMgdGhlIHN5bnRheCBpcyBgbmV3LW5hbWUgPSBvbGQtbmFtZWAsIHdoZXJlIHRoZSBuZXcgbmFtZSBpcyBsaXN0ZWQgZmlyc3QgYmVmb3JlIHRoZSBgPWAuIAogCllvdSBtYXkgYWxzbyBub3RlIHRoYXQgdGhlIGBZZWFyYCB2YXJpYWJsZSBpcyBjdXJyZW50bHkgb2YgY2xhc3MgdHlwZSBjaGFyYWN0ZXIuIFdlIHdvdWxkIGxpa2UgdG8gY2hhbmdlIGl0IHRvIGJlIG51bWVyaWMuIFRvIGRvIHRoaXMgd2Ugd2lsbCB1c2UgdGhlIGBtdXRhdGUoKWAgZnVuY3Rpb24sIHdoaWNoIGlzIGFsc28gcGFydCBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiBUaGlzIGZ1bmN0aW9uIGFsbG93cyB1cyB0byBjcmVhdGUgYW5kIG1vZGlmeSB2YXJpYWJsZXMuIFdlIHdpbGwgYWxzbyB1c2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgYSB2YXJpYWJsZSBjYWxsZWQgYExhYmVsYCB3aGljaCB3aWxsIGhhdmUgYCJDTzIgRW1pc3Npb25zIChNZXRyaWMgVG9ucykiYCBhcyB0aGUgdmFsdWUgZm9yIGV2ZXJ5IHJvdywgdG8gYmUgdXNlZCB3aGVuIHdlIGNyZWF0ZSBwbG90cyBsYXRlci4KCgpgYGB7cn0KQ08yX2VtaXNzaW9ucyAgJTw+JQogICBkcGx5cjo6cmVuYW1lKENvdW50cnkgPSBjb3VudHJ5KSAlPiUKICAgZHBseXI6Om11dGF0ZShZZWFyID0gYXMubnVtZXJpYyhZZWFyKSwKICAgICAgICAgICAgICAgICBMYWJlbCA9ICJDTzIgRW1pc3Npb25zIChNZXRyaWMgVG9ucykiKQpgYGAKCk5vdyBsZXQncyB0YWtlIGEgbG9vayB0byBzZWUgaG93IG91ciBkYXRhIGhhcyBjaGFuZ2VkOgoKYGBge3J9CnNldC5zZWVkKDEyMykKCkNPMl9lbWlzc2lvbnMgJT4lCiAgc2xpY2Vfc2FtcGxlKG4gPSA2KQpgYGAKR3JlYXQsIHdlIGNhbiBzZWUgdGhhdCBub3cgdGhlIGBZZWFyYCB2YXJpYWJsZSBpcyBvZiBjbGFzcyBkb3VibGUgKGFiYnJldmlhdGVkIGBkYmxgKSwgd2hpY2ggaXMgYSBudW1lcmljIGNsYXNzLgoKTm93LCBsZXQncyB0YWtlIGEgbG9vayBhdCB0aGUgYENvdW50cnlgIHZhcmlhYmxlIHRvIGNoZWNrIGlmIHRoZXJlIGlzIGFueXRoaW5nIHVuZXhwZWN0ZWQuIApXZSB3aWxsIHVzZSB0aGUgYGRpc3RpbmN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gdmlldyB0aGUgdW5pcXVlIHZhbHVlcyBvbmx5LgpGaW5hbGx5LCB3ZSB1c2UgdGhlIGBwdWxsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gZXh0cmFjdCB0aGUgdmFsdWVzIGZyb20gdGhlIGNvbHVtbiAodGhpcyBpcyBzaW1pbGFyIHRvIHVzaW5nIHRoZSBgJGAgYmFzZSBSIHN5bnRheCBlLmcuIGBDTzJfZW1pc3Npb24kQ291bnRyeWApLiAKCiMjIyMgey5zY3JvbGxhYmxlIH0KYGBge3J9CiMgU2Nyb2xsIHRocm91Z2ggdGhlIG91dHB1dCEKQ08yX2VtaXNzaW9ucyAlPiUKICBkaXN0aW5jdChDb3VudHJ5KSAlPiUKICBwdWxsKCkKYGBgCiMjIyMKClRoZXNlIGFsbCBsb29rIGFzIGV4cGVjdGVkIQoKCiMjICoqWWVhcmx5IEdyb3d0aCBpbiBHRFAgcGVyIENhcGl0YSoqCioqKgpMZXQncyB0YWtlIGEgbG9vayBhdCB0aGUgbmV4dCBkYXRhc2V0IChgZ2RwX2dyb3d0aGApIHRoYXQgd2UgaW1wb3J0ZWQuIAoKYGBge3J9CmdkcF9ncm93dGggJT4lCiAgc2xpY2VfaGVhZChuID0gMykKYGBgCgpIb3cgbWFueSByb3dzIGFuZCBjb2x1bW5zIGFyZSB0aGVyZSBhcmUgdGhlcmU/IFdlIGNhbiBlYXNpbHkgY2hlY2sgYnkgdXNpbmcgdGhlIGJhc2UgYGRpbSgpYCBmdW5jdGlvbiwgd2hpY2ggZXZhbHVhdGVzIHRoZSBkaW1lbnNpb25zIG9mIGFuIG9iamVjdC4KCmBgYHtyfQpkaW0oZ2RwX2dyb3d0aCkKYGBgCgpJbnRlcmVzdGluZywgaXQncyBgciBucm93KGdkcF9ncm93dGgpYCByb3dzIChhcyBvcHBvc2VkIHRvIGByIG5yb3coQ08yX2VtaXNzaW9ucylgIGFib3ZlKS4gCldlIHdpbGwgZGVhbCB3aXRoIHRoaXMgYW5kIG90aGVyIGRpZmZlcmVuY2VzIGluIHRoZSBzZXRzIG9mIGNvdW50cmllcyBhIGJpdCBsYXRlciBvbi4KVGhlcmUgYXJlIGFsc28gYHIgbmNvbChnZHBfZ3Jvd3RoKWAgY29sdW1ucyB3aXRoIGEgYGNvdW50cnlgIGNvbHVtbiBhbmQgYSBzZXQgb2YgY29sdW1ucyBjb3JyZXNwb25kaW5nIHRvIGRpZmZlcmVudCB5ZWFycy4gCgpgYGB7cn0KbmFtZXMoZ2RwX2dyb3d0aCkKYGBgCgpZZXMsIG5vIG90aGVyIGNvbHVtbnMgaW4gdGhpcyBkYXRhc2V0LiAKCk5leHQsIHdlIHdpbGwgdXNlIHRoZSBgcGl2b3RfbG9uZ2VyKClgIHRvIHRyYW5zZm9ybSB0aGUgZGF0YSB0byBsb25nIGZvcm1hdCwgc2ltaWxhciB0byB3aGF0IHdlIGRpZCBpbiB0aGUgcHJldmlvdXMgc2VjdGlvbi4KCldlIHdpbGwgYWxzbyBhZ2FpbiBjaGFuZ2UgdGhlIGBjb3VudHJ5YCB2YXJpYWJsZSB0byBiZSBgQ291bnRyeWAgYnkgdXNpbmcgdGhlIGByZW5hbWUoKWAgZnVuY3Rpb24sIGFuZCB3ZSB3aWxsIG1ha2UgdGhlIGBZZWFyYCB2YXJpYWJsZSBudW1lcmljIHVzaW5nIHRoZSBgbXV0YXRlKClgIGZ1bmN0aW9uLiAKCiMjIyMgey5yZWNhbGxfY29kZV9xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpVc2luZyB3aGF0IHlvdSBqdXN0IGxlYXJuZWQgYWJvdXQgYHBpdm90X2xvbmdlcigpYCwgYHJlbmFtZSgpYCwgYW5kIGBtdXRhdGUoKWAgYW5kIHdpdGhvdXQgc2Nyb2xsaW5nIHVwLCB0cnkgdG8gY29tZSB1cCB3aXRoIHRoZSBjb2RlIHRvIGRvIHRoZSB3cmFuZ2xpbmcgZm9yIHRoaXMgZGF0YS4KCiMjIyMKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpnZHBfZ3Jvd3RoICU8PiUKICBwaXZvdF9sb25nZXIoY29scyA9IC1jb3VudHJ5LAogICAgICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwKICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gImdkcF9ncm93dGgiKSAlPiUKICByZW5hbWUoQ291bnRyeSA9IGNvdW50cnkpICU+JQogIG11dGF0ZShZZWFyID0gYXMubnVtZXJpYyhZZWFyKSwKICAgICAgICAgTGFiZWwgPSAiR0RQIEdyb3d0aC9DYXBpdGEgKCUpIikgJT4lCiAgcmVuYW1lKEdEUCA9IGdkcF9ncm93dGgpCmBgYCAgCgo8L2RldGFpbHM+CioqKgoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ2RwX2dyb3d0aCAlPD4lCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSAtY291bnRyeSwKICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwKICAgICAgICAgIHZhbHVlc190byA9ICJnZHBfZ3Jvd3RoIikgJT4lCiAgcmVuYW1lKENvdW50cnkgPSBjb3VudHJ5KSAlPiUKICBtdXRhdGUoWWVhciA9IGFzLm51bWVyaWMoWWVhciksCiAgICAgICAgTGFiZWwgPSAiR0RQIEdyb3d0aC9DYXBpdGEgKCUpIikgJT4lCiAgcmVuYW1lKEdEUCA9IGdkcF9ncm93dGgpCmBgYAoKTm93IGxldCdzIHNlZSBob3cgdGhpcyBkYXRhIGhhcyBjaGFuZ2VkOgoKYGBge3J9CmdkcF9ncm93dGggJT4lCiAgc2xpY2VfaGVhZChuID0gNikKCmdkcF9ncm93dGggJT4lCiAgY291bnQoWWVhcikKYGBgCgpBZ2FpbiBsZXQncyBjaGVjayB0aGF0IHRoZSBgQ291bnRyeWAgdmFyaWFibGUgb25seSBjb250YWlucyB2YWx1ZXMgd2Ugd291bGQgZXhwZWN0LgoKIyMjIyB7LnNjcm9sbGFibGUgfQpgYGB7cn0KIyBTY3JvbGwgdGhyb3VnaCB0aGUgb3V0cHV0IQpnZHBfZ3Jvd3RoICU+JQogIGRpc3RpbmN0KENvdW50cnkpICU+JQogIHB1bGwoKQpgYGAKIyMjIwoKQWxzbyBsb29rcyBnb29kIQoKIyMgKipFbmVyZ3kgVXNlIHBlciBQZXJzb24qKgoqKioKCk5vdyBsZXQncyB0YWtlIGEgbG9vayBhdCB0aGUgZW5lcmd5IHVzZSBwZXIgcGVyc29uIGRhdGEgKGBlbmVyZ3lfdXNlYCkgdXNpbmcgYHNsaWNlX2hlYWQoKWAgYW5kIGBnbGltcHNlKClgLiAKCmBgYHtyfQplbmVyZ3lfdXNlICU+JQogIHNsaWNlX2hlYWQobiA9IDMpCmBgYAoKIyMjIyB7LnNjcm9sbGFibGV9CmBgYHtyfQplbmVyZ3lfdXNlICU+JQogIGdsaW1wc2UoKQpgYGAKIyMjIwoKTG9va3MgbGlrZSB3ZSBoYXZlIGByIG5yb3coZW5lcmd5X3VzZSlgIHJvd3MgYW5kIGByIG5jb2woZW5lcmd5X3VzZSlgIGNvbHVtbnMgd2hlcmUgd2UgaGF2ZSBhIGBjb3VudHJ5YCBjb2x1bW4gYW5kIGFnYWluIGEgc2V0IG9mIHllYXJzLiAKVG8gd3JhbmdsZSB0aGUgYGVuZXJneV91c2VgIGRhdGEsIHdlIHdpbGwgYWdhaW4gY29udmVydCB0aGUgZGF0YSB0byBsb25nIGZvcm1hdCwgcmVuYW1lIHNvbWUgdmFyaWFibGVzLCBhbmQgbXV0YXRlIHRoZSBgWWVhcmAgZGF0YSB0byBiZSBudW1lcmljLgoKIyMjIyB7LnJlY2FsbF9jb2RlX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCkFnYWluIHRyeSB0byBjb21lIHVwIHdpdGggdGhlIGNvZGUgb24geW91ciBvd24gdG8gd3JhbmdsZSB0aGUgZGF0YS4KCiMjIyMKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgpgYGB7ciwgZXZhbCA9IEZBTFNFfQplbmVyZ3lfdXNlICU8PiUKICBwaXZvdF9sb25nZXIoY29scyA9IC1jb3VudHJ5LAogICAgICAgICAgICAgICBuYW1lc190byA9ICJZZWFyIiwKICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gImVuZXJneV91c2UiKSAlPiUKICByZW5hbWUoQ291bnRyeSA9IGNvdW50cnkpICU+JQogIG11dGF0ZShZZWFyID0gYXMubnVtZXJpYyhZZWFyKSwKICAgICAgICAgTGFiZWwgPSAiRW5lcmd5IFVzZSAoa2csIG9pbC1lcS4vY2FwaXRhKSIpICU+JQogIHJlbmFtZShFbmVyZ3kgPSBlbmVyZ3lfdXNlKQpgYGAKPC9kZXRhaWxzPgoqKioKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmVuZXJneV91c2UgJTw+JQogIHBpdm90X2xvbmdlcihjb2xzID0gLWNvdW50cnksCiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIlllYXIiLAogICAgICAgICAgICAgICB2YWx1ZXNfdG8gPSAiZW5lcmd5X3VzZSIpICU+JQogIHJlbmFtZShDb3VudHJ5ID0gY291bnRyeSkgJT4lCiAgbXV0YXRlKFllYXIgPSBhcy5udW1lcmljKFllYXIpLAogICAgICAgICBMYWJlbCA9ICJFbmVyZ3kgVXNlIChrZywgb2lsLWVxLi9jYXBpdGEpIikgJT4lCiAgcmVuYW1lKEVuZXJneSA9IGVuZXJneV91c2UpCmBgYAoKCmBgYHtyfQpzZXQuc2VlZCgxMjMpCgplbmVyZ3lfdXNlICU+JQogIHNsaWNlX3NhbXBsZShuID0gMykKYGBgCgpOb3cgd2Ugd2lsbCBjaGVjayB0aGUgYENvdW50cnlgIHZhcmlhYmxlOgoKIyMjIyB7LnNjcm9sbGFibGUgfQpgYGB7cn0KIyBTY3JvbGwgdGhyb3VnaCB0aGUgb3V0cHV0IQplbmVyZ3lfdXNlICU+JQogIGRpc3RpbmN0KENvdW50cnkpICU+JQogIHB1bGwoKQpgYGAKIyMjIwoKTG9va3MgZ29vZCEKCiMjICoqVVMgU3BlY2lmaWMgRGF0YSoqCioqKgoKTm93IHdlIHdpbGwgdGFrZSBhIGxvb2sgYXQgdGhlIFVTIGRhdGEgYWJvdXQgZGlzYXN0ZXJzIGFuZCB0ZW1wZXJhdHVyZS4KCiMjIyAqKkRpc2FzdGVycyoqCioqKgoKRmlyc3QsIHdlIGNvbnNpZGVyIHRoZSBkaXNhc3RlcnMgdGhhdCBoYXZlIG9jY3VycmVkIGluIHRoZSBVUy4gCmBgYHtyfQp1c19kaXNhc3RlcgpgYGAKCldlIGFyZSBzcGVjaWZpY2FsbHkgaW50ZXJlc3RlZCBpbiB0aGUgYFllYXJgIGFuZCB0aGUgdmFyaWFibGVzIHRoYXQgY29udGFpbiB0aGUgd29yZCBgIkNvdW50ImAuIFRoZSBvdGhlciB2YXJpYWJsZXMgcmVwcmVzZW50IGFuIGVzdGltYXRlIG9mIHRoZSBlY29ub21pYyBjb3N0IGluIGJpbGxpb25zIG9mIGRvbGxhcnMsIGFzIHdlbGwgYXMgdGhlIHVwcGVyIGFuZCBsb3dlciBib3VuZHMgZm9yIHNpbXVsYXRpb25zIHVzZWQgdG8gZXN0aW1hdGUgdGhlIGVjb25vbWljIGNvc3QsIHdoaWNoIHNob3cgdGhlIGxldmVsIG9mIHVuY2VydGFpbnR5IGluIHRoZXNlIGVzdGltYXRlcyAoYXQgdGhyZWUgZGlmZmVyZW50IGxldmVscyBvZiBjb25maWRlbmNlKSBhcyB0aGUgdHJ1ZSBjb3N0IGlzIHVua25vd24uIFNlZSBbaGVyZV0oaHR0cHM6Ly93d3cubmNkYy5ub2FhLmdvdi9iaWxsaW9ucy90aW1lLXNlcmllcykgZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGRhdGEuIEZvciB0aGlzIGFuYWx5c2lzLCB3ZSB3aWxsIGZvY3VzIGp1c3Qgb24gdGhlIG51bWJlciBvZiBkaXNhc3RlcnMgdGhhdCBvY2N1cnJlZCBlYWNoIHllYXIuIAoKV2Ugd2lsbCBzZWxlY3Qgb3VyIHZhcmlhYmxlcyBvZiBpbnRlcmVzdCB1c2luZyB0aGUgYHNlbGVjdCgpYCBhbmQgYGNvbnRhaW5zKClgIGZ1bmN0aW9ucyBpbiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKU2luY2Ugd2UgYXJlIHNlbGVjdGluZyBmb3IgdmFyaWFibGVzIHdpdGggdGhlIHdvcmQgYCJDb3VudCJgIHdlIG5lZWQgdG8gdXNlIHF1b3RhdGlvbiBtYXJrcyBhcm91bmQgaXQuIAoKU2VsZWN0aW5nIGZvciB0aGUgdmFyaWFibGUgYFllYXJgIGRvZXMgbm90IHJlcXVpcmUgcXVvdGVzIGJlY2F1c2UgaXQgaXMgdGhlIGZ1bGwgbmFtZSBvZiBvbmUgb2YgdGhlIGV4aXN0aW5nIHZhcmlhYmxlcy4KCgpgYGB7cn0KdXNfZGlzYXN0ZXIgJTw+JQogICAgICAgICAgIHNlbGVjdChZZWFyLCBjb250YWlucygiQ291bnQiKSkKCnVzX2Rpc2FzdGVyICU+JQogIHNsaWNlX2hlYWQobiA9IDYpCmBgYAoKTm93IHdlIHdhbnQgdG8gY3JlYXRlIGEgbmV3IHZhcmlhYmxlIHRoYXQgd2lsbCBiZSB0aGUgc3VtIG9mIGFsbCB0aGUgZGlmZmVyZW50IHR5cGVzIG9mIGRpc2FzdGVycyBmb3IgZWFjaCB5ZWFyLiAKCldlIGRvbid0IHdhbnQgdG8gaW5jbHVkZSB0aGUgYFllYXJgIHZhcmlhYmxlIGluIG91ciBzdW0sIHNvIHdlIGNhbiBleGNsdWRlIGl0IHVzaW5nIHRoZSBgc2VsZWN0YCBmdW5jdGlvbi4gVG8gcGVyZm9ybSB0aGUgc3VtIGZvciBlYWNoIHllYXIsIHdlIGNhbiB1c2UgdGhlIGJhc2UgYHJvd1N1bXMoKWAgZnVuY3Rpb24uIAoKYGBge3J9CnllYXJseV9kaXNhc3RlcnMgPC0gdXNfZGlzYXN0ZXIgJT4lIAogICAgICAgICAgICAgICAgICAgICAgc2VsZWN0KC1ZZWFyKSAlPiUKICAgICAgICAgICAgICAgICAgICAgIHJvd1N1bXMoKQoKeWVhcmx5X2Rpc2FzdGVycwpgYGAKCldlIGNvdWxkIHRoZW4gYWRkIHRoaXMgdG8gb3VyIGB1c19kaWFzdGVyYCB0aWJibGUgbGlrZSBzbyB1c2luZyB0aGUgYGJpbmRfY29sc2AgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZToKCmBgYHtyfQp1c19kaXNhc3RlciAlPiUgYmluZF9jb2xzKERpc2F0ZXJzID0geWVhcmx5X2Rpc2FzdGVycykKYGBgCgpIb3dldmVyLCB3ZSBjYW4gYWN0dWFsbHkgY3JlYXRlIGFuZCBhZGQgdGhpcyBuZXcgdmFyaWFibGUgZGlyZWN0bHkgdG8gdGhlIGB1c19kaXNhc3RlcmAgdGliYmxlIGJ5IHVzaW5nIHRoZSBgbXV0YXRlKClgIGZ1bmN0aW9uIG9mIGBkcGx5cmAgYW5kIHVzaW5nIHRoZSBgLmAgbm90YXRpb24uCgpXZSBuZWVkIHRvIHVzZSB0aGUgYC5gIG5vdGF0aW9uIHRvIGluZGljYXRlIHRoYXQgd2UgYXJlIHVzaW5nIHRoZSBkYXRhIHRoYXQgd2UgYWxyZWFkeSB1c2VkIGFzIGlucHV0IChvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBwaXBlKSB0byBvdXIgYG11dGF0ZSgpYCBmdW5jdGlvbiAob24gdGhlIHJpZ2h0IHNpZGUgb2Ygb3VyIHBpcGUpLCB3aGljaCBpbiB0aGlzIGNhc2UgaXMgdGhlIGVudGlyZSBgdXNfZGlzYXN0ZXJgIHRpYmJsZSBmb3Igb3VyIGBzZWxlY3QoKWAgZnVuY3Rpb24uIFRoZSBvdXRwdXQgZnJvbSB0aGUgYHNlbGVjdCgpYCBmdW5jdGlvbiB3aWxsIGJlIHVzZWQgZm9yIHRoZSBgcm93U3VtcygpYCBmdW5jdGlvbi4gCgpgYGB7cn0KdXNfZGlzYXN0ZXIgJTw+JQogIG11dGF0ZShEaXNhc3RlcnMgPSByb3dTdW1zKHNlbGVjdCguLCAtWWVhcikpKQoKdXNfZGlzYXN0ZXIgJT4lCiAgZ2xpbXBzZSgpCmBgYAoKR3JlYXQsIG5vdyB3ZSBhcmUgZ29pbmcgdG8gcmVtb3ZlIHNvbWUgb2YgdGhlc2UgdmFyaWFibGVzIGFuZCBqdXN0IGtlZXAgdGhlIHZhcmlhYmxlcyBvZiBpbnRlcmVzdCB1c2luZyBgc2VsZWN0KClgLgoKV2UgYXJlIGFsc28gZ29pbmcgdG8gYWRkIGEgbmV3IHZhcmlhYmxlIGNhbGxlZCBgQ291bnRyeWAgdG8gaW5kaWNhdGUgdGhhdCB0aGlzIGRhdGEgaXMgZnJvbSB0aGUgVW5pdGVkIFN0YXRlcy4gQWdhaW4gdGhpcyB3aWxsIGNyZWF0ZSBhIG5ldyB2YXJpYWJsZSB3aGVyZSBldmVyeSB2YWx1ZSBpcyBgVW5pdGVkIFN0YXRlc2AuCgpgYGB7cn0KdXNfZGlzYXN0ZXIgJTw+JQogIGRwbHlyOjpzZWxlY3QoWWVhciwgRGlzYXN0ZXJzKSAlPiUKICBtdXRhdGUoQ291bnRyeSA9ICJVbml0ZWQgU3RhdGVzIikgJT4lCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBjKC1Db3VudHJ5LCAtWWVhciksCiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gIkluZGljYXRvciIsCiAgICAgICAgICAgICAgIHZhbHVlc190byA9ICJWYWx1ZSIpICU+JQogIG11dGF0ZShMYWJlbCA9ICJOdW1iZXIgb2YgRGlzYXN0ZXJzIikKCnVzX2Rpc2FzdGVyICU+JQogIHNsaWNlX2hlYWQobiA9IDYpCmBgYApHcmVhdCwgdGhpcyBsb29rcyBnb29kIG5vdy4gCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKVGhpcyBkYXRhc2V0IHdhcyBzbGlnaHRseSBkaWZmZXJlbnQgZnJvbSB0aGUgb3RoZXIgZGF0YXNldHMgYW5kIHRoZXJlZm9yZSByZXF1aXJlZCBzbGlnaHRseSBkaWZmZXJlbnQgd3JhbmdsaW5nLgpXaHkgd2FzIGl0IG5lY2Vzc2FyeSB0byBleGNsdWRlIHRoZSBgWWVhcmAgdmFyaWFibGUgZnJvbSB0aGUgYHBpdm90X2xvbmdlcigpYCBmdW5jdGlvbj8KV2hhdCB3b3VsZCBoYXBwZW4gaWYgd2UgZGlkIG5vdCBleGNsdWRlIGBZZWFyYD8KCiMjIyMKCiMjIyAqKlRlbXBlcmF0dXJlKioKKioqCgpOZXh0LCB3ZSBjb25zaWRlciB0aGUgdGVtcGVyYXR1cmUgaW4gdGhlIFVTIG92ZXIgdGltZS4gIApgYGB7cn0KdXNfdGVtcGVyYXR1cmUgJT4lCiAgc2xpY2VfaGVhZChuID0gNikKYGBgClNvIGEgZmV3IHRoaW5ncyBuZWVkIHRvIGJlIGZpeGVkIGhlcmUuIAoKRmlyc3QsIHRoZSBgRGF0ZWAgY29sdW1uIGxvb2tzIGEgYml0IHN0cmFuZ2UuIFRoZSBmb3JtYXQgb2YgdGhlIG51bWJlcnMgbG9vayBsaWtlIHRoZSB5ZWFyIGZvbGxvd2VkIGJ5IHRoZSBudW1iZXIgMTIgKHJlcHJlc2VudGluZyAxMiBtb250aHMpLgoKV2Ugd2FudCB0byBjaGFuZ2UgdGhpcyB0byBvbmx5IGtlZXAgdGhlIGZpcnN0IDQgY2hhcmFjdGVycyBpbiB0aGUgYERhdGVgIHZhcmlhYmxlIHN0cmluZyB2YWx1ZXMuIAoKSG93ZXZlciwgZmlyc3QgbGV0J3MgbWFrZSBzdXJlIHRoYXQgaW5kZWVkIGFsbCBvZiB0aGUgYERhdGVgIHZhcmlhYmxlcyBhcmUgNiBjaGFyYWN0ZXJzIGxvbmcgYW5kIHRoYXQgdGhleSBhbGwgZW5kIHdpdGggdGhlIG51bWJlciAxMi4KCldlIGNhbiB1c2UgYSBjb3VwbGUgb2YgZnVuY3Rpb25zIGluIHRoZSBgc3RyaW5ncmAgcGFja2FnZSB0byBkbyB0aGlzLiBUaGlzIHBhY2thZ2UgaXMgdXNlZCBmb3Igd29ya2luZyB3aXRoIGNoYXJhY3RlciBzdHJpbmdzLiAgVGhlIGBzdHJfbGVuZ3RoKClgIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIGNoZWNrIHRoZSBsZW5ndGggb2YgZWFjaCB2YWx1ZSwgd2hpbGUgdGhlIGBzdHJfZW5kcygpYCBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBjaGVjayB0aGF0IGFsbCB0aGUgdmFsdWVzIGVuZCB3aXRoIGAiMTIiYC4KCkxldCdzIHN0YXJ0IHdpdGggdGhlIGBzdHJfbGVuZ3RoKClgIGZ1bmN0aW9uLiBUaGVzZSBmdW5jdGlvbnMgaW4gdGhlIGBzdHJpbmdyYCBwYWNrYWdlIHJlcXVpcmUgYSBjaGFyYWN0ZXIgdmVjdG9yLiBUaHVzIHdlIG5lZWQgdG8gcHVsbCB0aGUgdmFsdWVzIGZvciB0aGUgYERhdGVgIHZhcmlhYmxlIGZpcnN0IHVzaW5nIHRoZSBgcHVsbCgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKCmBgYHtyfQp1c190ZW1wZXJhdHVyZSAlPiUKICBwdWxsKERhdGUpICU+JQogIHN0cl9sZW5ndGgoKQpgYGAKR3JlYXQhIEl0IGxvb2tzIGxpa2UgYWxsIG9mIHRoZSB2YWx1ZXMgYXJlIDYgY2hhcmFjdGVycyBsb25nLgoKTm93IGxldCdzIGNoZWNrIHRoYXQgdGhleSBhbGwgZW5kIHdpdGggYCIxMiJgLiBXZSBqdXN0IG5lZWQgdG8gc3BlY2lmeSB3aGF0IHBhdHRlcm4gdG8gbG9vayBmb3IuIAoKYGBge3J9CnVzX3RlbXBlcmF0dXJlICU+JQogIHB1bGwoRGF0ZSkgJT4lCiAgc3RyX2VuZHMocGF0dGVybiA9ICIxMiIpCgpgYGAKR3JlYXQhIFNpbmNlIGFsbCBvZiB0aGUgdmFsdWVzIGFyZSBgVFJVRWAgd2Uga25vdyB0aGF0IGFsbCBvZiB0aGUgdmFsdWVzIGluIHRoZSBgRGF0ZWAgdmFyaWFibGUgZW5kIHdpdGggYCIxMiJgLgoKSXQncyBhIGdvb2QgaWRlYSB0byBhbHdheXMgY2hlY2sgdGhhdCB5b3VyIGRhdGEgaXMgYXMgeW91IGV4cGVjdC4gCgpOb3cgd2UgY2FuIHVzZSB0aGUgYHN0cl9zdWIoKWAgZnVuY3Rpb24gb2YgdGhlIGBzdHJpbmdyYCBwYWNrYWdlIHRvIHJlbW92ZSB0aGUgYCIxMiJgIGZyb20gZWFjaCBgRGF0ZWAgdmFsdWUuCgpXZSBqdXN0IG5lZWQgdG8gaW5kaWNhdGUgdGhlIHN0YXJ0IGFuZCBzdG9wIGNoYXJhY3RlcnMuIAoKSW4gdGhpcyBjYXNlIHRoZSBzdGFydCB3b3VsZCBiZSAxIGFuZCB0aGUgNHRoIGNoYXJhY3RlciB3b3VsZCBiZSB3aGVyZSB3ZSB3YW50IHRvIHN0b3AsIHNvIHdlIHdvdWxkIHVzZSBgc3RhcnQgPSAxLCBzdG9wID0gNGAuIFdlIGNhbiBkbyB0aGlzIGluc2lkZSBvZiB0aGUgYG11dGF0ZSgpYCBmdW5jdGlvbiB0byBtb2RpZnkgdGhlIGBEYXRlYCB2YXJpYWJsZS4gSW4gZG9pbmcgc28sIHdlIHdpbGwgbm90IG5lZWQgdG8gdXNlIGBwdWxsKClgIHRvIHB1bGwgdGhlIHZhbHVlcyBmb3IgdGhlIGBEYXRlYCB2YXJpYWJsZS4KCmBgYHtyfQp1c190ZW1wZXJhdHVyZSAlPD4lCiAgbXV0YXRlKERhdGUgPSBzdHJfc3ViKERhdGUsIHN0YXJ0ID0gMSwgZW5kID0gNCkpCgp1c190ZW1wZXJhdHVyZQpgYGAKV2UgYWxzbyB3YW50IHRvIHJlbW92ZSB0aGUgYEFub21hbHlgIHZhcmlhYmxlLCB3aGljaCBpcyBhbiBpbmRpY2F0b3Igb2YgaG93IGRpZmZlcmVudCB0aGUgbmF0aW9uYWwgYXZlcmFnZSB0ZW1wZXJhdHVyZSBmb3IgdGhhdCB5ZWFyIHdhcyBmcm9tIHRoZSBhdmVyYWdlIHRlbXBlcmF0dXJlIGZyb20gMTkwMS0yMDAwIHdoaWNoIHdhcyA1Mi4wMiZkZWc7Ri4gCgpUaGVuLCB3ZSBhbHNvIHdhbnQgdG8gY3JlYXRlIGEgYENvdW50cnlgIHZhcmlhYmxlLiAKV2Ugd2lsbCBhbHNvIGNoYW5nZSB0aGUgbmFtZSBvZiB0aGUgYERhdGVgIHZhcmlhYmxlIHRvIGBZZWFyYCBzbyB0aGF0IGl0IHdpbGwgYmUgY29uc2lzdGVudCB3aXRoIG91ciBvdGhlciBkYXRhc2V0cy4gV2UgYWxzbyBhbHNvIHdhbnQgdGhlIGBZZWFyYCB0byBiZSBudW1lcmljLiAKV2UgY2FuIGFjY29tcGxpc2ggYm90aCByZW5hbWluZyBhbmQgY2hhbmdpbmcgdG8gbnVtZXJpYyBieSB1c2luZyB0aGUgYG11dGF0ZSgpYCBmdW5jdGlvbi4KCldlIGFsc28gd2FudCB0byBjcmVhdGUgYW4gYEluZGljYXRvcmAgdmFyaWFibGUgc28gdGhhdCB3ZSBjYW4gbGF0ZXIgdGVsbCB3aGF0IGRhdGEgdGhlIHZhbHVlcyBpbiB0aGlzIHRpYmJsZSByZXByZXNlbnQgaWYgd2UgY29tYmluZSBpdCB3aXRoIG90aGVyIHRpYmJsZXMgYW5kIGEgYExhYmVsYCB2YXJpYWJsZSwgc28gdGhhdCB3ZSB3aWxsIGhhdmUgaW5mb3JtYXRpdmUgbGFiZWxzIGlmIHdlIG1ha2UgYSBwbG90IHdpdGggdGhpcyBkYXRhIGxhdGVyLiAKCkZpbmFsbHksIHdlIHJlbW92ZSB0aGUgYERhdGVgIHZhcmlhYmxlIGFuZCBhbHNvIG9yZGVyIHRoZSBjb2x1bW5zIGp1c3QgbGlrZSB0aGUgb3RoZXIgdXMgZGF0YSB1c2luZyB0aGUgYHNlbGVjdCgpYCBmdW5jdGlvbi4KCmBgYHtyfQp1c190ZW1wZXJhdHVyZSAlPD4lCiAgZHBseXI6OnNlbGVjdCgtQW5vbWFseSkgJT4lCiAgbXV0YXRlKENvdW50cnkgPSAiVW5pdGVkIFN0YXRlcyIsCiAgICAgICAgIFllYXIgPSBhcy5udW1lcmljKERhdGUpLAogICAgICAgICBJbmRpY2F0b3IgPSAiVGVtcGVyYXR1cmUiLAogICAgICAgICBMYWJlbCA9ICJUZW1wZXJhdHVyZSAoRmFocmVuaGVpdCkiKSAlPiUKICBzZWxlY3QoWWVhciwgQ291bnRyeSwgSW5kaWNhdG9yLCBWYWx1ZSwgTGFiZWwpCgp1c190ZW1wZXJhdHVyZSAlPiUKICBzbGljZV9oZWFkKG4gPSA2KQpgYGAKCgojIyAqKkpvaW5pbmcgZGF0YSoqCioqKgoKTm93IHRoYXQgd2UgaGF2ZSB3cmFuZ2xlZCB0aGUgaW5kaXZpZHVhbCBkYXRhc2V0cywgd2UgYXJlIHJlYWR5IHRvIHB1dCBldmVyeXRoaW5nIHRvZ2V0aGVyLiAKU3BlY2lmaWNhbGx5LCB3ZSB3aWxsIF9qb2luXyB0aGUgaW5kaXZpZHVhbCBkYXRhc2V0cyBpbnRvIG9uZSB0aWJibGUgdXNpbmcgYCpfam9pbigpYCBmdW5jdGlvbnMgYXZhaWxhYmxlIGluIHRoZSBgZHBseXJgIHBhY2thZ2UuIAoKQmVmb3JlIHdlIGJlZ2luIHRob3VnaCwgd2Ugd2lsbCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZXJlIGlzIGF0IGxlYXN0IG9uZSB2YXJpYWJsZS9jb2x1bW4gdGhhdCBoYXMgdGhlIHNhbWUgbmFtZSBhY3Jvc3MgYWxsIGRhdGFzZXRzIHRvIGJlIGpvaW5lZC4gU3VjaCB2YXJpYWJsZXMgd2l0aCBjb21tb24gbmFtZXMgYXJlIGNhbGxlZCAqKmtleXMqKiBmb3Igam9pbmluZyB5b3VyIGRhdGEuCgpUaGVzZSBhcmUgdGhlIGBieT0ieDEiYCBhcmd1bWVudHMgYmVsb3cgd2hlcmUgYHgxYCBpcyB0aGUgbmFtZSBvZiB0aGUgY29sdW1uIGluIGJvdGggdGhlIGBhYCBhbmQgYGJgIGRhdGFzZXRzIHRoYXQgd2Ugd2lsbCBqb2luIHRvZ2V0aGVyLiAKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI1MDAgcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiam9pbi5wbmciKSkKYGBgCgojIyMjIyBbW3NvdXJjZV1dKGh0dHBzOi8vcnN0dWRpby5jb20vd3AtY29udGVudC91cGxvYWRzLzIwMTUvMDIvZGF0YS13cmFuZ2xpbmctY2hlYXRzaGVldC5wZGYpe3RhcmdldD0iX2JsYW5rIn0KClRoZXJlIGFyZSBzZXZlcmFsIHR5cGVzIG9mIGAqX2pvaW4oKWAgZnVuY3Rpb25zIHRvIGNvbnNpZGVyLiBUaGUgYGZ1bGxfam9pbigpYCBmdW5jdGlvbiBrZWVwcyBhbGwgcm93cyBmcm9tIGJvdGggdGliYmxlcyB0aGF0IGFyZSBiZWluZyBqb2luZWQgYW5kIGFkZHMgYE5BYCB2YWx1ZXMgYXMgbmVjZXNzYXJ5IGlmIHRoZXJlIGFyZSB2YWx1ZXMgd2l0aGluIHRoZSBrZXkgZm9yIGVpdGhlciBvZiB0aGUgdGliYmxlcyB0aGF0IGlzIGlzIG5vdCBpbiB0aGUga2V5IG9mIHRoZSBvdGhlciB0aWJibGUuIAoKV2UgdXNlIHRoZSBgZnVsbF9qb2luKClgIGZ1bmN0aW9uIGFzIHdlIGhhdmUgZGlmZmVyZW50IHRpbWUgc3BhbnMgZm9yIGVhY2ggZGF0YXNldCBhbmQgd2Ugd291bGQgbGlrZSB0byByZXRhaW4gYXMgbXVjaCBkYXRhIGFzIHBvc3NpYmxlLiAKClRoZSBgZnVsbF9qb2luKClgIGZ1bmN0aW9uIHdpbGwgc2ltcGx5IGNyZWF0ZSBgTkFgIHZhbHVlcyBmb3IgYW55IG9mIHRoZSB5ZWFycyB0aGF0IGFyZSBub3QgaW4gb25lIG9mIHRoZSBkYXRhc2V0cy4gCgpGaXJzdCwgd2UgY2hlY2sgdXNpbmcgdGhlIGJhc2UgYHN1bW1hcnkoKWAgZnVuY3Rpb24gdGhhdCB0aGVyZSBhcmUgY29sdW1uIG5hbWVzIHRoYXQgYXJlIGNvbnNpc3RlbnQgaW4gZWFjaCBkYXRhc2V0IHRoYXQgd2Ugd2lzaCB0byBjb21iaW5lLgoKYGBge3J9CnN1bW1hcnkoQ08yX2VtaXNzaW9ucykKc3VtbWFyeShnZHBfZ3Jvd3RoKQpzdW1tYXJ5KGVuZXJneV91c2UpCmBgYAoKIyMjIyB7LnRoaW5rX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCldoYXQgdmFyaWFibGUgb3IgdmFyaWFibGVzIG1pZ2h0IHdlIHdhbnQgdG8gdXNlIHRvIGpvaW4gb3VyIGRhdGEgYnk/CgojIyMjCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHNlZSBhbiBleHBsYW5hdGlvbiBmb3Igd2hhdCB2YXJpYWJsZSBvciB2YXJpYWJsZXMgdG8gam9pbiBieSBhZnRlciB5b3UgaGF2ZSB0aG91Z2h0IGFib3V0IGl0LiA8L3N1bW1hcnk+CgoKVGhlIGBDb3VudHJ5YCwgYW5kIGBZZWFyYCB2YXJpYWJsZXMgYXJlIHByZXNlbnQgaW4gYWxsIG9mIHRoZSBkYXRhc2V0cyB3aXRoIHZhbHVlcyB0aGF0IG92ZXJsYXAuIEFsdGhvdWdoIGBMYWJlbGAgaXMgYWxzbyBwcmVzZW50IGluIHRoZSBkYXRhc2V0cywgdGhlIHZhbHVlcyBkbyBub3Qgb3ZlcmxhcC4gV2UgY2FuIHNlZSB0aGF0IHRoZSBtaW5pbXVtIGFuZCBtYXhpbXVtIHllYXIgaXMgZGlmZmVyZW50IGZvciBuZWFybHkgYWxsIHRoZSBkYXRhc2V0cy4KCgpOZXh0LCB3ZSBuZWVkIHRvIHNwZWNpZnkgd2hhdCBjb2x1bW5zL3ZhcmlhYmxlcyB3ZSB3aWxsIGJlIGpvaW5pbmcgYnkgdXNpbmcgdGhlIGBieSA9YCBhcmd1bWVudCBpbiB0aGUgYGZ1bGxfam9pbigpYCBmdW5jdGlvbiwgKHJlY2FsbCB0aGF0IHRoaXMgdmFyaWFibGUgaXMgY2FsbGVkIHRoZSAia2V5IikKCmBgYHtyfQpkYXRhX3dpZGUgPC0gQ08yX2VtaXNzaW9ucyAlPiUKICBmdWxsX2pvaW4oZ2RwX2dyb3d0aCwgYnkgPSBjKCJDb3VudHJ5IiwgIlllYXIiLCAiTGFiZWwiKSkgJT4lCiAgZnVsbF9qb2luKGVuZXJneV91c2UsIGJ5ID0gYygiQ291bnRyeSIsICJZZWFyIiwgIkxhYmVsIikpCgpzZXQuc2VlZCgxMjMpCgpkYXRhX3dpZGUgJT4lCiAgc2xpY2Vfc2FtcGxlKG4gPSA2KQpgYGAKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gc2VlIGFuIGV4cGxhbmF0aW9uIGZvciBhbm90aGVyIG9wdGlvbiB0aGF0IHdvcmtzIHdlbGwgZm9yIGxhcmdlIG51bWJlcnMgb2YgdGliYmxlcyA8L3N1bW1hcnk+CgpXZSBjYW4gYWxzbyBkbyB0aGUgc2FtZSB0aGluZyBieSB1c2luZyB0aGUgYHJlZHVjZSgpYCBmdW5jdGlvbiBvZiB0aGUgYHB1cnJyYCBwYWNrYWdlLiAgVGhpcyB0YWtlcyBhIGxpc3Qgb2YgZWxlbWVudHMgKHdoaWNoIGNhbiBiZSB0aWJibGVzKSBhbmQgdGhlbiBhcHBsaWVzIGEgZnVuY3Rpb24gdGhhdCByZXF1aXJlcyB0d28gaW5wdXRzIGl0ZXJhdGl2ZWx5IHVzaW5nIHRoZSBmaXJzdCBwYWlyIG9mIGVsZW1lbnRzIGFuZCBjcmVhdGluZyBhIHNpbmdsZSBlbGVtZW50IGFuZCB0aGVuIGFwcGx5aW5nIHRoZSBmdW5jdGlvbiBhZ2FpbiB0byB0aGUgb3V0cHV0IGVsZW1lbnQgYW5kIHRoZSBuZXh0IGxpc3RlZCBlbGVtZW50IGFuZCBzbyBvbiBhbmQgc28gZm9ydGguCgpGb3IgZXhhbXBsZSB3ZSB3aWxsIHVzZSBhIGxpc3Qgb2YgdGliYmxlcyBhbmQgdGhlIGBmdWxsX2pvaW4oKWAgZnVuY3Rpb24gd2hpY2ggcmVxdWlyZXMgdHdvIHRpYmJsZXMgdG8gY29tYmluZS4gVGhpcyB3aWxsIGZpcnN0IGNvbWJpbmUgYENPMl9lbWlzc2lvbnNgIGFuZCAgYGdkcF9ncm93dGhgIGFuZCB0aGVuIHRha2UgdGhlIHJlc3VsdGluZyBqb2luZWQgdGliYmxlIGFuZCBjb21iaW5lIHRoaXMgd2l0aCB0aGUgYGVuZXJneV91c2VgIHRpYmJsZS4gCgoKWW91IGNhbiBzZWUgdGhhdCB0aGlzIGlzIGEgZ3JlYXQgb3B0aW9uIGlmIHlvdSBoYXZlIG1hbnkgZGF0YXNldHMgdG8gY29tYmluZSEKCmBgYHtyfQpkYXRhX3dpZGUgPC0KICBsaXN0KENPMl9lbWlzc2lvbnMsIGdkcF9ncm93dGgsIGVuZXJneV91c2UpICU+JQogIHJlZHVjZShmdWxsX2pvaW4sIGJ5ID0gYygiQ291bnRyeSIsICJZZWFyIiwgIkxhYmVsIikpCgpzZXQuc2VlZCgxMjMpCgpkYXRhX3dpZGUgJT4lCiAgc2xpY2Vfc2FtcGxlKG4gPSA2KQpgYGAKCjwvZGV0YWlscz4gCjwvZGV0YWlscz4KKioqCgpgYGB7cn0KZGF0YV93aWRlICU+JQogIGdsaW1wc2UoKQpgYGAKCk5pY2UsIGxvb2tzIGdvb2QhCgoKV2Ugd2lsbCBhbHNvIG1ha2UgYSBsb25nIHZlcnNpb24gb2YgdGhpcyBkYXRhLCB3aGVyZSB3ZSB3aWxsIGNyZWF0ZSBhbiBuZXcgdmFyaWFibGUgY2FsbGVkIGBJbmRpY2F0b3JgIHRoYXQgd2lsbCBpbmRpY2F0ZSB3aGF0IGRhdGFzZXQgdGhlIGRhdGEgY2FtZSBmcm9tLgoKIyMjIyB7LnJlY2FsbF9jb2RlX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRyeSB0byBjb21lIHVwIHdpdGggdGhlIGNvZGUgdG8gZG8gdGhpcy4KCiMjIyMKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgdG8gcmV2ZWFsIHRoZSBjb2RlLiA8L3N1bW1hcnk+CgoKYGBge3J9CmRhdGFfbG9uZyA8LSBkYXRhX3dpZGUgJT4lCiAgcGl2b3RfbG9uZ2VyKGNvbHMgPSBjKC1Db3VudHJ5LCAtWWVhciwgLUxhYmVsKSwKICAgICAgICAgICAgICAgbmFtZXNfdG8gPSAiSW5kaWNhdG9yIiwKICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gIlZhbHVlIikKYGBgCgo8L2RldGFpbHM+IAoqKioKCmBgYHtyfQpzZXQuc2VlZCgxMjMpCgpkYXRhX2xvbmcgJT4lCiAgc2xpY2Vfc2FtcGxlKG4gPSA2KQpgYGAKCgpXZSB3aWxsIG5vdyBjb21iaW5lIHRoaXMgZGF0YSB3aXRoIHRoZSBVUyBkYXRhIGFib3V0IGRpc2FzdGVycyBhbmQgdGVtcGVyYXR1cmVzLgoKCmBgYHtyfQp1c19kaXNhc3RlciAlPiUKICBzbGljZV9oZWFkKG4gPSA2KQp1c190ZW1wZXJhdHVyZSAlPiUKICBzbGljZV9oZWFkKG4gPSA2KQpgYGAKCldlIHdpbGwgbm93IHVzZSB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHdoaWNoIHdpbGwganVzdCBhcHBlbmQgdGhlIGB1c190ZW1wZXJhdHVyZWAgZGF0YSBhbmQgdGhlIGB1c19kaXNhc3RlcmAgZGF0YSBhZnRlciB0aGUgYGRhdGFfbG9uZ2AgZGF0YS4gCgpgYGB7cn0KZGF0YV9sb25nIDwtCiAgbGlzdChkYXRhX2xvbmcsIHVzX2Rpc2FzdGVyLCB1c190ZW1wZXJhdHVyZSkgJT4lCiAgYmluZF9yb3dzKCkgJT4lCiAgbXV0YXRlKENvdW50cnkgPSBhcy5mYWN0b3IoQ291bnRyeSkpCmBgYAoKV2UgYWxzbyBjb252ZXJ0ZWQgdGhlIGBDb3VudHJ5YCBjb2x1bW4gdG8gYSBmYWN0b3IgaW4gdGhlIGxhc3QgbGluZSBvZiB0aGUgY29kZSBjaHVuay4gCgpXZSBjYW4gY2hlY2sgdGhlIHRvcCBhbmQgYm90dG9tIG9mIHRoZSBuZXcgYGRhdGFfbG9uZ2AgdGliYmxlIHRvIHNlZSB0aGF0IG91ciBgdXNfdGVtcGVyYXR1cmVgIGRhdGEgaXMgYXQgdGhlIGJvdHRvbS4gVG8gc2VlIHRoZSBlbmQgb2Ygb3VyIHRpYmJsZSB3ZSBjYW4gdXNlIGBzbGljZV90YWlsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuCgpgYGB7cn0KZGF0YV9sb25nICU+JQogIHNsaWNlX2hlYWQobiA9IDYpCgpkYXRhX2xvbmcgJT4lCiAgc2xpY2VfdGFpbChuID0gNikKCnNldC5zZWVkKDEyMykKCmRhdGFfbG9uZyAlPiUKICBzbGljZV9zYW1wbGUobiA9IDEwKQpgYGAKCioqKgo8ZGV0YWlscz4gPHN1bW1hcnk+IENsaWNrIGhlcmUgZm9yIGRldGFpbHMgYWJvdXQgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBgZnVsbF9qb2luKClgIGFuZCBgYmluZF9yb3dzKClgIDwvc3VtbWFyeT4KClRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhpcyBmdW5jdGlvbiBhbmQgdGhlIGBmdWxsX2pvaW4oKWAgZnVuY3Rpb24gaXMgdGhhdCB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiB3aWxsIGVzc2VudGlhbGx5IGp1c3QgYXBwZW5kIGVhY2ggZGF0YXNldCB0byBlYWNoIG90aGVyLCB3aGVyZWFzIHRoZSBgZnVsbF9qb2luKClgIGZ1bmN0aW9uIGNvbGxhcHNlcyBkYXRhIHRoYXQgaXMgY29tcGFyYWJsZS4gCkhlcmUsIHlvdSB3aWxsIHNlZSBhbiBleGFtcGxlIG9mIHdoYXQgdGhlIGRhdGEgd291bGQgaGF2ZSBiZWVuIGxpa2UgZm9yIGBkYXRhX3dpZGVgIGlmIHdlIGhhZCBtYWRlIGl0IHVzaW5nIGBiaW5kX3Jvd3MoKWAgYW5kIGlmIGBmdWxsX2pvaW4oKWAgaGFkIGJlZW4gdXNlZCBidXQgd2FzIG5vdCBqb2luZWQgYnkgdGhlIGBMYWJlbGAgdmFyaWFibGUuClNpbmNlIHRoZSBgTGFiZWxgIHZhcmlhYmxlIGhhcyB1bmlxdWUgdmFsdWVzIGZvciBlYWNoIHR5cGUgb2YgYEluZGljYXRvcmAsIHRoaXMgY2F1c2VzIHRoZSBgZnVsbF9qb2luKClgIHJlc3VsdCB0byBiZSB0aGUgc2FtZSBhcyBgYmluZF9yb3dzKClgLiAKCkxldCdzIGNvbnNpZGVyIGFuIGV4YW1wbGUgYW5kIGxvb2sgYXQgdGhlIHZhbHVlcyBmb3IgQ2hpbmEgaW4gdGhlIHllYXIgb2YgMTk4MC4KCkZpcnN0IHdlIHdpbGwgdXNlIHRoZSBgYmluZF9yb3dzKClgIGZ1bmN0aW9uIHdoaWNoIGF1dG9tYXRpY2FsbHkgY3JlYXRlcyBgTkFgIHZhbHVlcyBmb3IgYW55IHZhcmlhYmxlIHRoYXQgaXMgbWlzc2luZyBmcm9tIGEgZGF0YSBvYmplY3QgdGhhdCBpcyBhZGRlZCBieSBjb21iaW5pbmcgdGhlIGRhdGEgb2JqZWN0IHdpdGggYW5vdGhlciB0aGF0IGNvbnRhaW5zIHRoYXQgbWlzc2luZyB2YXJpYWJsZSB1c2luZyB0aGlzIGZ1bmN0aW9uLgoKYGBge3J9CmRhdGFfd2lkZV9iciA8LQogIGxpc3QoQ08yX2VtaXNzaW9ucywgZ2RwX2dyb3d0aCwgZW5lcmd5X3VzZSkgJT4lCiAgYmluZF9yb3dzKCkKCmRhdGFfd2lkZV9iciAlPiUKIGZpbHRlcihDb3VudHJ5ID09ICJDaGluYSIsCiAgICAgICAgICAgWWVhciA9PSAxOTgwKQpgYGAKCldlIHNlZSB0aGF0IHdlIGhhdmUgdGhyZWUgcm93cyBvZiBkYXRhLgoKTm93IHdlIHdpbGwgdXNlIHRoZSBgZnVsbF9qb2luKClgIGZ1bmN0aW9uIHR3byB3YXlzLiBGaXJzdCB3ZSB3aWxsIGNvbWJpbmUgYnkgYENvdW50cnlgIGFuZCBgWWVhcmAgYW5kIGBMYWJlbGAuIAoKYGBge3J9CmRhdGFfd2lkZV9mal9sYWJlbCA8LQogIGxpc3QoQ08yX2VtaXNzaW9ucywgZ2RwX2dyb3d0aCwgZW5lcmd5X3VzZSkgJT4lCiAgcmVkdWNlKGZ1bGxfam9pbiwgYnkgPSBjKCJDb3VudHJ5IiwgIlllYXIiLCAiTGFiZWwiKSkKCmRhdGFfd2lkZV9mal9sYWJlbCAlPiUKICBmaWx0ZXIoQ291bnRyeSA9PSAiQ2hpbmEiLCBZZWFyID09ICIxOTgwIikKYGBgCgpBZ2FpbiB3ZSBoYXZlIDMgcm93cyBvZiBkYXRhLiBUaGUgZGF0YSBwcm9kdWNlZCBieSAgYGJpbmRfcm93cygpYCBhbmQgYGZ1bGxfam9pbigpYCBpcyBpZGVudGljYWwgKHdoaWNoIHdlIGNhbiBjaGVjayBieSB1c2luZyB0aGUgYHNldGVxdWFsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UpIGFuZCBoYXMgdGhlIHNhbWUgZGltZW5zaW9ucyAod2hpY2ggd2UgY2FuIGNoZWNrIGJ5IHVzaW5nIHRoZSBgZGltKClgIGJhc2UgZnVuY3Rpb24pLgoKYGBge3J9CmRpbShkYXRhX3dpZGVfYnIpCmRpbShkYXRhX3dpZGVfZmpfbGFiZWwpCnNldGVxdWFsKGRhdGFfd2lkZV9mal9sYWJlbCwgZGF0YV93aWRlX2JyKQpgYGAKCkhvd2V2ZXIsIG5vdyB3ZSB3aWxsIGpvaW4gYnkgb25seSBgQ291bnRyeWAgYW5kIGBZZWFyYDoKCmBgYHtyfQpkYXRhX3dpZGVfZmogPC0KICBsaXN0KENPMl9lbWlzc2lvbnMsIGdkcF9ncm93dGgsIGVuZXJneV91c2UpICU+JQogIHJlZHVjZShmdWxsX2pvaW4sIGJ5ID0gYygiQ291bnRyeSIsICJZZWFyIikpCgpkYXRhX3dpZGVfZmogJT4lCiAgZmlsdGVyKENvdW50cnkgPT0gIkNoaW5hIiwgWWVhciA9PSAiMTk4MCIpCmBgYAoKTm93IHdlIHNlZSB0aGF0IHdlIGhhdmUgb25seSBhIHNpbmdsZSByb3cuIFRoZSBkYXRhIHRoYXQgY29ycmVzcG9uZHMgdG8gdGhlIHNhbWUgeWVhciBhbmQgY291bnRyeSBoYXMgYmVlbiBjb2xsYXBzZWQgaW50byBhIHNpbmdsZSBidXQgd2lkZXIgcm93LiAKClRoaXMgaXMgc29tZXRoaW5nIHRvIGtlZXAgaW4gbWluZCB3aGVuIHlvdSBhcmUgd3JhbmdsaW5nIHlvdXIgZGF0YS4gVGhlIGNob2ljZSBvZiB3aGF0IGZ1bmN0aW9uIHRvIHVzZSBhbmQgaG93IHNob3VsZCBkZXBlbmQgb24gaG93IHlvdSB3YW50IHRoZSBkYXRhIHRvIGJlIGFmdGVyIHlvdSBjb21iaW5lIHRoZSBkaWZmZXJlbnQgc291cmNlcyBvZiBkYXRhIHRvZ2V0aGVyLgoKPC9kZXRhaWxzPiAgCioqKgoKV2UgaGF2ZSBhIGZldyBtb3JlIHRoaW5ncyB0byBkbyBiZWZvcmUgd2UgbGVhdmUgdGhlIGRhdGEgd3JhbmdsaW5nIHNlY3Rpb24uIAoKV2Ugd2lsbCBjcmVhdGUgYSBuZXcgdmFyaWFibGUgY2FsbGVkIGBSZWdpb25gIHRoYXQgd2lsbCBpbmRpY2F0ZSBpZiB0aGUgZGF0YSBpcyBhYm91dCB0aGUgVW5pdGVkIFN0YXRlcyBvciBhIGRpZmZlcmVudCBjb3VudHJ5IGJhc2VkIG9uIHRoZSB2YWx1ZXMgaW4gdGhlIGBDb3VudHJ5YCB2YXJpYWJsZS4gClRvIGRvIHRoaXMsIHdlIHdpbGwgdXNlIHRoZSBgY2FzZV93aGVuKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIAoKRm9yIGV4YW1wbGUsIGlmIHRoZSBgQ291bnRyeWAgdmFyaWFibGUgaXMgZXF1YWwgdG8gYCJVbml0ZWQgU3RhdGVzImAgdGhlIHZhbHVlIGZvciB0aGUgbmV3IHZhcmlhYmxlIHdpbGwgYWxzbyBiZSBgIlVuaXRlZCBTdGF0ZXMiYCwgd2hlcmUgYXMgaWYgdGhlIGBDb3VudHJ5YCB2YXJpYWJsZSBpcyBub3QgZXF1YWwgdG8gYCJVbml0ZWQgU3RhdGVzImAgYnV0IGlzIHNvbWUgb3RoZXIgY2hhcmFjdGVyIHN0cmluZyB2YWx1ZSwgc3VjaCBhcyBgIkFmZ2hhbmlzdGFuImAsIHRoZW4gdGhlIHZhbHVlIGZvciB0aGUgbmV3IHZhcmlhYmxlIHdpbGwgYmUgYCJSZXN0IG9mIHRoZSBXb3JsZCJgLiBXZSBjYW4gc3BlY2lmeSB0aGF0IHNvbWV0aGluZyBpcyBub3QgZXF1YWwgYnkgdXNpbmcgdGhlIGAhPWAgb3BlcmF0b3IuCgpUaGUgbmV3IHZhbHVlcyBmb3IgdGhlIG5ldyB2YXJpYWJsZSBgUmVnaW9uYCBhcmUgaW5kaWNhdGVkIGFmdGVyIHRoZSBzcGVjaWZpYyBjb25kaXRpb25hbCBzdGF0ZW1lbnRzIGJ5IHVzaW5nIHRoZSBgfmAgc3ltYm9sLiAKCgpgYGB7cn0KZGF0YV9sb25nICU8PiUKICBtdXRhdGUoUmVnaW9uID0gY2FzZV93aGVuKENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMiIH4gIlVuaXRlZCBTdGF0ZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRyeSAhPSAiVW5pdGVkIFN0YXRlcyIgfiAiUmVzdCBvZiB0aGUgV29ybGQiKSkKCmRhdGFfbG9uZyAgJT4lCiAgYXJyYW5nZShDb3VudHJ5KSAlPiUKICBzbGljZV9oZWFkKG4gPSA2KQpgYGAKCldlIGNhbiBhbHNvIHJlbW92ZSByb3dzIGZvciBjb3VudHJpZXMgd2l0aCBgTkFgIHZhbHVlcyB1c2luZyB0aGUgYGRyb3BfbmEoKWAgZnVuY3Rpb24gb2YgdGhlIGB0aWR5cmAgcGFja2FnZSB0byBkcm9wIGFsbCB5ZWFycyB3aXRoIG1pc3NpbmcgZGF0YS4KCmBgYHtyfQpkYXRhX2xvbmdfd2l0aF9taXNzIDwtCiAgZGF0YV9sb25nICU+JQogIGFycmFuZ2UoQ291bnRyeSkKCmRhdGFfbG9uZyAlPD4lCiAgZHJvcF9uYSgpICU+JQogIGFycmFuZ2UoQ291bnRyeSkKYGBgCgpZb3UgY2FuIHNlZSB0aGF0IGJ5IHJlbW92aW5nIHRoZSBOQSB2YWx1ZXMgdGhlIGRhdGEgZm9yIEFmZ2hhbmlzdGFuIHN0YXJ0cyBhdCAxOTQ5IGluc3RlYWQgb2YgMTc1MS4KCmBgYHtyfQpkYXRhX2xvbmcgJT4lCiAgc2xpY2VfaGVhZChuID0gNikKYGBgCgojIyMjIHsucmVjYWxsX2NvZGVfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKVXNpbmcgb25seSBkYXRhIGZyb20gdGhlIFVTLCBjYWxjdWxhdGUgdGhlIGZpcnN0IGFuZCBsYXN0IHllYXIgdGhhdCBhIHZhbHVlIHdhcyByZXBvcnRlZCBmb3IgZWFjaCB2YXJpYWJsZSAoZS5nLiBDTzIgZW1pc3Npb25zLCBlbmVyZ3kgdXNlLCBldGMpLiAKCjxiPjx1PiBIaW50IDwvdT48L2I+OiBVc2UgdGhlIGBncm91cF9ieSgpYCBhbmQgYHN1bW1hcml6ZSgpYCBmdW5jdGlvbnMgaW4gdGhlIGBkcGx5cmAgcGFja2FnZS4gCgojIyMjCgpUbyBhbGxvdyB1c2VycyB0byBza2lwIGltcG9ydCBhbmQgd3JhbmdsaW5nIHdlIHdpbGwgc2F2ZSB0aGUgZGF0YSBhcyBhbiBSREEgZmlsZSBhcyB3ZWxsIGFzIGEgQ1NWIGZpbGUgYXMgdGhpcyBpcyBvZnRlbiB1c2VmdWwgdG8gc2VuZCBvdXIgZGF0YSB0byBjb2xsYWJvcmF0b3JzLiBXZSB3aWxsIHNhdmUgdGhpcyBpbiBhICJ3cmFuZ2xlZCIgc3ViZGlyZWN0b3J5IG9mIG91ciAiZGF0YSIgZGlyZWN0b3J5IG9mIG91ciB3b3JraW5nIGRpcmVjdG9yeS4KCmBgYHtyLCBldmFsID0gRkFMU0V9CnNhdmUoZGF0YV9sb25nLCBmaWxlID0gaGVyZTo6aGVyZSgiZGF0YSIsICJ3cmFuZ2xlZCIsICJ3cmFuZ2xlZF9kYXRhLnJkYSIpKQpyZWFkcjo6d3JpdGVfY3N2KGRhdGFfbG9uZywgcGF0aCA9IGhlcmU6OmhlcmUoImRhdGEiLCJ3cmFuZ2xlZCIsICJ3cmFuZ2xlZF9kYXRhLmNzdiIpKQpgYGAKCgojICoqRGF0YSBWaXN1YWxpemF0aW9uKioKKioqIAoKSWYgeW91IGhhdmUgYmVlbiBmb2xsb3dpbmcgYWxvbmcgYnV0IHN0b3BwZWQsIHdlIGNvdWxkIGxvYWQgb3VyIHdyYW5nbGVkIGRhdGEgbGlrZSBzbzoKCmBgYHtyfQpsb2FkKGhlcmU6OmhlcmUoImRhdGEiLCAid3JhbmdsZWQiLCAid3JhbmdsZWRfZGF0YS5yZGEiKSkKYGBgCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBJZiB5b3Ugc2tpcHBlZCB0aGUgZGF0YSB3cmFuZ2xpbmcgc2VjdGlvbiBjbGljayBoZXJlLiA8L3N1bW1hcnk+CgpGaXJzdCB5b3UgbmVlZCB0byBpbnN0YWxsIGFuZCBsb2FkIHRoZSBgT0NTZGF0YWAgcGFja2FnZToKCmBgYHtyLCBldmFsPUZBTFNFfQppbnN0YWxsLnBhY2thZ2VzKCJPQ1NkYXRhIikKbGlicmFyeShPQ1NkYXRhKQpgYGAKClRoZW4sIHlvdSBtYXkgbG9hZCB0aGUgd3JhbmdsZWQgZGF0YSB1c2luZyB0aGUgZm9sbG93aW5nIGNvZGU6CgpgYGB7ciwgZXZhbD1GQUxTRX0Kd3JhbmdsZWRfcmRhKCJvY3MtYnAtY28yLWVtaXNzaW9ucyIsIG91dHBhdGggPSBnZXR3ZCgpKQpsb2FkKGhlcmU6OmhlcmUoIk9DU2RhdGEiLCAiZGF0YSIsICJ3cmFuZ2xlZCIsICJ3cmFuZ2xlZF9kYXRhLnJkYSIpKQpgYGAKCklmIHRoZSBwYWNrYWdlIGRvZXMgbm90IHdvcmsgZm9yIHlvdSwgYWx0ZXJuYXRpdmVseSwgYW4gUkRBIGZpbGUgKHN0YW5kcyBmb3IgUiBkYXRhKSBvZiB0aGUgZGF0YSBjYW4gYmUgZm91bmQgW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS8vb3BlbmNhc2VzdHVkaWVzL29jcy1icC1jbzItZW1pc3Npb25zL3RyZWUvbWFzdGVyL2RhdGEvd3JhbmdsZWQpIG9yIHNsaWdodGx5IG1vcmUgZGlyZWN0bHkgW2hlcmVdKGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9vcGVuY2FzZXN0dWRpZXMvb2NzLWJwLWNvMi1lbWlzc2lvbnMvbWFzdGVyL2RhdGEvd3JhbmdsZWQvd3JhbmdsZWRfZGF0YS5yZGEpLiBEb3dubG9hZCB0aGlzIGZpbGUgYW5kIHRoZW4gcGxhY2UgaXQgaW4geW91ciBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IHdpdGhpbiBhIHN1YmRpcmVjdG9yeSBjYWxsZWQgIndyYW5nbGVkIiB3aXRoaW4gYSBzdWJkaXJlY3RvcnkgY2FsbGVkICJkYXRhIiB0byBjb3B5IGFuZCBwYXN0ZSBvdXIgY29kZS4gV2UgdXNlZCBhbiBSU3R1ZGlvIHByb2plY3QgYW5kIHRoZSBbYGhlcmVgIHBhY2thZ2VdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSkgdG8gbmF2aWdhdGUgdG8gdGhlIGZpbGUgbW9yZSBlYXNpbHkuCgpgYGB7cn0KbG9hZChoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkIiwgIndyYW5nbGVkX2RhdGEucmRhIikpCmBgYAoKKioqCjxkZXRhaWxzPiA8c3VtbWFyeT4gQ2xpY2sgaGVyZSB0byBzZWUgbW9yZSBhYm91dCBjcmVhdGluZyBuZXcgcHJvamVjdHMgaW4gUlN0dWRpby4gPC9zdW1tYXJ5PgoKWW91IGNhbiBjcmVhdGUgYSBwcm9qZWN0IGJ5IGdvaW5nIHRvIHRoZSBGaWxlIG1lbnUgb2YgUlN0dWRpbyBsaWtlIHNvOgoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iNjAlIn0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgIk5ld19wcm9qZWN0LnBuZyIpKQpgYGAKCllvdSBjYW4gYWxzbyBkbyBzbyBieSBjbGlja2luZyB0aGUgcHJvamVjdCBidXR0b246CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjYwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJwcm9qZWN0X2J1dHRvbi5wbmciKSkKYGBgCgpTZWUgW2hlcmVdKGh0dHBzOi8vc3VwcG9ydC5yc3R1ZGlvLmNvbS9oYy9lbi11cy9hcnRpY2xlcy8yMDA1MjYyMDctVXNpbmctUHJvamVjdHMpIHRvIGxlYXJuIG1vcmUgYWJvdXQgdXNpbmcgUlN0dWRpbyBwcm9qZWN0cyBhbmQgW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSkgdG8gbGVhcm4gbW9yZSBhYm91dCB0aGUgYGhlcmVgIHBhY2thZ2UuCgo8L2RldGFpbHM+CioqKgoKPC9kZXRhaWxzPgoqKioKCk5vdyB3ZSB3aWxsIGNyZWF0ZSBzb21lIHNpbXBsZSBwbG90cyB0byBleGFtaW5lIHRoZSBDTzIgZW1pc3Npb25zIG92ZXIgdGltZSB1c2luZyB0aGUgYGdncGxvdDJgIHBhY2thZ2UuCgpBcyB5b3UgbWF5IGhhdmUgYWxyZWFkeSBzZWVuLCB0aGVyZSBhcmUgbWFueSBmdW5jdGlvbnMgYXZhaWxhYmxlIGluIGJhc2UgUiB0aGF0IGNhbiBjcmVhdGUgcGxvdHMgKGUuZy4gYHBsb3QoKWAsIGBib3hwbG90KClgKS4gCk90aGVycyBpbmNsdWRlOiBgaGlzdCgpYCwgYHFxcGxvdCgpYCwgZXRjLiAKVGhlc2UgZnVuY3Rpb25zIGFyZSBncmVhdCBiZWNhdXNlIHRoZXkgY29tZSB3aXRoIGEgYmFzaWMgaW5zdGFsbGF0aW9uIG9mIFIgYW5kIGNhbiBiZSBxdWl0ZSBwb3dlcmZ1bCB3aGVuIHlvdSBuZWVkIGEgcXVpY2sgdmlzdWFsaXphdGlvbiBvZiBzb21ldGhpbmcgd2hlbiB5b3UgYXJlIGV4cGxvcmluZyBkYXRhLiAKCldlIGFyZSBjaG9vc2luZyB0byBpbnRyb2R1Y2UgYGdncGxvdDJgIGJlY2F1c2UsIGluIG91ciBvcGluaW9uLCBpdCBpcyBvbmUgb2YgdGhlIHNpbXBsZXN0IHdheXMgZm9yIGJlZ2lubmVycyB0byBjcmVhdGUgcmVsYXRpdmVseSBjb21wbGljYXRlZCBwbG90cyB0aGF0IGFyZSBpbnR1aXRpdmUgYW5kIGFlc3RoZXRpY2FsbHkgcGxlYXNpbmcuIAoKIyMgKipUaGUgYGdncGxvdDJgIFIgcGFja2FnZSoqCioqKgoKVGhlIHJlYXNvbnMgW2BnZ3Bsb3QyYF0oaHR0cDovL2dncGxvdDIudGlkeXZlcnNlLm9yZykgaXMgZ2VuZXJhbGx5IGludHVpdGl2ZSBmb3IgYmVnaW5uZXJzIGlzIHRoZSB1c2Ugb2YgW2dyYW1tYXIgb2YgZ3JhcGhpY3NdKGh0dHA6Ly92aXRhLmhhZC5jby5uei9wYXBlcnMvbGF5ZXJlZC1ncmFtbWFyLmh0bWwpIG9yIHRoZSBgZ2dgIGluIGBnZ3Bsb3QyYC4gClRoZSBpZGVhIGlzIHRoYXQgeW91IGNhbiBjb25zdHJ1Y3QgbWFueSBzZW50ZW5jZXMgYnkgbGVhcm5pbmcganVzdCBhIGZldyBub3VucywgYWRqZWN0aXZlcywgYW5kIHZlcmJzLiAKVGhlcmUgYXJlIHNwZWNpZmljICJ3b3JkcyIgdGhhdCB3ZSB3aWxsIGludHJvZHVjZSwgYW5kIG9uY2UgeW91IGFyZSBjb21mb3J0YWJsZSB3aXRoIHRoZW0sIHlvdSB3aWxsIGJlIGFibGUgdG8gY3JlYXRlIChvciAid3JpdGUiKSBodW5kcmVkcyBvZiBkaWZmZXJlbnQgcGxvdHMuIAoKVGhlIGNyaXRpY2FsIHBhcnQgdG8gbWFraW5nIGdyYXBoaWNzIHVzaW5nIGBnZ3Bsb3QyYCBpcyB0aGUgZGF0YSBuZWVkcyB0byBiZSBpbiBhIF90aWR5XyBmb3JtYXQuIApHaXZlbiB0aGF0IHdlIGhhdmUganVzdCBzcGVudCB0aW1lIHB1dHRpbmcgb3VyIGRhdGEgaW4gX3RpZHlfIGZvcm1hdCwgd2UgYXJlIHByaW1lZCB0byB0YWtlIGFkdmFudGFnZSBvZiBhbGwgdGhhdCBgZ2dwbG90MmAgaGFzIHRvIG9mZmVyISAKCldlIHdpbGwgc2hvdyBob3cgaXQgaXMgZWFzeSB0byBwaXBlIF90aWR5XyBkYXRhIChvdXRwdXQpIGFzIGlucHV0IHRvIG90aGVyIGZ1bmN0aW9ucyB0aGF0IGNyZWF0ZSBwbG90cy4gClRoaXMgYWxsIHdvcmtzIGJlY2F1c2Ugd2UgYXJlIHdvcmtpbmcgCndpdGhpbiB0aGUgX3RpZHl2ZXJzZV8uIAoKIyMjIyBXaGF0IGlzIHRoZSBgZ2dwbG90KClgIGZ1bmN0aW9uPyAKCkFzIGV4cGxhaW5lZCBieSBIYWRsZXkgV2lja2hhbTogCgo+IHRoZSBncmFtbWFyIHRlbGxzIHVzIHRoYXQgYSBzdGF0aXN0aWNhbCBncmFwaGljIGlzIGEgbWFwcGluZyBmcm9tIGRhdGEgdG8gYWVzdGhldGljIGF0dHJpYnV0ZXMgKGNvbG91ciwgc2hhcGUsIHNpemUpIG9mIGdlb21ldHJpYyBvYmplY3RzIChwb2ludHMsIGxpbmVzLCBiYXJzKS4gVGhlIHBsb3QgbWF5IGFsc28gY29udGFpbiBzdGF0aXN0aWNhbCB0cmFuc2Zvcm1hdGlvbnMgb2YgdGhlIGRhdGEgYW5kIGlzIGRyYXduIG9uIGEgc3BlY2lmaWMgY29vcmRpbmF0ZXMgc3lzdGVtLgoKIyMjIyBgZ2dwbG90MmAgVGVybWlub2xvZ3kgCgoqICoqZ2dwbG90KiogLSB0aGUgbWFpbiBmdW5jdGlvbiB3aGVyZSB5b3Ugc3BlY2lmeSB0aGUgZGF0YXNldCBhbmQgdmFyaWFibGVzIHRvIHBsb3QgKHRoaXMgaXMgd2hlcmUgd2UgZGVmaW5lIHRoZSBgeGAgYW5kCmB5YCB2YXJpYWJsZSBuYW1lcykKKiAqKmdlb21zKiogLSBnZW9tZXRyaWMgb2JqZWN0cwogICAgKiBlLmcuIGBnZW9tX3BvaW50KClgLCBgZ2VvbV9iYXIoKWAsIGBnZW9tX2xpbmUoKWAsIGBnZW9tX2hpc3RvZ3JhbSgpYAoqICoqYWVzKiogLSBhZXN0aGV0aWNzCiAgICAqIHNoYXBlLCB0cmFuc3BhcmVuY3ksIGNvbG9yLCBmaWxsLCBsaW5lIHR5cGVzCiogKipzY2FsZXMqKiAtIGRlZmluZSBob3cgeW91ciBkYXRhIHdpbGwgYmUgcGxvdHRlZAogICAgKiBjb250aW51b3VzLCBkaXNjcmV0ZSwgbG9nLCBldGMKClRoZSBmdW5jdGlvbiBgYWVzKClgIGlzIGFuIGFlc3RoZXRpYyBtYXBwaW5nIGZ1bmN0aW9uIGluc2lkZSB0aGUgYGdncGxvdCgpYCBvYmplY3QuIApXZSB1c2UgdGhpcyBmdW5jdGlvbiB0byBzcGVjaWZ5IHBsb3QgYXR0cmlidXRlcyAoZS5nLiBgeGAgYW5kIGB5YCB2YXJpYWJsZSBuYW1lcykgdGhhdCB3aWxsIG5vdCBjaGFuZ2UgYXMgd2UgYWRkIG1vcmUgbGF5ZXJzLiAgCgpBbnl0aGluZyB0aGF0IGdvZXMgaW4gdGhlIGBnZ3Bsb3QoKWAgb2JqZWN0IGJlY29tZXMgYSBnbG9iYWwgc2V0dGluZy4gCkZyb20gdGhlcmUsIHdlIHVzZSB0aGUgYGdlb21gIG9iamVjdHMgdG8gYWRkIG1vcmUgbGF5ZXJzIHRvIHRoZSBiYXNlIGBnZ3Bsb3QoKWAgb2JqZWN0LiAKVGhlc2Ugd2lsbCBkZWZpbmUgd2hhdCB3ZSBhcmUgaW50ZXJlc3RlZCBpbiBpbGx1c3RyYXRpbmcgdXNpbmcgdGhlIGRhdGEuICAKCiMjICoqQ08yIEVtaXNzaW9ucyoqCgpMZXQncyBzdGFydCBieSBwbG90dGluZyB0aGUgQ08yIGVtaXNzaW9ucyBvdmVyIHRpbWUuIApCZWNhdXNlIG91ciBkYXRhc2V0IGNvbnRhaW5zIG90aGVyIHZhcmlhYmxlcywgd2UgZmlyc3QgbmVlZCB0byBmaWx0ZXIgb3VyIGRhdGEgdG8gb25seSBpbmNsdWRlIHRoZSBDTzIgZW1pc3Npb25zIGRhdGEgYnkgdXNpbmcgdGhlIGBmaWx0ZXIoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4gClRvIHVzZSB0aGlzIGZ1bmN0aW9uIHdlIG5lZWQgdG8gc3BlY2lmeSB3aGF0IHZhbHVlIChlLmcuIGBFbWlzc2lvbnNgKSB3ZSB3YW50IGZvciBhIGdpdmVuIHZhcmlhYmxlIG9yIGNvbHVtbiAoZS5nLiBgSW5kaWNhdG9yYCkuICAKCkluIHRoaXMgY2FzZSwgd2UgZmlsdGVyIHRvIGtlZXAgYWxsIHJvd3Mgd2hlcmUgdGhlIGBJbmRpY2F0b3JgIHZhcmlhYmxlIGlzIGVxdWFsIHRvIHRoZSB3b3JkIGBFbWlzc2lvbnNgLiAKTm90aWNlIHRoYXQgdGhpcyBuZWVkcyB0byBiZSBpbiBxdW90ZXMsIHdoaWxlIHRoZSB2YXJpYWJsZSBuYW1lIGRvZXMgbm90LgoKYGBge3J9CmRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKQpgYGAKCldlIGFsc28gbmVlZCB0byBzdW0gdGhlIGVtaXNzaW9ucyBhY3Jvc3MgY291bnRyaWVzIGZvciBlYWNoIHllYXIuIApIZXJlLCB3ZSB1c2UgdGhlIGBncm91cF9ieSgpYCBhbmQgYHN1bW1hcml6ZSgpYCBmdW5jdGlvbiB0aGF0IHdlIHByZXZpb3VzbHkgbGVhcm5lZCBhYm91dC4gCgpgYGB7cn0KZGF0YV9sb25nICU+JQogIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogIGdyb3VwX2J5KFllYXIpICU+JQogIHN1bW1hcml6ZShFbWlzc2lvbnMgPSBzdW0oVmFsdWUpKQpgYGAKClRoZW4sIHdlIHVzZSB0aGUgYGFlcygpYCBhcmd1bWVudCBvZiB0aGUgYGdncGxvdCgpYCBmdW5jdGlvbiB0byBkZWZpbmUgdGhhdCBvdXIgeC1heGlzIHdpbGwgYmUgdGhlIGBZZWFyYCB2YXJpYWJsZSwgdGhlIHktYXhpcyB3aWxsIGJlIHRoZSBlbWlzc2lvbiBgVmFsdWVgIHZhcmlhYmxlLCBhbmQgdGhhdCBvdXIgZGF0YSBzaG91bGQgYmUgZ3JvdXBlZCBvciBzZXBhcmF0ZWQgYnkgdGhlIGBDb3VudHJ5YCB2YXJpYWJsZS4gCgpgYGB7cn0KZGF0YV9sb25nICU+JQogIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogIGdyb3VwX2J5KFllYXIpICU+JQogIHN1bW1hcml6ZShFbWlzc2lvbnMgPSBzdW0oVmFsdWUpKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gRW1pc3Npb25zKSkKYGBgCgpMb29rcyBsaWtlIHdlIGdvdCBhIGJsYW5rIHBsb3QuIApXaGF0IGhhcHBlbmVkPyAKV2UgbmVlZCB0byB0ZWxsIFIgd2hhdCBfdHlwZSBvZiBwbG90XyB3ZSB3YW50LiAKVG8gZG8gdGhhdCwgd2UgbmVlZCB0byBhZGQgYW5vdGhlciBsYXllciB0byBkZWZpbmUgaG93IHdlIHdhbnQgdGhlIHBsb3QgdG8gbG9vay4gCldlIGRvIHNvIGJ5IHVzaW5nIHRoZSBgK2Agc2lnbiBpbiBiZXR3ZWVuIGVhY2ggY29tbWFuZC4gCgojIyMgTGluZSBwbG90cwoKVG8gdGVsbCBSIHdoYXQgdHlwZSBvZiBwbG90IHdlIHdhbnQsIHdlIG5lZWQgdG8gYWRkIGFub3RoZXIgX2xheWVyXyB0byBvdXIgZ2dwbG90IG9iamVjdC4gClRvIGFkZCBhIHR5cGUgb2YgcGxvdCwgd2UgY2FuIHVzZSBvbmUgb2YgdGhlIG1hbnkgYGdlb21fKmAgZnVuY3Rpb25zIGluIGBnZ3Bsb3QyYC4KRm9yIGV4YW1wbGUsIHR5cGUgYGdlb21gIGludG8gdGhlIFJTdHVkaW8gY29uc29sZSBhbmQgeW91IHdpbGwgc2VlIG1hbnkgb3B0aW9ucyB0byBzY3JvbGwgdGhyb3VnaC4KCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aCA9ICI4MDAgcHgifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiZ2VvbV8ucG5nIikpCmBgYAoKSGVyZSwgd2Ugd2lsbCB1c2UgdGhlIGBnZW9tX2xpbmUoKWAgZnVuY3Rpb24gYmVjYXVzZSB3ZSB3b3VsZCBsaWtlIHRvIGNyZWF0ZSBhIGxpbmUgcGxvdC4KV2UgYWxzbyB1c2UgdGhlIGBzaXplYCBhcmd1bWVudCBpbiBgZ2VvbV9saW5lKClgIHRvIGNvbnRyb2wgdGhlIHNpemUgb2YgdGhlIGxpbmUuIAoKYGBge3J9CmRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICBncm91cF9ieShZZWFyKSAlPiUKICBzdW1tYXJpemUoRW1pc3Npb25zID0gc3VtKFZhbHVlKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEVtaXNzaW9ucykpICsKICAgIGdlb21fbGluZShzaXplID0gMS41KQpgYGAKCldvdywgdGhlIENPMiBpcyByZWFsbHkgcmlzaW5nIHNoYXJwbHkhCgpGaW5hbGx5LCBsZXQncyBtYWtlIHRoaXMgcGxvdCByZWFsbHkgbmljZSBieSBhZGRpbmcgYSBmZXcgZmluYWwgdG91Y2hlcy4gClRvIGNoYW5nZSB0aXRsZSwgY2FwdGlvbiwgYW5kIHRoZSBheGlzIGxhYmVscywgd2UgY2FuIHVzZSB0aGUgYGxhYnMoKWAgZnVuY3Rpb24uIApBZ2Fpbiwgbm90aWNlIHRoYXQgYSBwbHVzIHNpZ24gaXMgdXNlZCBiZXR3ZWVuIGVhY2ggbGF5ZXIgdGhhdCB3ZSBhZGQgdG8gdGhlIHBsb3QuIApUbyBtYWtlIENPMiBhcHBlYXIgd2l0aCBhIHN1YnNjcmlwdCB3ZSBjYW4gdXNlIGB+Q09bMl1+YC4gIAoKYGBge3J9CmRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICBncm91cF9ieShZZWFyKSAlPiUKICBzdW1tYXJpemUoRW1pc3Npb25zID0gc3VtKFZhbHVlKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEVtaXNzaW9ucykpICsKICAgIGdlb21fbGluZShzaXplID0gMS41KSArCiAgICBsYWJzKHRpdGxlID0gIldvcmxkICIgfkNPWzJdfiAiIEVtaXNzaW9ucyBwZXIgWWVhciAoMTc1MS0yMDE0KSIsCiAgICAgICAgIGNhcHRpb24gPSAiTGltaXRlZCB0byByZXBvcnRpbmcgY291bnRyaWVzIiwKICAgICAgICAgeSA9ICJFbWlzc2lvbnMgKE1ldHJpYyBUb25uZXMpIikKYGBgCgpOZXh0LCB3ZSB1c2UgdGhlIGB0aGVtZSgpYCBmdW5jdGlvbiB0byBjaGFuZ2UgdGhlIGZvbnQgc2l6ZSBvZiB0aGUgeC1heGlzLCB5LWF4aXMsIGF4aXMgdGl0bGVzLCBhbmQgdGhlIGNhcHRpb24gYXMgc2hvd24gYmVsb3cuIApUbyBrbm93IHdoYXQgdG8gY2FsbCBlYWNoIGVsZW1lbnQgb2YgdGhlIHBsb3QgaW4gdGhpcyBmdW5jdGlvbiB0byBjaGFuZ2UgdGhlIHNpemUgdHlwZSBgP3RoZW1lKClgIGluIHRoZSBjb25zb2xlLiAKCllvdSB3aWxsIHNlZSBhIHZlcnkgbGFyZ2UgbGlzdCB0aGF0IGluY2x1ZGVzIG90aGVyIHBsb3QgYXNwZWN0cyBsaWtlIHRoZSBiYWNrZ3JvdW5kIGFuZCB0aGUgbGVnZW5kLiAKVGhpcyBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBtb2RpZnkgeW91ciBwbG90IHRvIHlvdXIgc3BlY2lmaWNhdGlvbnMuIAoKYGBge3J9CmRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICBncm91cF9ieShZZWFyKSAlPiUKICBzdW1tYXJpemUoRW1pc3Npb25zID0gc3VtKFZhbHVlKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEVtaXNzaW9ucykpICsKICAgIGdlb21fbGluZShzaXplID0gMS41KSArCiAgICBsYWJzKHRpdGxlID0gIldvcmxkICIgfkNPWzJdfiAiIEVtaXNzaW9ucyBwZXIgWWVhciAoMTc1MS0yMDE0KSIsCiAgICAgICAgIGNhcHRpb24gPSAiTGltaXRlZCB0byByZXBvcnRpbmcgY291bnRyaWVzIiwKICAgICAgICAgeSA9ICJFbWlzc2lvbnMgKE1ldHJpYyBUb25uZXMpIikgKwogIHRoZW1lX2xpbmVkcmF3KCkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICBwbG90LmNhcHRpb24gPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTYpKQpgYGAKCldlIGNhbiBjbGVhcmx5IHNlZSB0aGF0IGdsb2JhbCBDTzIgZW1pc3Npb25zIGhhdmUgZHJhbWF0aWNhbGx5IHJpc2VuIHNpbmNlIDE5MDAuCgpOb3RpY2UsIHdlIHVzZWQgdGhlIGZ1bmN0aW9uIGB0aGVtZV9saW5lZHJhdygpYCBvZiBgZ2dwbG90MmAgdG8gY2hhbmdlIHRoZSBnZW5lcmFsIGFwcGVhcmFuY2Ugb2YgdGhlIHBsb3QuIAoKKipVc2VmdWwgdGlwKio6IFlvdSBjYW4gdHlwZSBgdGhlbWVfYCBpbiB0aGUgUlN0dWRpbyBjb25zb2xlIHRvIHNlZSB0aGUgdmFyaW91cyBwbG90IHRoZW1lIG9wdGlvbnMgYXZhaWxhYmxlLgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjgwMCBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJ0aGVtZXMucG5nIikpCmBgYAoKR3JlYXQhIFdlJ3ZlIGNyZWF0ZWQgb3VyIGZpcnN0IHBsb3QuIAoKQmVmb3JlIHdlIGxlYXZlIHRoaXMgc2VjdGlvbiwgbGV0J3Mgc2F2ZSB0aGlzIHRoZW1lIHNvIHdlIGRvIG5vdCBoYXZlIHRvIGtlZXAgdHlwaW5nIHRoZSBzYW1lIGNvZGUgaW4gZnV0dXJlIHBsb3RzLiAKCmBgYHtyfQpteV90aGVtZSA8LQogIHRoZW1lX2xpbmVkcmF3KCkgKwogIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICBwbG90LmNhcHRpb24gPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTYpKQpgYGAKCkluIHRoaXMgd2F5LCB3ZSBjYW4ganVzdCBhZGQgYW5vdGhlciBfbGF5ZXJfIHRvIG91ciBwbG90IHdpdGggdGhlIGBteV90aGVtZWAgd2UgY3JlYXRlZCB3aXRoIHRoZSBzcGVjaWZpY2F0aW9ucyBvZiB0aGUgc2l6ZXMgb2YgdGhlIHRpdGxlIGFuZCBheGlzIGxhYmVscy4gCgpgYGB7cn0KQ08yX3dvcmxkIDwtCiAgZGF0YV9sb25nICU+JQogIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogIGdyb3VwX2J5KFllYXIpICU+JQogIHN1bW1hcml6ZShFbWlzc2lvbnMgPSBzdW0oVmFsdWUpKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gRW1pc3Npb25zKSkgKwogICAgZ2VvbV9saW5lKHNpemUgPSAxLjUpICsKICAgIGxhYnModGl0bGUgPSAiV29ybGQgIiB+Q09bMl1+ICIgRW1pc3Npb25zIHBlciBZZWFyICgxNzUxLTIwMTQpIiwKICAgICAgICAgY2FwdGlvbiA9ICJMaW1pdGVkIHRvIHJlcG9ydGluZyBjb3VudHJpZXMiLAogICAgICAgICB5ID0gIkVtaXNzaW9ucyAoTWV0cmljIFRvbm5lcykiKSArCiAgbXlfdGhlbWUKYGBgCgpXZSBhcmUgYWxzbyBzYXZpbmcgdGhlIHBsb3QgdG8gYW4gb2JqZWN0IGNhbGxlZCBgQ08yX3dvcmxkYC4gClRvIHNob3cgdGhlIHBsb3Qgd2Ugc2ltcGx5IHR5cGUgdGhlIG5hbWUgb2YgdGhlIG9iamVjdDogCgpgYGB7cn0KQ08yX3dvcmxkCmBgYApOb3cgbGV0J3Mgc2F5IHdlIHdhbnRlZCB0byBzYXZlIHRoaXMgcGxvdC4KCldlIGNvdWxkIGRvIHNvIHVzaW5nIHRoZSB1c2luZyB0aGUgIGBzYXZlKClgIGZ1bmN0aW9uIHRvIHNhdmUgdGhpcyB0byBhICJwbG90IiBkaXJlY3RvcnkgaW4gb3VyIHdvcmtpbmcgZGlyZWN0b3J5IGFzIGFuIFJEQSBmaWxlIGFuZCB3ZSBjYW4gdXNlIHRoZSBgcG5nKClgIGZ1bmN0aW9uIHRvIHNhdmUgYSBwbmcgZm9yIGNvbGxhYm9yYXRvcnMuIFdlIG5lZWQgdG8gdXNlIGBkZXYub2ZmKClgIGZ1bmN0aW9uIHRvIGNsb3NlIHRoZSBncmFwaGljYWwgZGV2aWNlIHRoYXQgd2Ugd2lsbCB1c2UgdG8gY3JlYXRlIHRoZSBwbmcgdmVyc2lvbiBvZiB0aGUgcGxvdCBzbyB0aGF0IHdlIGFyZSByZWFkeSB0byBtYWtlIGFub3RoZXIgcGxvdCBsaWtlIHRoaXMuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpzYXZlKENPMl93b3JsZCwgZmlsZSA9aGVyZTo6aGVyZSgicGxvdHMiLCAiQ08yX3dvcmxkLnJkYSIpKQpwbmcoaGVyZTo6aGVyZSgicGxvdHMiLCAiQ08yX3dvcmxkLnBuZyIpKQpDTzJfd29ybGQKZGV2Lm9mZigpCmBgYAoKCk9uZSB0aGluZyB0aGF0IHdvdWxkIGJlIG5pY2UgdG8ga25vdyBpcyB3aGljaCBjb3VudHJpZXMgYXJlIGNvbnRyaWJ1dGluZyB0aGUgbW9zdCBvciB0aGUgbGVhc3QgdG8gQ08yIGVtaXNzaW9ucy4gCkxldCdzIGNvbnRpbnVlIHRvIGV4cGxvcmUgdGhlIGRhdGEgdG8gaW52ZXN0aWdhdGUgaG93IENPMiBlbWlzc2lvbnMgZnJvbSBpbmRpdmlkdWFsIGNvdW50cmllcyBoYXZlIGNoYW5nZWQgb3ZlciB0aW1lLiAKCk5leHQsIHdlIGdvIGJhY2sgdG8gdXNpbmcgb3VyIGBkYXRhX2xvbmdgIGRhdGFzZXQuIApIZXJlLCB3ZSB1c2UgdGhlIGBncm91cGAgYXJndW1lbnQgaW4gYGFlcygpYCB3aGljaCBjb250cm9scyB3aGV0aGVyIGEgbGluZSBzaG91bGQgYmUgZHJhd24gCgpgYGB7cn0KZGF0YV9sb25nICU+JQogIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBWYWx1ZSwgZ3JvdXAgPSBDb3VudHJ5KSkgKwogIGdlb21fbGluZSgpICsKICB5bGFiKCJFbWlzc2lvbnMiKSArCiAgbXlfdGhlbWUKYGBgCgpXZSBjYW4gc2VlIHRoYXQgbWFueSBjb3VudHJpZXMgc2hvdyBhIGRyYW1hdGljIGluY3JlYXNlIGluIGVtaXNzaW9ucyBvdmVyIHRpbWUgd2l0aCBhIGhhbmRmdWwgb2YgY291bnRyaWVzIHdpdGggcGFydGljdWxhcmx5IGhpZ2ggbGV2ZWxzLiAKCiMjIyMgey5yZWNhbGxfY29kZV9xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgotIFdoYXQgaGFwcGVucyB3aGVuIHlvdSBkbyBub3QgdXNlIHRoZSBgZ3JvdXAgPSBDb3VudHJ5YCBhcmd1bWVudD8gCi0gV2hhdCBvdGhlciBhZXN0aGV0aWMgIChpLmUuIGBhZXMoKWAgYXJndW1lbnRzKSBjYW4gYmUgY2hhbmdlZD8KCiMjIyMKClNpbmNlIHdlIGhhdmUgbWFueSBvdmVybGFwcGluZyBsaW5lcywgd2Ugd2lsbCBtYWtlIG91ciBsaW5lcyBzbGlnaHRseSB0cmFuc3BhcmVudCBieSB1c2luZyB0aGUgYGFscGhhYCBhcmd1bWVudC4gCgpUaGlzIHRha2VzIHZhbHVlcyBmcm9tIDAgdG8gMSwgd2hlcmUgMCBpcyBjb21wbGV0ZWx5IHRyYW5zcGFyZW50IGFuZCAxIGlzIGNvbXBsZXRlbHkgb3BhcXVlLiAKCldlIGFsc28gYWRkIG91ciBgbXlfdGhlbWVgIGNvbnRyb2xsaW5nIHRoZSBzaXplIG9mIHRoZSB0aXRsZSBhbmQgYXhpcyBsYWJlbHMuIAoKYGBge3J9CkNPMl9jb3VudHJpZXMgPC0KICBkYXRhX2xvbmcgJT4lCiAgZmlsdGVyKEluZGljYXRvciA9PSAiRW1pc3Npb25zIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlLCBncm91cCA9IENvdW50cnkpKSArCiAgZ2VvbV9saW5lKGFscGhhID0gMC40KSArCiAgbGFicyh0aXRsZSA9ICJDb3VudHJ5IiB+Q09bMl1+ICJFbWlzc2lvbnMgcGVyIFllYXIgKDE3NTEtMjAxNCkiLAogICAgIGNhcHRpb24gPSAiTGltaXRlZCB0byByZXBvcnRpbmcgY291bnRyaWVzIiwKICAgICAgICAgICB5ID0gIkVtaXNzaW9ucyAoTWV0cmljIFRvbm5lcykiKSArCiAgbXlfdGhlbWUKCkNPMl9jb3VudHJpZXMKYGBgCgpPdXIgcGxvdCBpcyBzdGFydGluZyB0byBsb29rIHJlYWxseSBnb29kLiAKT25lIHF1ZXN0aW9uIHlvdSBzdGlsbCBtaWdodCBoYXZlIGlzIHdoaWNoIGNvdW50cnkgY29ycmVzcG9uZHMgdG8gd2hpY2ggbGluZT8gCldoaWNoIGxpbmUgaW5kaWNhdGVzIHRoZSBlbWlzc2lvbnMgaW4gdGhlIFVTPyAKCgojIyMgQWRkaW5nIGNvbG9yIAoKV2UgY2FuIGFkZCBhbm90aGVyICJsYXllciIgb24gdG9wIG9mIG91ciBmaXJzdCBwbG90IHRvIGFkZCBhIGJsdWUgbGluZSBqdXN0IGZvciB0aGUgVVMgZGF0YS4gClRvIGRvIHRoaXMgd2UgbmVlZCB0byBpbmRpY2F0ZSB3aGF0IGRhdGEgd2Ugd291bGQgbGlrZSB0byBwbG90LCBzbyB3ZSBuZWVkIHRvIGZpbHRlciBmb3IganVzdCB0aGUgVVMgZGF0YSBhbmQgdGhlbiB3ZSBuZWVkIHRvIGluZGljYXRlIHRoYXQgaXQgd2lsbCBiZSBjb2xvcmVkIGJ5IENvdW50cnksIGV2ZW4gdGhvdWdoIGluIHRoaXMgY2FzZSB3ZSBvbmx5IGhhdmUgb25lIGxpbmUgdG8gY29sb3IuIApUaGUgZGVmYXVsdCBjb2xvciB3b3VsZCBiZSBhIHNhbG1vbiBwaW5rIGNvbG9yLCBidXQgd2Ugd291bGQgbGlrZSBibHVlLiAKU28gd2Ugd2lsbCB1c2UgdGhlIGBzY2FsZV9jb2xvcl9tYW51YWwoKWAgZnVuY3Rpb24gdG8gbWFudWFsbHkgY2hvb3NlIHRoZSBjb2xvciB0aGF0IHdlIHdhbnQgYnkgdXNpbmcgYHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzID0gYygiYmx1ZSIpKWAuIE9mdGVuIHlvdSBtaWdodCB1c2UgcmVkIHRvIGhpZ2hsaWdodCBhIHN1YnNldCBvZiB0aGUgZGF0YSwgaG93ZXZlciwgdGhpcyBjYW4gYmUgZGlmZmljdWx0IGZvciB2aWV3ZXJzIHdpdGggY2VydGFpbiB0eXBlcyBvZiBjb2xvcmJsaW5kbmVzcy4gCgpOb3RpY2UgaG93IHRoZSBjb2xvciBuYW1lIG5lZWRzIHRvIGJlIGluIHF1b3RlcyBhbmQgdGhhdCB0aGUgYXJndW1lbnQgYHZhbHVlcyA9YCBpcyB1c2VkIHRvIHNwZWNpZnkgd2hhdCBjb2xvciB2YWx1ZXMgdG8gdXNlLgoKV2UgY2FuIGFkZCB0aGlzIGxpbmUgdG8gdGhlIHBsb3QgaW4gdHdvIHdheXMuIAoKKipVc2VmdWwgdGlwKio6IEluc3RlYWQgb2YgcmV0eXBpbmcgdGhlIG9yaWdpbmFsIGNvZGUgdG8gY3JlYXRlIHRoZSBgQ08yX2NvdW50cmllc2AgcGxvdCwgd2UgY2FuIGp1c3QgdXNlIHRoZSBgK2Agb3BlcmF0b3I6IAoKYGBge3J9CkNPMl9jb3VudHJpZXMgKwogIGdlb21fbGluZShkYXRhID0gZGF0YV9sb25nICU+JQogICAgICAgICAgICAgIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIsCiAgICAgICAgICAgICAgICAgICAgIENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMiKSwKICAgICAgICAgICAgICBhZXMoeCA9IFllYXIsIHkgPSBWYWx1ZSwgY29sb3IgPSBDb3VudHJ5KSkgKwogIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzID0gYygiYmx1ZSIpKQpgYGAKCkl0IGxvb2tzIGxpa2UgdGhlIFVTIGhhcyBsb25nIGJlZW4gdGhlIGxhcmdlc3QgQ08yIGVtaXNzaW9uIHByb2R1Y2luZyBjb3VudHJ5IHVudGlsIHJlY2VudGx5LCB3aGVuIHRoZSBVUyB3YXMgc3VycGFzc2VkIGJ5IGFub3RoZXIgY291bnRyeS4gCgpMZXQncyBmaWd1cmUgb3V0IHdobyBhcmUgdGhlIHRvcCAxMCBlbWlzc2lvbiBwcm9kdWNpbmcgY291bnRyaWVzIGluIDIwMTQuIApIZXJlLCB3ZSBmaWx0ZXIgdGhlIGRhdGEgZm9yIHRoZSB5ZWFyIDIwMTQsIHdoaWNoIHdhcyB0aGUgZmluYWwgeWVhciBvZiB0aGUgZGF0YS4gClRoZW4sIHdlIGNhbiBtYWtlIGEgcmFuayB2YXJpYWJsZSBiYXNlZCBvbiB0aGUgYFZhbHVlYCB2YXJpYWJsZSBmb3IgdGhlIGFtb3VudCBvZiBlbWlzc2lvbnMgcHJvZHVjZWQuIAoKVGhlcmUgYXJlIG1hbnkgZnVuY3Rpb25zIGluIHRoZSBgZHBseXJgIHBhY2thZ2UgZm9yIHJhbmtpbmcgdmFsdWVzIHRoYXQgYXJlIGJhc2VkIG9uIHRoZSBbU1FMXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TUUwpe3RhcmdldD0iX2JsYW5rIn0gb3Igc3BlY2lmaWNhbGx5IFtTUUwgcmFuayBmdW5jdGlvbnNdKGh0dHBzOi8vd3d3LnNxbHNoYWNrLmNvbS9vdmVydmlldy1vZi1zcWwtcmFuay1mdW5jdGlvbnMvKXt0YXJnZXQ9Il9ibGFuayJ9LiAKU1FMIGlzIGFub3RoZXIgcHJvZ3JhbW1pbmcgbGFuZ3VhZ2UgZm9yIG1hbmFnaW5nIGxhcmdlIGFtb3VudHMgb2YgZGF0YS4gClRoZSBkaWZmZXJlbmNlIGluIHRoZSByYW5rIGZ1bmN0aW9ucyBtb3N0bHkgaGFzIHRvIGRvIHdpdGggaG93IHRvIGRlYWwgd2l0aCB0aWVzIGluIHRoZSBkYXRhLiAgCldlIHdpbGwgdXNlIGBkZW5zZV9yYW5rKClgLCBhcyB3ZSBkbyBub3Qgd2FudCBnYXBzIGJldHdlZW4gcmFua3MuCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGggPSAiNjAwIHB4In0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInJhbmsucG5nIikpCmBgYAoKV2Ugd2FudCB0byBkbyB0aGlzIGluIGRlc2NlbmRpbmcgb3JkZXIgYmVjYXVzZSB3ZSB3YW50IHRvIHJhbmsgYnkgbGFyZ2VzdCB0byBzbWFsbGVzdCwgc28gd2Ugd2lsbCB1c2UgdGhlIGBkZXNjKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIApUaGVuLCB3ZSB3aWxsIGFycmFuZ2UgdGhlIG91dHB1dCBieSByYW5rIHVzaW5nIHRoZSBgYXJyYW5nZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlLiAKCmBgYHtyfQp0b3BfMTBfY291bnQgPC0KICBkYXRhX2xvbmcgJT4lCiAgZmlsdGVyKEluZGljYXRvciA9PSAiRW1pc3Npb25zIiwgWWVhciA9PSAyMDE0KSAlPiUKICBtdXRhdGUocmFuayA9IGRlbnNlX3JhbmsoZGVzYyhWYWx1ZSkpKSAlPiUKICBmaWx0ZXIocmFuayA8PSAxMCkgJT4lCiAgYXJyYW5nZShyYW5rKQoKdG9wXzEwX2NvdW50CmBgYAoKV2UgY2FuIHNlZSB0aGF0IENoaW5hIGlzIG5vdyB0aGUgdG9wIGVtaXNzaW9uIHByb2R1Y2luZyBjb3VudHJ5LgoKIyMjIyB7LnRoaW5rX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCldoYXQgYXJlIHRoZSBib3R0b20gMTAgZW1pc3Npb24gcHJvZHVjaW5nIGNvdW50cmllcyBpbiAyMDE0PwoKIyMjIwoKTGV0J3MgbWFrZSBhIHBsb3Qgb2YgKmp1c3QgdGhlc2UgdG9wIHRlbiBjb3VudHJpZXMqLiAKClRvIGRvIHRoaXMsIHdlIG5lZWQgdG8gZmlsdGVyIHRoZSBkYXRhIHRvIGp1c3QgdGhlc2UgdG9wIGNvdW50cmllcyBieSB1c2luZyB0aGUgYCVpbiVgIG9wZXJhdG9yIHRvIG9ubHkga2VlcCBjb3VudHJpZXMgaW4gb3VyIGBDb3VudHJ5YCB2YXJpYWJsZSB0aGF0IGFyZSBhbHNvIGluIHRoZSBgQ291bnRyeWAgdmFyaWFibGUgd2l0aGluIGB0b3BfMTBfY291bnRgLiAKV2UgY2FuIHVzZSB0aGUgYHB1bGwoKWAgZnVuY3Rpb24gYWxzbyBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIHNwZWNpZmljYWxseSBncmFiIGp1c3QgdGhlIGBDb3VudHJ5YCBkYXRhIG91dCBvZiBgdG9wXzEwX2NvdW50YC4KClNpbmNlIHdlIGhhdmUgMTAgY291bnRyaWVzIHdlIHdpbGwgd2FudCB0byBkaWZmZXJlbnRpYXRlIHRoZW0gYnkgY29sb3IuIAoKVG8gY29sb3Igb3VyIHBsb3Qgd2Ugd2lsbCB1c2UgdGhlIGB2aXJpZGlzYCBjb2xvciBwYWxldHRlIHdoaWNoIGlzIGNvbXBhdGlibGUgd2l0aCBjb2xvci1ibGluZG5lc3MgYnkgdXNpbmcgdGhlIGBzY2FsZV9jb2xvcl92aXJpZGlzX2QoKWAgZnVuY3Rpb24uIApUaGlzIGZ1bmN0aW9uIGlzIGF2YWlsYWJsZSBieSBsb2FkaW5nIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4gClRoZXJlIGFyZSBhIGZldyB2YXJpYXRpb25zIGZvciBkaXNjcmV0ZSB2YWx1ZXMgYXMgYF9kYCwgb3IgYmlubmVkIGNvbnRpbnVvdXMgdmFsdWVzIGFzIGBfYmAsIG9yIGNvbnRpbnVvdXMgdmFsdWVzIGFzIGBfY2AuIApTZWUgW2hlcmVdKGh0dHBzOi8vZ2dwbG90Mi50aWR5dmVyc2Uub3JnL3JlZmVyZW5jZS9zY2FsZV92aXJpZGlzLmh0bWwpIGZvciBtb3JlIGluZm9ybWF0aW9uLgoKCmBgYHtyfQpUb3AxMGIgPC0gZGF0YV9sb25nICU+JQogIGZpbHRlcihDb3VudHJ5ICVpbiUgcHVsbCh0b3BfMTBfY291bnQsIENvdW50cnkpKSAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICBmaWx0ZXIoWWVhciA+PSAxOTAwKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gVmFsdWUsIGNvbG9yID0gQ291bnRyeSkpICsKICAgIGdlb21fbGluZSgpICsKICAgIHNjYWxlX2NvbG9yX3ZpcmlkaXNfZCgpICsKICAgIGxhYnModGl0bGUgPSAiVG9wIDEwIEVtaXNzaW9ucy1wcm9kdWNpbmcgQ291bnRyaWVzIGluIDIwMTAgKDE5MDAtMjAxNCkiLAogICAgICAgICBzdWJ0aXRsZSA9ICJPcmRlcmVkIGJ5IEVtaXNzaW9ucyBQcm9kdWNlZCBpbiAyMDE0IiwKICAgICAgICAgeSA9ICJFbWlzc2lvbnMgKE1ldHJpYyBUb25zKSIsCiAgICAgICAgIHggPSAiWWVhciIpICsKICAgIG15X3RoZW1lCgpUb3AxMGIKYGBgCgpJdCdzIHN0aWxsIGEgYml0IGRpZmZpY3VsdCB0byB0ZWxsIHdoaWNoIGxpbmUgY29ycmVzcG9uZHMgdG8gd2hpY2ggY291bnRyeS4gClNvLCBsZXQncyBhZGQgYSB0ZXh0IGxhYmVsIGRpcmVjdGx5IHRvIHRoZSBwbG90LiAuIAoKIyMjIEFkZGluZyB0ZXh0IGxhYmVscwoKT25lIHdheSB0byBkbyB0aGlzIGlzIHRvIGFkZCB0ZXh0IGxheWVyIHRvIG91ciBwbG90IHVzaW5nIHRoZSBgZ2VvbV90ZXh0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4gCldlIG5lZWQgdG8gZmlyc3Qgc3BlY2lmeSB3aGF0IHZhcmlhYmxlIG9yIGNvbHVtbiB3ZSB3aWxsIHVzZS4gCkhvd2V2ZXIsIHdlIG9ubHkgd2FudCB0byBwdWxsIHRoZSB0ZXh0IGxhYmVscyBmb3IgdGhlIHRvcCB0ZW4gY291bnRyaWVzIGluIHRoZSBsYXN0IHllYXIuIApUbyBkbyB0aGlzLCB3ZSB1c2UgdGhlIGBsYXN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuCgpUaGVuLCB3ZSBuZWVkIHRvIGluZGljYXRlIHRoYXQgb3VyIHRleHQgbGFiZWwgd2lsbCBiZSBiYXNlZCBvbiB0aGUgYENvdW50cnlgIHZhcmlhYmxlIHVzaW5nIHRoZSBgYWVzKClgIGFlc3RoZXRpY3MgbWFwcGluZyBhcmd1bWVudC4gCldlIHdpbGwgYWxzbyBnZXQgcmlkIG9mIG91ciBsZWdlbmQgc2luY2Ugd2Ugd2lsbCBub3QgbmVlZCBpdCBhbnltb3JlLCBieSB1c2luZyB0aGUgYHRoZW1lKClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4KCmBgYHtyfQpUb3AxMGIgKwogIGdlb21fdGV4dChkYXRhID0gZGF0YV9sb25nICU+JQogICAgICAgICAgICAgIGZpbHRlcihDb3VudHJ5ICVpbiUgcHVsbCh0b3BfMTBfY291bnQsIENvdW50cnkpKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoWWVhciA9PSBsYXN0KFllYXIpKSwKICAgICAgICAgICAgYWVzKGxhYmVsID0gQ291bnRyeSkpICsKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpCmBgYAoKTm90IGJhZCwgYnV0IHNvbWUgb2YgdGhlIGxhYmVscyBhcmUgb3ZlcmxhcHBpbmcgYW5kIGRpZmZpY3VsdCB0byByZWFkLgpXZSBjYW4gdXNlIHRoZSBgY2hlY2tfb3ZlcmxhcCA9IFRSVUVgIGFyZ3VtZW50IHdpdGhpbiB0aGUgYGdlb21fdGV4dCgpYCBmdW5jdGlvbiB0byByZW1vdmUgb3ZlcmxhcHBpbmcgdmFyaWFibGVzLiAKQWxzbywgd2UgY2FuIGV4cGFuZCB0aGUgcGxvdCBhcmVhIGhvcml6b250YWxseSBzbyB0aGF0IHRoZSBuYW1lcyBhcmUgbm90IGN1dG9mZiBieSB1c2luZyBgc2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMC4yLDApKWAuIFRoaXMgdGFrZXMgYSB2ZWN0b3Igd2l0aCB0d28gdmFsdWVzLiBUaGUgZmlyc3QgdmFsdWUgaW5kaWNhdGVzIHdoYXQgcGVyY2VudGFnZSB0byBleHBhbmQgdGhlIHggYXhpcyBpbiBib3RoIGRpcmVjdGlvbnMuIEluIG91ciBjYXNlIHdlIHdpbGwgZXhwYW5kIGJ5IDE1IHBlcmNlbnQuIFRoZSBzZWNvbmQgdmFsdWUgaW5kaWNhdGVzIHdoYXQgYWJzb2x1dGUgdmFsdWUgdG8gZXhwYW5kIHRoZSBsaW1pdCBvZiB0aGUgeCBheGlzLiBJbiBvdXIgY2FzZSBgYygwLjE1LDApYCB3aWxsIGFjaGlldmUgYSBzaW1pbGFyIHJlc3VsdCBhcyBgYygwLCAxNylgLCBhcyB0aGUgcmFuZ2Ugb2YgdmFsdWVzIGZyb20gMTk5MCB0byAyMDE0IGlzIDExNCB5ZWFycyBhbmQgMTUlIG9mIHRoaXMgaXMgMTcuIAoKYGBge3J9CgpUb3AxMGIgKwogIGdlb21fdGV4dChkYXRhID0gZGF0YV9sb25nICU+JQogICAgICAgICAgICAgIGZpbHRlcihDb3VudHJ5ICVpbiUgcHVsbCh0b3BfMTBfY291bnQsIENvdW50cnkpKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoWWVhciA9PSBsYXN0KFllYXIpKSwKICAgICAgICAgICAgYWVzKGxhYmVsID0gQ291bnRyeSksCiAgICAgICAgICAgIGNoZWNrX292ZXJsYXAgPSBUUlVFKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMC4xNSwgMCkpICsKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpCmBgYAoKVGhpcyBpcyBlYXNpZXIgdG8gcmVhZCBub3csIGJ1dCBpdCBhbHNvIGNhdXNlcyB1cyB0byBsb3NlIHNvbWUgb2YgdGhlIGxhYmVscy4gClRoZXJlIGFyZSBzZXZlcmFsIGFsdGVybmF0aXZlIHdheXMgd2UgY2FuIGtlZXAgYWxsIG9mIG91ciBsYWJlbHMgYW5kIG1ha2UgdGhlbSBlYXNpZXIgdG8gcmVhZC4gVGhlIGZpcnN0IHBhY2thZ2Ugd2Ugd2lsbCBzaG93IGlzIGNhbGxlZCBgZGlyZWN0bGFiZWxzYC4KClRoZSBtb3N0IHNpbXBsZSBvcHRpb24gaXMgdG8gdXNlIHRoZSBgZGlyZWN0LmxhYmVsKClgIGZ1bmN0aW9uLCB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHkgYWRkIGxhYmVscyBhdCB0aGUgZW5kIG9mIHRoZSBsaW5lcy4gCkhvd2V2ZXIsIGl0IGlzIGEgYml0IGRpZmZpY3VsdCB0byBzZWUgc29tZSBvZiBvdXIgbGFiZWxzIGFzIHRoZXkgZ2V0IGF1dG9tYXRpY2FsbHkgc2l6ZWQgdG8gZml0IHRoZSBwbG90LgoKYGBge3J9CmRpcmVjdC5sYWJlbChUb3AxMGIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoZXhwYW5kID0gYygwLjMsIDApKQpgYGAKCkFsdGVybmF0aXZlbHkgdGhpcyBjYW4gYmUgZG9uZSB3aXRoaW4gdGhlIGBnZ3Bsb3QyYCBmcmFtZXdvcmsgYnkgbGF5ZXJpbmcgdXNpbmcgdGhlIGBnZW9tX2RsKClgIGZ1bmN0aW9uLgoKYGBge3J9ClRvcDEwYiArCiAgc2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMC4zLCAwKSkgKwogIGdlb21fZGwoYWVzKGxhYmVsID0gQ291bnRyeSksIG1ldGhvZCA9IGxpc3QoImxhc3QuYnVtcHVwIikpICsKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpCmBgYAoKVGhpcyBpcyBtb3JlIGxlZ2libGUgbm93LiAKV2UgaGF2ZSBhbGwgMTAgY291bnRyaWVzIG5hbWVzIGxpc3RlZCBhbmQgdGhleSBhcmUgaW4gb3JkZXIgb2YgdGhlIGxhc3QgZGF0YSBwb2ludCBhbmQgdGhleSBhcmUgcmVsYXRpdmVseSBjbG9zZSB0byB0aGUgbGluZXMgdGhhdCB0aGV5IGNvcnJlc3BvbmQgdG8uIAoKQW5vdGhlciBvcHRpb24gaXMgdG8gdXNlIGEgZGlmZmVyZW50IG1ldGhvZCBpbiB0aGUgYGRpcmVjdGxhYmxlc2AgcGFja2FnZS4gCltIZXJlXShodHRwOi8vZGlyZWN0bGFiZWxzLnItZm9yZ2Uuci1wcm9qZWN0Lm9yZy9kb2NzL2luZGV4Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gaXMgYSBsaXN0IG9mIG9wdGlvbnMuCgpGb3IgZXhhbXBsZSwgdGhlIGAiYW5nbGVkLmJveGVzImAgbWV0aG9kIGxvb2tzIG5pY2UgZm9yIHNvbWUgcGxvdHMgYnV0IGRvZXMgbm90IHdvcmsgdmVyeSB3ZWxsIGZvciBvdXIgcGxvdDoKCmBgYHtyfQpkaXJlY3QubGFiZWwoVG9wMTBiLCBtZXRob2QgPSBsaXN0KCJhbmdsZWQuYm94ZXMiKSkgKwogIHNjYWxlX3hfY29udGludW91cyhleHBhbmQgPSBjKDAuMywgMCkpCmBgYAoKSG93ZXZlciB0aGUgYCJsYXN0LnBvbHlnb25zImAgbWV0aG9kIHdvcmtzIHF1aXRlIHdlbGw6CgpgYGB7cn0KZGlyZWN0LmxhYmVsKFRvcDEwYiwgbWV0aG9kID0gbGlzdCgibGFzdC5wb2x5Z29ucyIpKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMC4zLCAwKSkKYGBgCgpUaGUgc2Vjb25kIHBhY2thZ2UgaXMgdGhlIGBnZ3JlcGVsYCBwYWNrYWdlLCB3aGljaCBpcyBlc3BlY2lhbGx5IGdvb2QgZm9yIGNyb3dkZWQgbGFiZWxzIHRoYXQgbWlnaHQgb3ZlcmxhcCBvbmUgYW5vdGhlci4gCkl0IGFsbG93cyBmb3IgbW9yZSBjb250cm9sIHRoYW4gdGhlIGBkaXJlY3RsYWJlbHNgIHBhY2thZ2UuIAoKU3BlY2lmaWNhbGx5LCB3ZSB3aWxsIHVzZSB0aGUgYGdlb21fdGV4dF9yZXBlbCgpYCBmdW5jdGlvbiBmcm9tIHRoZSBgZ2dyZXBlbGAgcGFja2FnZS4gCkp1c3QgbGlrZSB3aXRoIGBnZW9tX3RleHQoKWAsIGZpcnN0IHdlIG5lZWQgdG8gc3BlY2lmeSB3aGF0IGRhdGEgd2Ugd2FudCB0byBpbmNsdWRlLiAKVGhlbiwgd2Ugc3BlY2lmeSB3aXRoIHRoZSBgYWVzKClgIGFyZ3VtZW50IHRoYXQgb3VyIGxhYmVsIHdpbGwgYmUgYmFzZWQgb24gdGhlIGBDb3VudHJ5YCB2YXJpYWJsZSBhbmQgd2UgYWdhaW4gc3BlY2lmeSB3aGF0IHZhcmlhYmxlIHRvIHVzZSBmb3Igb3VyIHggYXhpcyBhbmQgeSBheGlzLCBzbyB0aGF0IHdlIGluZGljYXRlIHdoZXJlIHRoZSBsYWJlbHMgc2hvdWxkIGJlIHBsb3R0ZWQuIAoKYGBge3J9ClRvcDEwYiArCiAgZ2VvbV90ZXh0X3JlcGVsKGRhdGEgPSBkYXRhX2xvbmcgJT4lCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyKENvdW50cnkgJWluJSBwdWxsKHRvcF8xMF9jb3VudCwgQ291bnRyeSkpICU+JQogICAgICAgICAgICAgICAgICAgIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogICAgICAgICAgICAgICAgICAgIGZpbHRlcihZZWFyID09IGxhc3QoWWVhcikpLAogICAgICAgICAgICAgICAgICBhZXMobGFiZWwgPSBDb3VudHJ5LCB4ID0gWWVhciwgeSA9IFZhbHVlKSkgKwogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIikgKwogIHNjYWxlX3hfY29udGludW91cyhleHBhbmQgPSBjKDAuMywgMCkpCmBgYApZb3UgY2FuIHNlZSB0aGF0IHRoaXMgcGFja2FnZSBjcmVhdGVzIHNlZ21lbnRzIHRoYXQgY29ubmVjdCB0aGUgbGFiZWwgdG8gdGhlIGxpbmUuCgpUaGVyZSBhcmUgbWFueSBhcmd1bWVudHMgdG8gdXNlIHRvIHN0eWxlIHlvdXIgbGFiZWxzIGp1c3QgdGhlIHdheSB0aGF0IHlvdSB3YW50OgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjYwMCBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJnZ3JlcGVsLnBuZyIpKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifQoKU2VlIFt0aGUgZ2dyZXBlbCB2aWduZXR0ZV0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBkZXRhaWxzLgoKTGV0J3MgcGxheSBhcm91bmQgd2l0aCBzb21lIG9mIHRoZXNlIG9wdGlvbnMgaW4gdGhlIHRhYmxlIGFib3ZlLiAKYGBge3J9ClRvcDEwYiArCiAgZ2VvbV90ZXh0X3JlcGVsKGRhdGEgPSBkYXRhX2xvbmcgJT4lCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyKENvdW50cnkgJWluJSBwdWxsKHRvcF8xMF9jb3VudCwgQ291bnRyeSkpICU+JQogICAgICAgICAgICAgICAgICAgIGZpbHRlcihJbmRpY2F0b3IgPT0gIkVtaXNzaW9ucyIpICU+JQogICAgICAgICAgICAgICAgICAgIGZpbHRlcihZZWFyID09IGxhc3QoWWVhcikpLAogICAgICAgICAgICAgICAgICBhZXMobGFiZWwgPSBDb3VudHJ5LCB4ID0gWWVhciwgeSA9IFZhbHVlKSwKICAgICAgICAgICAgICAgICAgbnVkZ2VfeCA9IDEwLAogICAgICAgICAgICAgICAgICBoanVzdCA9IDEsCiAgICAgICAgICAgICAgICAgIHZqdXN0ID0gMSwKICAgICAgICAgICAgICAgICAgc2VnbWVudC5zaXplID0gMC4yNSwKICAgICAgICAgICAgICAgICAgZm9yY2UgPSAxKSArCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGV4cGFuZCA9IGMoMC4zLCAwKSkgKwogIHNjYWxlX3lfY29udGludW91cyhleHBhbmQgPSBjKDAuMywgMCkpCmBgYAoKTmljZSwgdGhhdCBsb29rcyBwcmV0dHkgZ29vZC4KRm9yIGZ1biwgbGV0J3MgdHJ5IHNob3dpbmcgb3VyIGRhdGEgaW4gYW4gZW50aXJlbHkgZGlmZmVyZW50IHdheS4gCgoKIyMjIFRpbGUgcGxvdHMKClRoaXMgdGltZSB3ZSB3aWxsIGNyZWF0ZSBhIGBnZW9tX3RpbGVgIHBsb3QuCgpUbyBjcmVhdGUgdGhpcyBwbG90IHdlIHdpbGwgZmlsdGVyIG91ciBkYXRhIHRvIGluY2x1ZGUgb25seSB0aGUgQ291bnRyaWVzIGluY2x1ZGVkIGluIHRoZSBgQ291bnRyeWAgdmFyaWFibGUgb2YgdGhlIGB0b3BfMTBfY291bnRgLiAKClRoZW4sIHdlIHdpbGwgdXNlIHRoZSBgZmN0X3Jlb3JkZXIoKWAgZnVuY3Rpb24gb2YgdGhlIGBmb3JjYXRzYCBwYWNrYWdlIHRvIG9yZGVyIG91ciBjb3VudHJpZXMgYmFzZWQgb24gdGhlIGxhc3QgZW1pc3Npb24gdmFsdWUgaW4gMjAxNC4KClRvIHVzZSB0aGlzIGZ1bmN0aW9uLCB0aGUgdmFyaWFibGUgdGhhdCBpcyB0byBiZSByZW9yZGVyZWQgaXMgbGlzdGVkIGZpcnN0LiAKVGhlIHZhcmlhYmxlIHRoYXQgaXMgYmVpbmcgdXNlZCB0byBkZXRlcm1pbmUgdGhlIG9yZGVyIGlzIGxpc3RlZCBzZWNvbmQuIApGaW5hbGx5LCBhIGZ1bmN0aW9uIHRvIGFwcGx5IHRvIHRoZSB2YXJpYWJsZSBsaXN0ZWQgc2Vjb25kIGlzIGxpc3RlZCB0aGlyZC4KVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGRldGVybWluZSB0aGUgb3JkZXIuIApJbiB0aGlzIGNhc2UsIHdlIHdhbnQgdG8gZGV0ZXJtaW5lIHRoZSBsYXN0IHZhbHVlIG9mIHRoZSBgVmFsdWVgIHZhcmlhYmxlIHVzaW5nIHRoZSBgbGFzdCgpYCBmdW5jdGlvbiAocmVjYWxsIHRoYXQgdGhpcyBpcyBhbHNvIGEgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSkuIApUaGVuLCB0aGUgYENvdW50cnlgIHZhcmlhYmxlIHdpbGwgYmUgb3JkZXJlZCBieSB0aGUgbGFzdCB2YWx1ZSBvZiB0aGUgYFZhbHVlYCB2YXJpYWJsZS4KClRvIGNvbG9yIG91ciBwbG90IHdlIHdpbGwgdXNlIHRoZSBgdmlyaWRpc2AgY29sb3IgcGFsZXR0ZSBhZ2FpbiBidXQgdGhpcyB0aW1lIHdlIHdpbGwgdXNlIHRoZSBgc2NhbGVfZmlsbF92aXJpZGlzX2MoKWAgLS0gcmVjYWxsIHRoYXQgdGhlIGBfY2AgaW5kaWNhdGVzIGEgY29udGludW91cyBzY2FsZS4gClNlZSBbdGhlIHNjYWxlX3ZpcmlkaXMgcmVmZXJlbmNlXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy9yZWZlcmVuY2Uvc2NhbGVfdmlyaWRpcy5odG1sKSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCgpgYGB7cn0KVG9wMTB0IDwtCiAgZGF0YV9sb25nICU+JQogIGZpbHRlcihDb3VudHJ5ICVpbiUgcHVsbCh0b3BfMTBfY291bnQsIENvdW50cnkpKSAlPiUKICBmaWx0ZXIoSW5kaWNhdG9yID09ICJFbWlzc2lvbnMiKSAlPiUKICBmaWx0ZXIoWWVhciA+PSAxOTAwKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gZmN0X3Jlb3JkZXIoQ291bnRyeSwgVmFsdWUsIGxhc3QpKSkgKwogICAgZ2VvbV90aWxlKGFlcyhmaWxsID0gbG9nKFZhbHVlKSkpICsKICAgIHNjYWxlX2ZpbGxfdmlyaWRpc19jKCkKYGBgCgoKRmluYWxseSwgbGV0J3MgY2xlYW4gdXAgdGhlIGF4ZXMgYW5kIHRoZSBheGVzIGxhYmVsczogCgpgYGB7cn0KVG9wMTB0IDwtIFRvcDEwdCArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgxOTAwLCAyMDE0LCBieSA9IDUpLAogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBzZXEoMTkwMCwgMjAxNCwgYnkgPSA1KSkgKwogIGxhYnModGl0bGUgPSAiVG9wIDEwICIgfkNPWzJdfiAiRW1pc3Npb24tcHJvZHVjaW5nIENvdW50cmllcyIsCiAgICAgICBzdWJ0aXRsZSA9ICJPcmRlcmVkIGJ5IEVtaXNzaW9ucyBQcm9kdWNlZCBpbiAyMDE0IiwKICAgICAgIGZpbGwgPSAiTG4oQ08yIEVtaXNzaW9ucyAoTWV0cmljIFRvbm5lcykpIikgKwogIHRoZW1lX2NsYXNzaWMoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyLCBhbmdsZSA9IDkwLCBjb2xvciA9ICJibGFjayIpLAogICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiwgY29sb3IgPSAiYmxhY2siKSwKICAgICAgICBheGlzLnRpdGxlID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgIHBsb3QuY2FwdGlvbiA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgIHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE2KSwKICAgICAgICBsZWdlbmQucG9zaXRpb24gPSAiYm90dG9tIikKClRvcDEwdApgYGAKCk5vdyBsZXQncyBzYXkgd2Ugd2FudGVkIHRvIHNhdmUgdGhpcyBwbG90LgoKV2UgY291bGQgZG8gc28gdXNpbmcgdGhlIHVzaW5nIHRoZSAgYHNhdmUoKWAgZnVuY3Rpb24gdG8gc2F2ZSB0aGlzIHRvIGEgInBsb3QiIGRpcmVjdG9yeSBpbiBvdXIgd29ya2luZyBkaXJlY3RvcnkgYXMgYW4gUkRBIGZpbGUgYW5kIHdlIGNhbiB1c2UgdGhlIGBwbmcoKWAgZnVuY3Rpb24gdG8gc2F2ZSBhIHBuZyBmb3IgY29sbGFib3JhdG9ycy4gV2UgbmVlZCB0byB1c2UgYGRldi5vZmYoKWAgZnVuY3Rpb24gdG8gY2xvc2UgdGhlIGdyYXBoaWNhbCBkZXZpY2UgdGhhdCB3ZSB3aWxsIHVzZSB0byBjcmVhdGUgdGhlIHBuZyB2ZXJzaW9uIG9mIHRoZSBwbG90IHNvIHRoYXQgd2UgYXJlIHJlYWR5IHRvIG1ha2UgYW5vdGhlciBwbG90IGxpa2UgdGhpcy4KCmBgYHtyLCBldmFsID0gRkFMU0V9CnNhdmUoVG9wMTB0LCBmaWxlID1oZXJlOjpoZXJlKCJwbG90cyIsICJUb3AxMHQucmRhIikpCnBuZyhoZXJlOjpoZXJlKCJwbG90cyIsICJUb3AxMHQucG5nIikpClRvcDEwdApkZXYub2ZmKCkKYGBgCgpXZSBzZWUgdGhhdCBHZXJtYW55IGhhZCB2ZXJ5IGxvdyBlbWlzc2lvbiByYXRlcyBhdCB0aGUgZW5kIG9mIFdvcmxkIFdhciBJSS4gCldlIGFsc28gc2VlIHRoYXQgdGhlIFVTIGhhcyBjb25zaXN0ZW50bHkgaGFkIGhpZ2ggZW1pc3Npb24gcmF0ZXMgc2luY2UgMTkwMCwgYnV0IHRoZSBlbWlzc2lvbiByYXRlcyBpbiBDaGluYSByZWNlbnRseSBzdXJwYXNzZWQgdGhhdCBvZiB0aGUgVVMuIApUaGUgcG9ydGlvbnMgb2YgdGhlIHBsb3QgdGhhdCBhcmUgd2hpdGUgaW5kaWNhdGUgdGhhdCB0aGVyZSBpcyBubyBlbWlzc2lvbiBkYXRhIGZvciB0aGF0IGNvdW50cnkuCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKVGhpbmsgYWJvdXQgd2hhdCB0aGUgcHJvcyBhbmQgY29ucyBhcmUgb2YgdGlsZSBhbmQgbGluZSBwbG90cy4gSW4gd2hhdCBzaXR1YXRpb25zIHdvdWxkIGEgdGlsZSBwbG90IGJlIGEgYmV0dGVyIGNob2ljZSBmb3IgZWZmZWN0aXZlIHNjaWVudGlmaWMgY29tbXVuaWNhdGlvbj8gSW4gd2hhdCBzaXR1YXRpb25zIHdvdWxkIGEgbGluZSBwbG90IGJlIGEgYmV0dGVyIGNob2ljZT8KCiMjIyMKCiMjICoqTW9yZSB0aGFuIG9uZSB2YXJpYWJsZSoqCioqKgoKTm93LCB3ZSB3aWxsIHZpc3VhbGl6ZSBhbGwgdGhlIHZhcmlhYmxlcyBpbiBvdXIgZGF0YXNldC4KCgojIyMgRmFjZXRlZCBwbG90cwoKSGVyZSwgd2UgdXNlIHRoZSBgZmFjZXRfd3JhcCgpYCBmdW5jdGlvbiBvZiB0aGUgYGdncGxvdDJgIHBhY2thZ2UsIHdoaWNoIHBsb3RzIG11bHRpcGxlIHN1YnBsb3RzIHNpbXVsdGFuZW91c2x5LiAKClRvIHVzZSBgZmFjZXRfd3JhcCgpYCB3aXRoIHRoZSBvcHRpb24gZm9yIGEgZGlmZmVyZW50IHktYXhpcyBzY2FsZSBmb3IgZWFjaCBzdWJwbG90LCB3ZSBuZWVkIHRvIHNldCB0aGUgYHNjYWxlc2AgYXJndW1lbnQgZXF1YWwgdG8gYCJmcmVlX3kiYC4gCldlIGNhbiBhbHNvIGluZGljYXRlIHdoZXJlIHdlIHdvdWxkIGxpa2UgdGhlIGxhYmVsIGZvciB0aGUgc3VicGxvdHMgdG8gYmUgbG9jYXRlZCBieSB1c2luZyB0aGUgYHN0cmlwLnBvc2l0aW9uYCBhcmd1bWVudC4gCgpgYGB7cixmaWcud2lkdGg9MTAsIGZpZy5oZWlnaHQ9MTB9CmdncGxvdChkYXRhX2xvbmcsIGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlLCBncm91cCA9IENvdW50cnkpKSArCiAgZ2VvbV9saW5lKGFscGhhID0gMC4yKSArCiAgZ2VvbV9saW5lKGRhdGEgPSBkYXRhX2xvbmcgJT4lCiAgICAgICAgICAgICAgZmlsdGVyKENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMiKSwKICAgICAgICAgICAgICBhZXMoeCA9IFllYXIsIHkgPSBWYWx1ZSwgY29sb3IgPSBDb3VudHJ5KSkgKwogIHNjYWxlX2NvbG91cl9tYW51YWwodmFsdWVzID0gYygiYmx1ZSIpKSArCiAgbGFicyh0aXRsZSA9ICJEaXN0cmlidXRpb24gb2YgSW5kaWNhdG9ycyBieSBZZWFyIGFuZCBWYWx1ZSIsCiAgICAgICB5ID0gIkluZGljYXRvciBWYWx1ZSIpICsKICBteV90aGVtZSArCiAgdGhlbWUoc3RyaXAudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTYsIGZhY2UgPSAiYm9sZCIpKSArCiAgZmFjZXRfd3JhcChJbmRpY2F0b3IgfiAuLAogICAgICAgICAgICAgc2NhbGVzID0gImZyZWVfeSIsCiAgICAgICAgICAgICBzdHJpcC5wb3NpdGlvbiA9ICJyaWdodCIsCiAgICAgICAgICAgICBuY29sID0gMSkKYGBgCgpOb3RpY2UgdGhhdCB3ZSBjYW4gY2hhbmdlIHRoZSBzaXplIG9yIHN0eWxlIG9mIHRoZSBmb250IGZvciB0aGVzZSBsYWJlbHMgdXNpbmcgdGhlIGBzdHJpcC50ZXh0ID1gIGFyZ3VtZW50IG9mIHRoZSBgdGhlbWUoKWAgZnVuY3Rpb24uIApXZSBjYW4gYWxzbyBzcGVjaWZ5IGhvdyBtYW55IHJvd3Mgb3IgY29sdW1ucyB3ZSB3b3VsZCBsaWtlIHRoZSBzdWJwbG90cyB0byBiZSBzaG93bi4gCgpXZSBjYW4gYWxzbyBmYWNldCBieSBtb3JlIHRoYW4gb25lIHZhcmlhYmxlIChlLmcuIGBJbmRpY2F0b3JgIGFuZCBgUmVnaW9uYCB0byBzaG93IHRoZSBkYXRhIGZyb20gdGhlIFVTIGNvbXBhcmVkIHRvIG90aGVyIGNvdW50cmllcykuCgpJbiB0aGlzIGNhc2Ugd2Ugd2FudCB0aGUgc2FtZSB5LWF4aXMgdG8gYmUgdXNlZCBhY3Jvc3MgdGhlIHJvd3MuIFdlIHdpbGwgdXNlIHRoZSBgZmFjZXRfZ3JpZCgpYCBmdW5jdGlvbiB0aGlzIHRpbWUgaW5zdGVhZCBvZiBgZmFjZXRfd3JhcCgpYCBiZWNhdXNlIG9mIHRoZSB3YXkgdGhhdCB0aGUgdHdvIGZhY2V0IHZhcmlhYmxlcyBhcmUgZGlzcGxheWVkLiBUaGUgYGZhY2V0X2dyaWQoKWAgZnVuY3Rpb24gd2lsbCBhcyB5b3UgbWlnaHQgZXhwZWN0LCBjcmVhdGUgYW4gb3V0cHV0IG9mIHBsb3RzIHRoYXQgYXJlIGRpc3BsYXllZCBpbiBhIGdyaWQuIAoKVGhlIHN5bnRheCBoZXJlIGlzIHRvIHB1dCB0aGUgbmFtZSBvZiB0aGUgdHdvIHZhcmlhYmxlcyBvbiB0aGUgbGVmdCBvciByaWdodCBzaWRlIG9mIHRoZSBgfmAgc3ltYm9sLCB3aGljaCB0ZWxscyB5b3UgdG8gZmFjZXQgYnkgcm93cyAobGVmdCkgb3IgY29sdW1ucyAocmlnaHQpLiAgCgpGaXJzdCwgd2Ugd2lsbCBmaWx0ZXIgb3V0IHRoZSBkYXRhIGFib3V0IGRpc2FzdGVycyBhbmQgdGVtcGVyYXR1cmUgYXMgdGhpcyBpcyBvbmx5IGZvciB0aGUgVVMsIGJ5IHVzaW5nIHRoZSBgZmlsdGVyKClgIGZ1bmN0aW9uIGFuZCBgIWAgIGluZGljYXRlcyB0aGF0IHdlIHdhbnQgb25seSB2YWx1ZXMgb2YgdGhlIGBJbmRpY2F0b3JgIHZhcmlhYmxlIG5vdCBpbiB0aGUgbGlzdCBjb250YWluaW5nIGAiRGlzYXN0ZXJzImAgYW5kIGAiVGVtcGVyYXR1cmUiYC4KCmBgYHtyLGZpZy53aWR0aD0xMCwgZmlnLmhlaWdodD0xMH0KZGF0YV9sb25nICU+JQogIGZpbHRlcighKEluZGljYXRvciAlaW4lIGMoIkRpc2FzdGVycyIsICJUZW1wZXJhdHVyZSIpKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlLCBncm91cCA9IENvdW50cnkpKSArCiAgICBnZW9tX2xpbmUoKSArCiAgICBmYWNldF9ncmlkKEluZGljYXRvciB+IFJlZ2lvbiwgc2NhbGVzID0gImZyZWVfeSIpICsKICAgIGxhYnModGl0bGUgPSAiRGlzdHJpYnV0aW9uIG9mIEluZGljYXRvcnMgYnkgWWVhciBhbmQgVmFsdWUiLAogICAgICAgICB5ID0gIkluZGljYXRvciBWYWx1ZSIpICsKICAgIG15X3RoZW1lICsKICAgIHRoZW1lKHN0cmlwLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE2LCBmYWNlID0gImJvbGQiKSkKYGBgCgoKCkZyb20gdGhlc2UgcGxvdHMgd2UgY2FuIHNlZSB0aGF0IGVhY2ggdHlwZSBvZiBkYXRhIHNwYW5zIGEgZGlmZmVyZW50IHRpbWUgc3Bhbi4KCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKV2hhdCBoYXBwZW5zIHdoZW4geW91IGNyZWF0ZSB0aGUgc2FtZSBwbG90IHdpdGggYGZhY2V0X3dyYXAoKWA/IApXaHkgbWlnaHQgdGhpcyBiZSBwcmVmZXJhYmxlIGluIGNlcnRhaW4gY2FzZXM/CgojIyMjCgojIyMjIHsucmVjYWxsX2NvZGVfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKQ2FsY3VsYXRlIHRoZSB0b3RhbCBudW1iZXIgb2YgY291bnRyaWVzIHBlciB5ZWFyIHJlcG9ydGluZyBDMDIgZW1pc3Npb25zLCBlbmVyZ3kgdXNlIGFuZCBHRFAuIApQbG90IHRoaXMgc3VtbWFyeSBzdGF0aXN0aWMgKHktYXhpcykgYWNyb3NzIHRoZSB5ZWFycyAoeC1heGlzKS4gCldoYXQgZG8geW91IHNlZT8gCgo8Yj48dT4gSGludCA8L3U+PC9iPjogVXNlIHRoZSBgdGFsbHkoKWAgZnVuY3Rpb24gaW4gdGhlIGBkcGx5cmAgcGFja2FnZS4gCgojIyMjCgojIyMgTGluZSBzZWdtZW50IHBsb3RzCgpUaGVyZSBhcmUgYWxzbyBzb21lIG90aGVyIGNvbW1vbiB2aXN1YWxpemF0aW9uIHRlY2huaXF1ZXMgdGhhdCBhcmUgZ29vZCBmb3Igc2hvd2luZyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGEgc2V0IG9mIG9ic2VydmF0aW9ucyBhbmQgYSBtZWFuIHZhbHVlIGFjcm9zcyB0aW1lLiAKCk9uZSBvZiB0aG9zZSBpcyBhIGxpbmUgc2VnbWVudCBwbG90LgpGb3Igc2ltcGxpY2l0eSwgbGV0J3MgZm9jdXMgb25seSBvbiB0aGUgZGF0YSBmcm9tIHRoZSBVUy4gCkxldCdzIGNhbGN1bGF0ZSB0aGUgbWVhbiBhY3Jvc3MgYWxsIHllYXJzIGZvciB0aGUgQ08yIGVtaXNzaW9uIGFuZCB0ZW1wZXJhdHVyZSBmcm9tIDE5ODAgdG8gMjAxMC4KUmVjYWxsIHRoYXQgb3VyIGBJbmRpY2F0b3JgIHZhcmlhYmxlIGRlc2NyaWJlcyB3aGF0IGtpbmQgb2YgZGF0YSB3ZSBoYXZlIChFbWlzc2lvbnMsIFRlbXBlcmF0dXJlLCBHRFAsIEVuZXJneSwgRGlzYXN0ZXJzKS4KV2Ugd2lsbCBjYWxjdWxhdGUgdGhlIG1lYW4gZm9yIGVhY2ggYEluZGljYXRvcmAgc2V0IG9mIGRhdGEgYnkgZmlyc3QgZ3JvdXBpbmcgYnkgdGhpcyB2YXJpYWJsZSBhbmQgdGhlbiBjYWxjdWxhdGluZyB0aGUgbWVhbiBvZiB0aGUgdmFsdWVzIG9mIHRoZSBgVmFsdWVgIHZhcmlhYmxlIGZvciBlYWNoIHNldCBvZiBkYXRhLiAKV2Ugd2lsbCBjYWxsIHRoaXMgbmV3IHZhcmlhYmxlIGBNZWFuYC4gClRoZW4sIHdlIGNhbGN1bGF0ZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIGVhY2ggb2JzZXJ2YXRpb24gYW5kIHRoZSBtZWFuIGFuZCBjcmVhdGUgYSBuZXcgdmFyaWFibGUgZm9yIHRoZXNlIHZhbHVlcyBjYWxsZWQgYERpZmZfZnJvbV9tZWFuYC4gIEFnYWluLCBhbGwgb2YgdGhpcyBpcyBwZXJmb3JtZWQgZm9yIGVhY2ggZ3JvdXAgb2YgZGF0YSBzZXBhcmF0ZWx5LgpPbmNlIHdlIGhhdmUgY3JlYXRlZCB0aGUgbmV3IHZhcmlhYmxlcywgd2Ugd2FudCB0byB1c2UgdGhlIGB1bmdyb3VwKClgIGZ1bmN0aW9uIHNvIHRoYXQgd2Ugbm8gbG9uZ2VyIHBlcmZvcm0gZnVuY3Rpb25zIG9uIHN1YnNldHMgb2YgdGhlIGRhdGEgYmFzZWQgb24gdGhlIGBJbmRpY2F0b3JgIHZhcmlhYmxlLgpGaW5hbGx5LCB3ZSB3aWxsIGFsc28gY3JlYXRlIGEgZmFjdG9yIHZhcmlhYmxlIGFib3V0IHRoZSBzaWduIG9mIHRoZSBgRGlmZl9mcm9tX21lYW5gIHZhbHVlIHRvIGRpc3Rpbmd1aXNoIHBvc2l0aXZlIG9yIG5lZ2F0aXZlIGNoYW5nZXMuIApXZSB3aWxsIHVzZSB0aGlzIHRvIGNvbG9yIG91ciBwbG90cy4KCmBgYHtyfQpkYXRhX2xvbmdfdXMgPC0KICBkYXRhX2xvbmcgJT4lCiAgZmlsdGVyKENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMiLCBZZWFyID49IDE5ODAsIFllYXIgPD0gMjAxMCkgJT4lCiAgZ3JvdXBfYnkoSW5kaWNhdG9yKSAlPiUKICBtdXRhdGUoTWVhbiA9IG1lYW4oVmFsdWUpLCBEaWZmX2Zyb21fbWVhbiA9IFZhbHVlIC0gTWVhbikgJT4lCiAgdW5ncm91cCgpICU+JQogIG11dGF0ZShEaWZmX2NvbG9yID0gc2lnbihEaWZmX2Zyb21fbWVhbikpICU+JQogIG11dGF0ZShEaWZmX2NvbG9yID0gYXMuZmFjdG9yKERpZmZfY29sb3IpKQpgYGAKCmBgYHtyfQpnbGltcHNlKGRhdGFfbG9uZ191cykKYGBgCgpOZXh0LCB3ZSB1c2UgdGhlIGBnZW9tX3NlZ21lbnQoKWAgZnVuY3Rpb24gdG8gZHJhdyBhIHN0cmFpZ2h0IGxpbmUgYmV0d2VlbiBwb2ludHMgKGB4YCwgYHlgKSBhbmQgKGB4ZW5kYCwgYHllbmRgKS4gCkluIG91ciBjYXNlLCB0aGlzIGNyZWF0ZXMgYSBwbG90IHRoYXQgc2hvd3MgYSBiYXIgZm9yIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIG9ic2VydmF0aW9uIGFuZCB0aGUgbWVhbiBhY3Jvc3MgYWxsIHRoZSB5ZWFycy4KCmBgYHtyLCBmaWcud2lkdGg9NiwgZmlnLmhlaWdodD02fQpkYXRhX2xvbmdfdXMgJT4lCiAgZmlsdGVyKEluZGljYXRvciAlaW4lIGMoIkVtaXNzaW9ucyIsICJUZW1wZXJhdHVyZSIsICJEaXNhc3RlcnMiKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlKSkgKwogICAgZ2VvbV9zZWdtZW50KGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlLCB4ZW5kID0gWWVhciwKICAgICAgICAgICAgICAgICAgICAgeWVuZCA9IE1lYW4sIGNvbG9yID0gRGlmZl9jb2xvciksCiAgICAgICAgICAgICAgICAgc2l6ZSA9IDMuMjUpICsKICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gYygiYmx1ZSIsICJyZWQiKSkgKwogIGdlb21faGxpbmUoYWVzKHlpbnRlcmNlcHQgPSBNZWFuKSwgbGluZXR5cGUgPSAxLCBjb2xvciA9ICJibGFjayIpICsKICBmYWNldF93cmFwKEluZGljYXRvciB+IC4sIHNjYWxlcyA9ICJmcmVlX3kiLCBuY29sID0gMSkgKwogIHRoZW1lX2NsYXNzaWMoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoYW5nbGUgPSA5MCksCiAgICAgICAgIGF4aXMudGl0bGUgPSBlbGVtZW50X2JsYW5rKCksCiAgICBsZWdlbmQucG9zaXRpb24gPSAibm9uZSIpICArCiAgbGFicyh0aXRsZSA9ICJVUyBEaXNhc3RlcnMsIEVtaXNzaW9ucywgYW5kIFRlbXBlcmF0dXJlcyAoMTk5MC0yMDEwKSIsCiAgICBzdWJ0aXRsZSA9ICJJbmRpY2F0b3IgTWVhbiBvZiAxOTkwLTIwMTAgUmVwcmVzZW50ZWQgYnkgU29saWQgQmxhY2sgTGluZSIpCmBgYApXZSBjYW4gc2VlIGZyb20gdGhpcyBwbG90IHRoYXQgb3ZlcmFsbCB0aGVyZSBoYXMgYmVlbiBhbiBpbmNyZWFzZSBpbiBkaXNhc3RlcnMsIGVtaXNzaW9ucyBhbmQgdGVtcGVyYXR1cmUgaW4gdGhlIG1vc3QgcmVjZW50IHllYXJzLiAKCiMjIyMgey50aGlua19xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgpXaGF0IHRyZW5kcyBkbyB5b3Ugc2VlIGluIEdEUCBhbmQgZW5lcmd5IHVzZSBhY3Jvc3MgdGltZT8gCgojIyMjCgoKIyMjIFNjYXR0ZXIgcGxvdHMKCk5leHQsIGxldCdzIHpvb20gaW4gb24gdHdvIG9mIHRoZSB2YXJpYWJsZXM6IENPMiBlbWlzc2lvbnMgYW5kIHRlbXBlcmF0dXJlLiAKV2UgdXNlIHllYXJzIGJldHdlZW4gMTk4MCBhbmQgMjAxNCBhcyB3ZSBoYXZlIHZhbHVlcyBmb3IgYWxsIG9mIHRob3NlIHllYXJzIGZvciB0aGVzZSB0d28gdmFyaWFibGVzLiAKCldlIGtub3cgdGhhdCB0aGUgZGF0YXNldHMgZG8gbm90IHNwYW4gdGhlIHNhbWUgYW1vdW50IG9mIHRpbWUuIApTbyBsZXQncyBsaW1pdCB0aGlzIHBsb3QgdG8gb25seSB0aGUgeWVhcnMgd2hlcmUgdGhlIGRhdGEgb3ZlcmxhcHMgZm9yIGJvdGggQ08yIGVtaXNzaW9ucyBhbmQgdGVtcGVyYXR1cmUuCgpXZSB1c2UgdGhlIGBnZW9tX3BvaW50KClgIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHNjYXR0ZXIgcGxvdCBiZXR3ZWVuIHRoZSBgeGAgYW5kIGB5YCB2YXJpYWJsZSBkZWZpbmVkIGluIGBhZXMoKWAgd2hlcmUgYHhgIGlzIHRpbWUgYW5kIGB5YCBpcyBvbmUgb2YgdGhlIHR3byB2YXJpYWJsZXMuIApXZSBhbHNvIGFkZCBhIGxpbmUgb24gdG9wIG9mIHRoZSBzY2F0dGVyIHBsb3QgdGhhdCBzbW9vdGhzIHRoZSB0cmVuZCBmcm9tIHRoZSBwb2ludHMuIFRoZSBzbW9vdGhlciB3ZSB1c2VkIGhlcmUgaXMgYGxvZXNzYCBbbG9jYWxseSBlc3RpbWF0ZWQgc2NhdHRlcnBsb3Qgc21vb3RoaW5nXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Mb2NhbF9yZWdyZXNzaW9uKXt0YXJnZXQ9Il9ibGFuayJ9LCBhIHR5cGUgb2YgW2xvY2FsIHBvbHlub21pYWwgcmVncmVzc2lvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9jYWxfcmVncmVzc2lvbil7dGFyZ2V0PSJfYmxhbmsifSBmaXR0aW5nLiBUaGlzIGlzIGEgbm9ucGFyYW1ldHJpYyByZWdyZXNzaW9uIHRoYXQgaXMgYWxzbyBjYWxsZWQgYSAibW92aW5nIHJlZ3Jlc3Npb24iIHdoZXJlIHN1YnNldHMgb2YgcG9pbnRzIHRoYXQgYXJlIGNsb3NlIHRvIG9uZSBhbm90aGVyIChoZW5jZSB0aGUgdGVybSBsb2NhbCkgYXJlIHVzZWQgaW4gYSBsZWFzdCBzcXVhcmVzICBsaW5lYXIgb3Igbm9ubGluZWFyIGZpdC4gVGh1cyB0aGlzIHJlc3VsdHMgaW4gYSBmaXQgdGhhdCBtYXkgY3VydmUgd2l0aCB0aGUgZGF0YS4KCmBgYHtyfQpDTzJfdGVtcF9VU19mYWNldCA8LQogIGRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoQ291bnRyeSA9PSAiVW5pdGVkIFN0YXRlcyIsIFllYXIgPj0gMTk4MCwgWWVhciA8PSAyMDE0LAogICAgICAgICBJbmRpY2F0b3IgJWluJSBjKCJFbWlzc2lvbnMiLCAiVGVtcGVyYXR1cmUiKSkgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IFZhbHVlKSkgKwogIGdlb21fcG9pbnQoKSArCiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gImxvZXNzIiwgc2UgPSBGQUxTRSkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3MgPSBzZXEoMTk4MCwgMjAxNCwgYnkgPSA1KSwKICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gc2VxKDE5ODAsIDIwMTQsIGJ5ID0gNSkpICsKICBmYWNldF93cmFwKExhYmVsIH4gLiwgc2NhbGVzID0gImZyZWVfeSIsIG5jb2wgPSAxKSArCiAgdGhlbWVfY2xhc3NpYygpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIsIGFuZ2xlID0gOTAsIGNvbG9yID0gImJsYWNrIiksCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyLCBjb2xvciA9ICJibGFjayIpLAogICAgICAgIHN0cmlwLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTQpLAogICAgICAgICBheGlzLnRpdGxlID0gZWxlbWVudF9ibGFuaygpLAogICAgICAgICBwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNikpCiAgbGFicyh0aXRsZSA9ICJVUyBFbWlzc2lvbnMgYW5kIFRlbXBlcmF0dXJlcyAoMTk4MC0yMDE0KSIpCgpDTzJfdGVtcF9VU19mYWNldApgYGAKCk5vdGUsIHdlIGFyZSBzaG93aW5nIGEgZGlmZmVyZW50IGB0aGVtZWAgaGVyZSwgbmFtZWx5IHRoZSBgdGhlbWVfY2xhc3NpYygpYCB0aGVtZS4gCldlIGNhbiBzZWUgdGhhdCB0aGVyZSBhcmUgc2ltaWxhciBwYXR0ZXJucyBvZiBDTzIgZW1pc3Npb24gbGV2ZWxzIGFuZCBhdmVyYWdlIGFubnVhbCB0ZW1wZXJhdHVyZXMuCgpXZSB3aWxsIHNhdmUgdGhpcyBwbG90IG5vdyBsaWtlIHNvIHRvIG91ciAicGxvdHMiIGRpcmVjdG9yeToKYGBge3IsIGV2YWwgPSBGQUxTRX0Kc2F2ZShDTzJfdGVtcF9VU19mYWNldCwgZmlsZSA9aGVyZTo6aGVyZSgicGxvdHMiLCAiQ08yX3RlbXBfVVNfZmFjZXQucmRhIikpCnBuZyhoZXJlOjpoZXJlKCJwbG90cyIsICJDTzJfdGVtcF9VU19mYWNldC5wbmciKSkKQ08yX3RlbXBfVVNfZmFjZXQKZGV2Lm9mZigpCmBgYAoKIyMjIyB7LnJlY2FsbF9jb2RlX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KCi0gVHJ5IHNob3cgYSBzaW1pbGFyIHBsb3Qgd2l0aG91dCBmaWx0ZXJpbmcgYnkgeWVhcnMgYW5kIGZhY2V0aW5nIGJ5IHRoZSBvdGhlciB0aHJlZSB2YXJpYWJsZXM6IGVuZXJneSB1c2UsIEdEUCBhbmQgZGlzYXN0ZXJzLiBBcmUgdGhlcmUgb3RoZXIgdmFyaWFibGVzIHRoYXQgbG9vayBsaWtlIHRoZXkgbWlnaHQgaGF2ZSBhIHNpbWlsYXIgcGF0dGVybiB0byBDTzIgZW1pc3Npb25zPyAKLSBUcnkgdXNpbmcgYSBkaWZmZXJlbnQgc21vb3RoZXIgaW4gYGdlb21fc21vb3RoKClgLiAKCiMjIyMKCk5leHQsIGluc3RlYWQgb2YgbG9va2luZyBhdCB0aGUgdmFyaWFibGVzIHNlcGFyYXRlbHkgaW4gZmFjZXRlZCBwbG90cywgbGV0J3MgbG9vayBhdCB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gQ08yIGVtaXNzaW9ucyBhbmQgb3RoZXIgdmFyaWFibGVzIGRpcmVjdGx5LiBUaHVzLCBpdCBpcyB1c2VmdWwgdG8gaGF2ZSBlYWNoIG9mIHRoZXNlIGluZGljYXRvcnMgYXMgdGhlaXIgb3duIHZhcmlhYmxlLgoKV2UgY2FuIGRvIHRoaXMgYnkgdXNpbmcgYHBpdm90X3dpZGVyKClgIHRvIHRyYW5zZm9ybSBvdXIgbG9uZyBkYXRhIHRhYmxlIGludG8gYSB3aWRlIGZvcm1hdC4gCgpgYGB7cn0Kd2lkZV9VUyA8LQogIGRhdGFfbG9uZyAlPiUKICBmaWx0ZXIoQ291bnRyeSA9PSAiVW5pdGVkIFN0YXRlcyIsIFllYXIgPj0gMTk4MCwgWWVhciA8PSAyMDE0KSAlPiUKICBzZWxlY3QoLUxhYmVsKSAlPiUKICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gSW5kaWNhdG9yLCB2YWx1ZXNfZnJvbSA9IFZhbHVlKQpgYGAKCkxldCdzIHNhdmUgdGhpcyBkYXRhIGFzIGFuIHJkYSBmaWxlIGZvciBmdXR1cmUgdXNlIGFuZCBhcyBhIGNzdiBmaWxlLCBhcyB0aGlzIGlzIG9mdGVuIHVzZWZ1bCBmb3IgY29sbGFib3JhdG9ycy4KV2Ugd2lsbCBzYXZlIHRoaXMgaW4gYSAid3JhbmdsZWQiIHN1YmRpcmVjdG9yeSBvZiBvdXIgImRhdGEiIGRpcmVjdG9yeSBvZiBvdXIgd29ya2luZyBkaXJlY3RvcnkuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpzYXZlKHdpZGVfVVMsIGZpbGUgPSBoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkIiwgIndyYW5nbGVkX1VTX2RhdGEucmRhIikpCnJlYWRyOjp3cml0ZV9jc3Yod2lkZV9VUywgcGF0aCA9IGhlcmU6OmhlcmUoImRhdGEiLCAid3JhbmdsZWQiLCAid3JhbmdsZWRfVVNfZGF0YS5jc3YiKSkKYGBgCgpOb3cgd2UgY2FuIHNwZWNpZnkgd2hpY2ggaW5kaWNhdG9ycyB3ZSB3YW50IHRvIGxvb2sgYXQsIHNvIG5vdyB3ZSBjYW4gc3BlY2lmaWNhbGx5IGxvb2sgYXQgZW1pc3Npb25zIGFuZCB0ZW1wZXJhdHVyZS4KCmBgYHtyfQpDTzJfdGVtcF9VUyA8LQogIHdpZGVfVVMgJT4lCiAgZ2dwbG90KGFlcyh4ID0gRW1pc3Npb25zLCB5ID0gVGVtcGVyYXR1cmUpKSArCiAgICBnZW9tX3BvaW50KCkgKwogICAgdGhlbWVfY2xhc3NpYygpICsKICAgIHRoZW1lKGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiwgY29sb3IgPSAiYmxhY2siKSwKICAgICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiwgY29sb3IgPSAiYmxhY2siKSwKICAgICAgICAgICBheGlzLnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCksCiAgICAgICAgICAgcGxvdC50aXRsZSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTYpKSArCiAgICBsYWJzKHRpdGxlID0gIlVTIEVtaXNzaW9ucyBhbmQgVGVtcGVyYXR1cmUgKDE5ODAtMjAxNCkiLAogICAgICAgICB4ID0gIkVtaXNzaW9ucyAoTWV0cmljIFRvbm5lcykiLAogICAgICAgICB5ID0gIlRlbXBlcmF0dXJlIChGYWhyZW5oZWl0KSIpCgoKQ08yX3RlbXBfVVMKYGBgCgpJdCBtaWdodCBiZSBoZWxwZnVsIHRvIGFkZCBhIHRyZW5kIGxpbmUgdG8gdGhpcy4gV2UgY2FuIGRvIHNvIGJ5IHVzaW5nIHRoZSBgZ2VvbV9zbW9vdGgoKWAgZnVuY3Rpb24gb2YgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlLgoKSWYgd2Ugd2FudCB0byBsb29rIGF0IGEgbGluZWFyIHRyZW5kIHdlIG5lZWQgdG8gc3BlY2lmeSB0aGUgbWV0aG9kIHVzaW5nIHRoZSBgbWV0aG9kID0gbG1gIGFyZ3VtZW50LiBUaGlzIGFkZHMgYSBsaW5lIHRvIHRoZSBkYXRhIGJhc2VkIG9uIGEgbGluZWFyIG1vZGVsIG9mIHRoZSBkYXRhIHVzaW5nIHRoZSBgbG1gIGZ1bmN0aW9uIG9mIHRoZSBgc3RhdHNgIHBhY2thZ2UuIFdlIHdpbGwgZGlzY3VzcyB0aGUgc2UgPSBGQUxTRSBhcmd1bWVudCBsYXRlci4gCgpXZSBjYW4ganVzdCBhZGQgdGhpcyB0byB0aGUgcGxvdCBvYmplY3QgdGhhdCB3ZSBqdXN0IGNyZWF0ZWQgdG8gY3JlYXRlIGEgcGxvdCB3aXRoIHRoaXMgdHJlbmQgbGluZS4KCmBgYHtyfQpDTzJfdGVtcF9VUyA8LSBDTzJfdGVtcF9VUyArIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRkFMU0UpCkNPMl90ZW1wX1VTIApgYGAKCkluZGVlZCwgaXQgZG9lcyBsb29rIGxpa2UgdGhlcmUgaXMgYSBwb3NpdGl2ZSwgbGluZWFyIHRyZW5kLiAKCldlIHdpbGwgYWxzbyBzYXZlIHRoaXMgcGxvdDoKCmBgYHtyLCBldmFsID0gRkFMU0V9CnNhdmUoQ08yX3RlbXBfVVMsIGZpbGUgPWhlcmU6OmhlcmUoInBsb3RzIiwgIkNPMl90ZW1wX1VTLnJkYSIpKQpwbmcoaGVyZTo6aGVyZSgicGxvdHMiLCAiQ08yX3RlbXBfVVMucG5nIikpCkNPMl90ZW1wX1VTCmRldi5vZmYoKQpgYGAKCiMjIyMgey5yZWNhbGxfY29kZV9xdWVzdGlvbl9ibG9ja30KPGI+PHU+IFF1ZXN0aW9uIE9wcG9ydHVuaXR5IDwvdT48L2I+CgotIE1ha2Ugc2ltaWxhciBwbG90cyBmb3IgYmV0d2VlbiBDTzIgZW1pc3Npb25zIGFuZCBvdGhlciB2YXJpYWJsZXMuIAotIEFyZSB0aGVyZSBvdGhlciBwYWlycyB2YXJpYWJsZXMgdGhhdCBsb29rIGxpa2UgdGhleSBtaWdodCBoYXZlIGEgc2ltaWxhciBwYXR0ZXJuIHRvIENPMiBlbWlzc2lvbnM/Ci0gRG9lcyB0aGlzIG1hdGNoIHdoYXQgd2Ugc2F3IGFib3ZlPyAKLSBEbyB0aGVzZSB0cmVuZCBsb29rIGxpbmVhciBvciBub24tbGluZWFyPyAKCiMjIyMKCk5vdyB0aGF0IHdlIHNlZSB0aGF0IHRoZXJlIG1pZ2h0IGJlIGEgbGluZWFyIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIENPMiBlbWlzc2lvbnMgYW5kIHRlbXBlcmF0dXJlLCBsZXQncyBsZWFybiBhYm91dCBzb21lIHN0YXRpc3RpY2FsIHRlY2huaXF1ZXMgdG8gbWVhc3VyZSB0aGUgc3RyZW5ndGggb2YgdGhhdCByZWxhdGlvbnNoaXAuIAoKCgoKIyAqKkRhdGEgQW5hbHlzaXMqKgoqKioKIApJZiB5b3UgYXJlIGZvbGxvd2luZyBhbG9uZyBhbmQgc3RvcHBlZCB5b3UgY291bGQgbG9hZCB0aGUgZGF0YSB5b3Ugd2lsbCBuZWVkIGxpa2Ugc286CgpgYGB7cn0KbG9hZChoZXJlOjpoZXJlKCJkYXRhIiwgIndyYW5nbGVkIiwgIndyYW5nbGVkX1VTX2RhdGEucmRhIikpCmBgYAoKKioqCjxkZXRhaWxzPiA8c3VtbWFyeT4gSWYgeW91IHNraXBwZWQgdGhlIHByZXZpb3VzIHNlY3Rpb25zIGNsaWNrIGhlcmUuIDwvc3VtbWFyeT4KCkZpcnN0IHlvdSBuZWVkIHRvIGluc3RhbGwgYW5kIGxvYWQgdGhlIGBPQ1NkYXRhYCBwYWNrYWdlOgoKYGBge3IsIGV2YWw9RkFMU0V9Cmluc3RhbGwucGFja2FnZXMoIk9DU2RhdGEiKQpsaWJyYXJ5KE9DU2RhdGEpCmBgYAoKVGhlbiwgeW91IG1heSBsb2FkIHRoZSB3cmFuZ2xlZCBkYXRhIHVzaW5nIHRoZSBmb2xsb3dpbmcgY29kZToKCmBgYHtyLCBldmFsPUZBTFNFfQp3cmFuZ2xlZF9yZGEoIm9jcy1icC1jbzItZW1pc3Npb25zIiwgb3V0cGF0aCA9IGdldHdkKCkpCmxvYWQoaGVyZTo6aGVyZSgiT0NTZGF0YSIsICJkYXRhIiwgIndyYW5nbGVkIiwgIndyYW5nbGVkX1VTX2RhdGEucmRhIikpCmBgYAoKSWYgdGhlIHBhY2thZ2UgZG9lcyBub3Qgd29yayBmb3IgeW91LCBhbHRlcm5hdGl2ZWx5LCBhbiBSREEgZmlsZSAoc3RhbmRzIGZvciBSIGRhdGEpIG9mIHRoZSBkYXRhIChjYWxsZWQgYHdyYW5nbGVkX1VTX2RhdGEucmRhYCkgY2FuIGJlIGZvdW5kIFtoZXJlXShodHRwczovL2dpdGh1Yi5jb20vL29wZW5jYXNlc3R1ZGllcy9vY3MtYnAtY28yLWVtaXNzaW9ucy90cmVlL21hc3Rlci9kYXRhL3dyYW5nbGVkKSBvciBzbGlnaHRseSBtb3JlIGRpcmVjdGx5IFtoZXJlXShodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vb3BlbmNhc2VzdHVkaWVzL29jcy1icC1jbzItZW1pc3Npb25zL21hc3Rlci9kYXRhL3dyYW5nbGVkL3dyYW5nbGVkX1VTX2RhdGEucmRhKS4gRG93bmxvYWQgdGhpcyBmaWxlIGFuZCB0aGVuIHBsYWNlIGl0IGluIHlvdXIgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeSB3aXRoaW4gYSBzdWJkaXJlY3RvcnkgY2FsbGVkICJ3cmFuZ2xlZCIgd2l0aGluIGEgc3ViZGlyZWN0b3J5IGNhbGxlZCAiZGF0YSIgdG8gY29weSBhbmQgcGFzdGUgb3VyIGNvZGUuIFdlIHVzZWQgYW4gUlN0dWRpbyBwcm9qZWN0IGFuZCB0aGUgW2BoZXJlYCBwYWNrYWdlXShodHRwczovL2dpdGh1Yi5jb20vamVubnliYy9oZXJlX2hlcmUpIHRvIG5hdmlnYXRlIHRvIHRoZSBmaWxlIG1vcmUgZWFzaWx5LgoKYGBge3J9CmxvYWQoaGVyZTo6aGVyZSgiZGF0YSIsICJ3cmFuZ2xlZCIsICJ3cmFuZ2xlZF9VU19kYXRhLnJkYSIpKQpgYGAKCgoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIHRvIHNlZSBtb3JlIGFib3V0IGNyZWF0aW5nIG5ldyBwcm9qZWN0cyBpbiBSU3R1ZGlvLiA8L3N1bW1hcnk+CgpZb3UgY2FuIGNyZWF0ZSBhIHByb2plY3QgYnkgZ29pbmcgdG8gdGhlIEZpbGUgbWVudSBvZiBSU3R1ZGlvIGxpa2Ugc286CgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI2MCUifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCAiTmV3X3Byb2plY3QucG5nIikpCmBgYAoKWW91IGNhbiBhbHNvIGRvIHNvIGJ5IGNsaWNraW5nIHRoZSBwcm9qZWN0IGJ1dHRvbjoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iNjAlIn0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInByb2plY3RfYnV0dG9uLnBuZyIpKQpgYGAKClNlZSBbaGVyZV0oaHR0cHM6Ly9zdXBwb3J0LnJzdHVkaW8uY29tL2hjL2VuLXVzL2FydGljbGVzLzIwMDUyNjIwNy1Vc2luZy1Qcm9qZWN0cykgdG8gbGVhcm4gbW9yZSBhYm91dCB1c2luZyBSU3R1ZGlvIHByb2plY3RzIGFuZCBbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKSB0byBsZWFybiBtb3JlIGFib3V0IHRoZSBgaGVyZWAgcGFja2FnZS4KCjwvZGV0YWlscz4KKioqCjwvZGV0YWlscz4KKioqCgoKCkluIHRoaXMgc2VjdGlvbiwgd2UgYXJlIGdvaW5nIHRvIGludHJvZHVjZSBzb21lIHdheXMgdG8gYmV0dGVyIHVuZGVyc3RhbmQgaG93IHR3byB2YXJpYWJsZXMgbW92ZSB0b2dldGhlci4gCldlIHdpbGwgZm9jdXMgb24gdGhlIENPMiBlbWlzc2lvbnMgYW5kIHRlbXBlcmF0dXJlLCBidXQgeW91IHdpbGwgYmUgZW5jb3VyYWdlZCB0byBleHBsb3JlIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBDTzIgZW1pc3Npb25zIGFuZCB0aGUgb3RoZXIgdmFyaWFibGVzLiAKCiMjIyAqKkJhc2ljIHN1bW1hcnkgc3RhdGlzdGljcyoqCioqKgoKV2UgY2FuIGFsd2F5cyBjYWxjdWxhdGUgdGhlIHNhbXBsZSBtZWFuIGFuZCB2YXJpYW5jZSBmb3IgdHdvIHZhcmlhYmxlcy4gCgpgYGB7cn0Kd2lkZV9VUyAlPiUKICBzdW1tYXJpemUobWVhbihFbWlzc2lvbnMpLCBtZWFuKFRlbXBlcmF0dXJlKSwgc2QoRW1pc3Npb25zKSwgc2QoVGVtcGVyYXR1cmUpKQpgYGAKClRoZXNlIGFyZSB1c2VmdWwsIGJ1dCBvbiB0aGVpciBvd24gdGhleSBkbyBub3Qgc3VtbWFyaXplIHdoZXRoZXIgb3Igbm90IHRoZXJlIGlzIGEgcmVsYXRpb25zaGlwIGJldHdlZW4gYEVtaXNzaW9uc2AgYW5kIGBUZW1wZXJhdHVyZWAgKGFsc28gdGhlc2UgYXJlIG9uIGRpZmZlcmVudCBzY2FsZXMgZW50aXJlbHkpLiAKCldoYXQgZWxzZSBjb3VsZCB3ZSB1c2U/IApOZXh0LCB3ZSBhcmUgZ29pbmcgdG8gbGVhcm4gYWJvdXQgdGhlIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50LCB3aGljaCBpcyBhIHN1bW1hcnkgc3RhdGlzdGljIHRoYXQgZGVzY3JpYmVzIGhvdyB0d28gdmFyaWFibGVzIGFyZSByZWxhdGVkIG9yIG1vdmUgdG9nZXRoZXIuIAoKIyMjICoqQ29ycmVsYXRpb24gY29lZmZpY2llbnQqKgoqKioKCldlIGNhbiB1c2UgdGhlIFtjb3JyZWxhdGlvbiBjb2VmZmljaWVudF0oaHR0cHM6Ly9yYWZhbGFiLmdpdGh1Yi5pby9kc2Jvb2svcmVncmVzc2lvbi5odG1sI2NvcnItY29lZmwpe3RhcmdldD0iX2JsYW5rIn0uIApIZXJlLCB3ZSBhcmUgdXNpbmcgdGhpcyBzdW1tYXJ5IHN0YXRpc3RpYyB0byBtZWFzdXJlIHRoZSBzdHJlbmd0aCBvZiBhIF9saW5lYXJfIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHR3byB2YXJpYWJsZXMuIAoKSWYgd2UgcGxvdCBvbmUgdmFyaWFibGUgb24gdGhlIHgtYXhpcyBhbmQgdGhlIG90aGVyIHZhcmlhYmxlIG9uIHRoZSB5LWF4aXMsIHdlIGNhbiBzZWU6CgoxLiBUaGUgc3RyZW5ndGggb2YgdGhlIHJlbGF0aW9uc2hpcCAtIGJhc2VkIG9uIGhvdyB3ZWxsIHRoZSBwb2ludHMgZm9ybSBhIGxpbmUgIAoyLiBUaGUgZGlyZWN0aW9uIG9mIHRoZSByZWxhdGlvbnNoaXAgLSBiYXNlZCBvbiBpZiB0aGUgcG9pbnRzIHByb2dyZXNzIHVwd2FyZCBvciBkb3dud2FyZCAKCklmIHRoZSB2YXJpYWJsZXMgcG9pbnQgdXB3YXJkIGluIGEgdmVyeSBjbGVhciBsaW5lLCB0aGVuIHRoZXJlIGlzIGEgc3Ryb25nIHBvc2l0aXZlIHJlbGF0aW9uc2hpcC4gCklmIHRoZSBwb2ludHMgZG8gbm90IHJlYWxseSBmb3JtIGEgbGluZSwgdGhlbiB0aGVyZSBpcyBhIHdlYWsgbGluZWFyIHJlbGF0aW9uc2hpcCBvciBubyBsaW5lYXIgcmVsYXRpb25zaGlwLiBUaGVyZSBtYXkgaG93ZXZlciBiZSBhIG5vbmxpbmVhciByZWxhdGlvbnNoaXAgaWYgdGhlIHBvaW50cyBjcmVhdGUgYSBkaWZmZXJlbnQgYnV0IGRlZmluZWQgc2hhcGUuIAoKU2VlIFtoZXJlXShodHRwczovL3Rvd2FyZHNkYXRhc2NpZW5jZS5jb20vZXN0aW1hdGluZy1ub24tbGluZWFyLWNvcnJlbGF0aW9uLWluLXItNjJjNjU3MWNiMWRiKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIG5vbmxpbmVhciByZWxhdGlvbnNoaXBzLgoKSWYgdGhlIHBvaW50cyBmb3JtIGEgZG93bndhcmQgc2xvcGluZyBsaW5lLCB0aGVuIHRoZXJlIGlzIGEgbmVnYXRpdmUgcmVsYXRpb25zaGlwLgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjgwMCBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCdodHRwczovL3d3dy5tYXRoc2lzZnVuLmNvbS9kYXRhL2ltYWdlcy9jb3JyZWxhdGlvbi1leGFtcGxlcy5zdmcnKQpgYGAKCiMjIyMjIFtbc291cmNlXV0oaHR0cHM6Ly93d3cubWF0aHNpc2Z1bi5jb20vZGF0YS9jb3JyZWxhdGlvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9CgpUaGUgbnVtYmVycyBiZWxvdyBlYWNoIHBsb3QgYWJvdmUgYXJlIGNhbGxlZCBjb3JyZWxhdGlvbiBjb2VmZmljaWVudHMuIApUaGV5IHJhbmdlIGZyb20gLTEgdG8gMS4gCkEgdmFsdWUgb2YgemVybyBpbmRpY2F0ZXMgdGhhdCB0aGVyZSBpcyBubyBjb3JyZWxhdGlvbiBiZXR3ZWVuIHRoZSB2YXJpYWJsZXMuIApXaGlsZSBhIHZhbHVlIG9mIDEgb3IgLTEgaW5kaWNhdGVzIHBlcmZlY3QgY29ycmVsYXRpb24sIHRoZSBjbG9zZXIgdGhlIGNvZWZmaWNpZW50IGlzIHRvIDEgb3IgLTEsIHRoZSBzdHJvbmdlciB0aGUgcmVsYXRpb25zaGlwLiAKVGhlIHNpZ24gb2YgdGhlIGNvZWZmaWNpZW50IGluZGljYXRlcyB0aGUgZGlyZWN0aW9uIG9mIHRoZSByZWxhdGlvbnNoaXAuIApJZiB0aGVyZSBpcyBhIG5lZ2F0aXZlIHJlbGF0aW9uc2hpcCB0aGVuIHRoZSB2YXJpYWJsZXMgc2hvdyBvcHBvc2luZyBjaGFuZ2VzIGZyb20gZWFjaCBvdGhlciAtIGFzIG9uZSBnZXRzIGxhcmdlciB0aGUgb3RoZXIgZ2V0cyBzbWFsbGVyLiAKSWYgdGhlIHNpZ24gaXMgcG9zaXRpdmUsIHRoZW4gdGhlIHZhcmlhYmxlcyBpbmNyZWFzZSBzaW1pbGFybHkuIAoKV2UgcHJldmlvdXNseSBtYWRlIHRoaXMgcGxvdDoKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoInBsb3RzIiwgIkNPMl90ZW1wX1VTLnBuZyIpKQpgYGAKCkxldCdzIGNhbGN1bGF0ZSB0aGUgUGVhcnNvbidzIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50IGNhbGxlZCAiUmhvIiAkXHJobyQgYmV0d2VlbiBDTzIgZW1pc3Npb25zIGFuZCB0ZW1wZXJhdHVyZSBpbiB0aGUgVVMuIFRoZXJlIGFyZSBhIGZldyB3YXlzIHRvIGNhbGN1bGF0ZSBhIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50IGFuZCB0aGlzIGlzIG9uZSBvZiB0aGUgbW9zdCBjb21tb24uCgpGb3JtYWxseSwgaWYgd2UgaGF2ZSBhIHBhaXIgb2Ygb2JzZXJ2YXRpb25zICQoeF8xLCB5XzEpLCBcZG90cywgKHhfbix5X24pJCwgdGhlIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50ICRccmhvJCBiZXR3ZWVuICR4JCBhbmQgJHkkIGlzIGRlZmluZWQgYXMgCgokJApccmhvID0gXGZyYWN7MX17bi0xfSBcc3VtX3tpPTF9Xm4gXGxlZnQoIFxmcmFje3hfaS1cbXVfeH17XHNpZ21hX3h9IFxyaWdodClcbGVmdCggXGZyYWN7eV9pLVxtdV95fXtcc2lnbWFfeX0gXHJpZ2h0KQokJAp3aGVyZSAkXG11X3gsIFxtdV95JCBhcmUgdGhlIG1lYW5zIG9mICR4XzEsXGRvdHMsIHhfbiQgYW5kICR5XzEsIFxkb3RzLCB5X24kLCByZXNwZWN0aXZlbHksIGFuZCAkXHNpZ21hX3gsIFxzaWdtYV95JCBhcmUgdGhlIHN0YW5kYXJkIGRldmlhdGlvbnMuIAoKVGhlcmVmb3JlLCB3ZSBjYW4gc3RhbmRhcmRpemUgdGhlIHR3byB2YXJpYWJsZXMgYW5kIGVzc2VudGlhbGx5IGF2ZXJhZ2UgKHRoZSBkZW5vbWluYXRvciBpcyBuLTEpIHRoZSBzdGFuZGFyZGl6ZWQgdmFsdWVzIHRvIGNhbGN1bGF0ZSB0aGUgY29ycmVsYXRpb24gY29lZmZpY2llbnQgYHJob2AuIAoKSGVyZSB3ZSB3aWxsIG1hbnVhbGx5IHBlcmZvcm0gdGhlIGNhbGN1bGF0aW9uLiBXZSB3aWxsIHVzZSB0aGUgYHRhbGx5KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gZ2V0IHRoZSBudW1iZXIgb2Ygc2FtcGxlcyAkbiQuIEluIHRoaXMgY2FzZSB0aGlzIGlzIGVxdWl2YWxlbnQgdG8gdGhlIG51bWJlciBvZiByb3dzIGluIHRoZSBgd2lkZV9VU2AgdGliYmxlLiBXZSBuZWVkIHRvIHRoZW4gdXNlIHRoZSBgcHVsbCgpYCBmdW5jdGlvbiB0byBzcGVjaWZpY2FsbHkgZ3JhYiB0aGUgdmFsdWUgb3V0IG9mIHRoZSB0aWJibGUgdGhhdCBpcyBjcmVhdGVkIGZyb20gdXNpbmcgdGhpcyBmdW5jdGlvbi4gQXMgeW91IGNhbiBzZWUgZnJvbSB1c2luZyB0aGUgYmFzZSBgY2xhc3MoKWAgZnVuY3Rpb24gdGhhdCB0aGlzIGlzIGEgYHRibF9kZmAgd2hpY2ggaXMgc2hvcnQgZm9yIHRpYmJsZSBkYXRhIGZyYW1lICh0aGUgdGlkeXZlcnNlIHZlcnNpb24gb2YgYSBkYXRhIGZyYW1lKSByYXRoZXIgdGhhbiBqdXN0IGEgbnVtYmVyLiAKCmBgYHtyfQp0YWxseSh3aWRlX1VTKQpjbGFzcyh0YWxseSh3aWRlX1VTKSkKYGBgCgpXaGVuIHdlIGNoZWNrIHRoZSBjbGFzcyBhZnRlciB1c2luZyB0aGUgYHB1bGwoKWAgZnVuY3Rpb24gd2Ugc2VlIHRoYXQgaXQgaXMgYW4gaW50ZWdlci4KCmBgYHtyfQpwdWxsKHRhbGx5KHdpZGVfVVMpLCBuKQpjbGFzcyhwdWxsKHRhbGx5KHdpZGVfVVMpLCBuKSkKYGBgCgpXZSB3aWxsIGFsc28gdXNlIHRoZSBiYXNlIGBzY2FsZSgpYCBmdW5jdGlvbiB0byBzdGFuZGFyZGl6ZSB0aGUgYEVtaXNzaW9uc2AgYW5kIGBUZW1wZXJhdHVyZWAgdmFsdWVzLgpgYGB7cn0Kd2lkZV9VUyAlPiUKICBzdW1tYXJpemUocmhvID0gKDEvKHB1bGwodGFsbHkod2lkZV9VUyksIG4pIC0xKSkgKihzdW0oc2NhbGUoRW1pc3Npb25zKSAqIHNjYWxlKFRlbXBlcmF0dXJlKSkpKSAlPiUKICBwdWxsKHJobykKYGBgCgpBbHRlcm5hdGl2ZWx5LCB5b3UgY2FuIHVzZSB0aGUgYGNvcigpYCBmdW5jdGlvbiBpbiBiYXNlIFIgbGlrZSBzbzoKCmBgYHtyfQp3aWRlX1VTICU+JQogIHN1bW1hcml6ZShyID0gY29yKHggPSBFbWlzc2lvbnMsCiAgICAgICAgICAgICAgICAgICAgeSA9IFRlbXBlcmF0dXJlLCAKICAgICAgICAgICAgICAgbWV0aG9kID0gInBlYXJzb24iKSkgJT4lCiAgcHVsbChyKQpgYGAKCklmIHlvdSB3YW50IHRvIGxlYXJuIG1vcmUgYWJvdXQgd2h5IHRoaXMgaXMgdGhlIGNhbGN1bGF0aW9uIHRvIGRldGVybWluZSB0aGUgc3RyZW5ndGggb2YgdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHR3byB2YXJpYWJsZXMsIHNlZSB0aGlzIFtsaW5rXShodHRwczovL2JjaGVnZ2VzZXRoLmdpdGh1Yi5pby9TdGF0MTU1Tm90ZXMvdHdvLXF1YW50aXRhdGl2ZS12YXJpYWJsZXMuaHRtbCkuIAoKIyMjIyB7LnJlY2FsbF9jb2RlX3F1ZXN0aW9uX2Jsb2NrfQo8Yj48dT4gUXVlc3Rpb24gT3Bwb3J0dW5pdHkgPC91PjwvYj4KClRoZXJlIGFyZSBkaWZmZXJlbnQgdHlwZXMgb2YgY29ycmVsYXRpb24gY29lZmZpY2llbnRzLiBMb29rIGF0IHRoZSBoZWxwIGZpbGUgZm9yIHRoZSBgY29yKClgIGZ1bmN0aW9uIGJ5IHR5cGluZyBgP2NvcigpYCBpbnRvIHRoZSBSU3R1ZGlvIENvbnNvbGUgdG8gbGVhcm4gbW9yZSBhbmQgdGhlbiB0cnkgYSBkaWZmZXJlbnQgYG1ldGhvZGAuIAoKV2hhdCBhcmUgdGhlIGRpZmZlcmVuY2VzPyAKCiMjIyMKCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKLSBUcnkgY2FsY3VsYXRpbmcgdGhlIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50IGJldHdlZW4gQ08yIGVtaXNzaW9ucyBhbmQgdGhlIG90aGVyIHZhcmlhYmxlcy4gCi0gV2hhdCBkbyB5b3UgZXhwZWN0PyAKCiMjIyMKClRvIHRlc3QgaWYgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gYSBwYWlyIG9mIHZhcmlhYmxlcyBpcyBbc3RhdGlzdGljYWxseSBzaWduaWZpY2FudF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RhdGlzdGljYWxfc2lnbmlmaWNhbmNlKSwgeW91IGNhbiB1c2UgdGhlIGBjb3IudGVzdCgpYCBvZiB0aGUgYHN0YXRzYCBwYWNrYWdlIHRvIGNhbGN1bGF0ZSB0aGUgY29ycmVsYXRpb24gY29lZmZpY2llbnQsIGFzIHdlbGwgYXMgY29uZmlkZW5jZSBpbnRlcnZhbHMgZm9yIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50cy4KCldlIGNhbiB1c2UgdGhlIGB0aWR5KClgIGZ1bmN0aW9uIG9mIHRoZSBgYnJvb21gIHBhY2thZ2UgdG8gbWFrZSB0aGUgb3V0cHV0IG1vcmUgdXNhYmxlIGZvciB3b3JraW5nIHdpdGggaW4gUi4gVGhlIHJvbGUgb2YgdGhpcyBmdW5jdGlvbiBpcyB0byBwdWxsIG51bWVyaWMgdmFsdWVzIGZyb20gb3V0cHV0cyBhbmQgY3JlYXRlIGEgZGF0YSBmcmFtZSBvZiB0aGUgdmFsdWVzLgoKYGBge3J9Cgpjb3IudGVzdChwdWxsKHdpZGVfVVMsIEVtaXNzaW9ucyksCiAgICAgICAgIHB1bGwod2lkZV9VUywgVGVtcGVyYXR1cmUpKQoKYnJvb206OnRpZHkoY29yLnRlc3QocHVsbCh3aWRlX1VTLCBFbWlzc2lvbnMpLAogICAgICAgICBwdWxsKHdpZGVfVVMsIFRlbXBlcmF0dXJlKSkpCmBgYAoKV2Ugc2VlIHRoYXQgdGhlIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50IHF1YW50aWZ5aW5nIHRoZSBzdHJlbmd0aCBvZiB0aGUgbGluZWFyIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIEMwMiBlbWlzc2lvbnMgYW5kIHRlbXBlcmF0dXJlIGlzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQuCgojIyMgKipSZWxhdGlvbnNoaXAgYmV0d2VlbiBjb3JyZWxhdGlvbiBhbmQgbGluZWFyIHJlZ3Jlc3Npb24qKgoqKioKCkxldCdzIGJyaWVmbHkgZGlzY3VzcyB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gY29ycmVsYXRpb24gYW5kIGxpbmVhciByZWdyZXNzaW9uLCB3aGljaCBpcyBmdXJ0aGVyIGRlc2NyaWJlZCBpbiB0aGUgW0ludHJvZHVjdGlvbiB0byBEYXRhIFNjaWVuY2UgYm9va10oaHR0cHM6Ly9yYWZhbGFiLmdpdGh1Yi5pby9kc2Jvb2svcmVncmVzc2lvbi5odG1sKS4gCgpXZSBjYW4gdXNlIGEgcmVncmVzc2lvbiBsaW5lIHRvIHByZWRpY3QgYSByYW5kb20gdmFyaWFibGUgJFkkIGdpdmVuIHRoYXQgd2UgaGF2ZSBnYXRoZXJlZCBvciBvYnNlcnZlZCBzb21lIGRhdGEgYWJvdXQgYW5vdGhlciB2YXJpYWJsZSAkWD14JC4gClRoZSByZWdyZXNzaW9uIGxpbmUgZm9ybWFsbHkgaXMgZGVmaW5lZCBhczoKCiQkIFxsZWZ0KCBcZnJhY3tZLVxtdV9ZfXtcc2lnbWFfWX0gXHJpZ2h0KSA9IFxyaG8gXGxlZnQoIFxmcmFje3gtXG11X1h9e1xzaWdtYV9YfSBccmlnaHQpICQkCndoZXJlICRcbXVfWCQgYW5kICRcc2lnbWFfWCQgKCRcbXVfWSQgYW5kICRcc2lnbWFfWSQpIGFyZSB0aGUgbWVhbiBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIG9mICRYJCAoJFkkKSwgYW5kICRccmhvJCBpcyBjb3JyZWxhdGlvbiBiZXR3ZWVuICRYJCBhbmQgJFkkLiAKSWYgJHgkIGlzIGxhcmdlciB0aGFuICRcbXVfWCQsIHRoZW4gZm9yIGV2ZXJ5ICRcc2lnbWFfWCQsIHRoZW4gJFkkIHdpbGwgYWxzbyBpbmNyZWFzZSAkXHJobyQgc3RhbmRhcmQgZGV2aWF0aW9ucyBhYm92ZSAkXG11X1kkLiAKClJlLW9yZ2FuaXppbmcgdGhlIHRlcm1zIHNvIHRoYXQgJFkkIGlzIG9uIHRoZSBsZWZ0IHNpZGUgYW5kIGV2ZXJ5dGhpbmcgZWxzZSBpcyBvbiB0aGUgcmlnaHQgc2lkZSwgd2UgZ2V0OgoKJCQgWSA9IFxtdV9ZICsgXHJobyBcbGVmdCggXGZyYWN7eC1cbXVfWH17XHNpZ21hX1h9IFxyaWdodCkgXHNpZ21hX1kgJCQKVGhpbmtpbmcgYWJvdXQgc29tZSBleHRyZW1lIGV4YW1wbGVzOiAKCi0gSWYgJFxyaG8kID0gMCAoaS5lLiBubyBjb3JyZWxhdGlvbiksIHdlIGlnbm9yZSB0aGUgJHgkIHRlcm0gZW50aXJlbHkgYW5kIG9ubHkgcHJlZGljdCAkWSQgdXNpbmcgdGhlIG1lYW4gJFxtdV9ZJC4gCi0gSWYgJFxyaG8kID0gMSAob3IgLTEpIChpLmUuIHBlcmZlY3QgY29ycmVsYXRpb24pLCB0aGUgcmVncmVzc2lvbiBsaW5lIHByZWRpY3RzIGFuIGluY3JlYXNlIChvciBkZWNyZWFzZSkgdGhhdCBpcyB0aGUgc2FtZSBudW1iZXIgb2YgU0RzLiAKLSBJZiAkXHJobyQgaXMgYmV0d2VlbiAtMSBhbmQgMSwgdGhlbiB3ZSBwcmVkaWN0IHVzaW5nIGJvdGggdGVybXMgb24gdGhlIHJpZ2h0IGhhbmQgc2lkZS4gCgpUbyBhZGQgcmVncmVzc2lvbiBsaW5lcyB0byBwbG90cywgd2Ugd2lsbCBuZWVkIHRoZSBhYm92ZSBmb3JtdWxhIGluIHRoZSBmb3JtOiAKCiQkCnk9IGIgKyBteCBcbWJveHsgd2l0aCBzbG9wZSB9IG0gPSBccmhvIFxmcmFje1xzaWdtYV95fXtcc2lnbWFfeH0gXG1ib3h7IGFuZCBpbnRlcmNlcHQgfSBiPVxtdV95IC0gbSBcbXVfeAokJAoKSW4gb3VyIGV4YW1wbGUsIHdlIGNhbiBjYWxjdWxhdGUgdGhlIHNsb3BlIGFuZCBpbnRlcmNlcHQgdXNpbmcgdGhlIGZvcm11bGEgYWJvdmUgYW5kIHBsb3QgdGhlIGxpbmUuIApgYGB7cn0Kd2lkZV9VU19zdW1tYXJ5IDwtCiAgd2lkZV9VUyAlPiUKICBzdW1tYXJpemUobXVfeCA9IG1lYW4oRW1pc3Npb25zKSwgc2RfeCA9IHNkKEVtaXNzaW9ucyksCiAgICAgICAgICAgIG11X3kgPSBtZWFuKFRlbXBlcmF0dXJlKSwgc2RfeSA9IHNkKFRlbXBlcmF0dXJlKSwKICAgICAgICAgICAgcmhvID0gY29yKEVtaXNzaW9ucywgVGVtcGVyYXR1cmUpLAogICAgICAgICAgICBzbG9wZSA9IHJobyAqIHNkX3kgLyBzZF94LAogICAgICAgICAgICBpbnRlcmNlcHQgPSBtdV95IC0gcmhvICogc2RfeSAvIHNkX3ggKiBtdV94KQoKd2lkZV9VUyAlPiUKICBnZ3Bsb3QoYWVzKHggPSBFbWlzc2lvbnMsIHkgPSBUZW1wZXJhdHVyZSkpICsKICAgIGdlb21fcG9pbnQoKSArCiAgICBnZW9tX2FibGluZShzbG9wZSA9IHdpZGVfVVNfc3VtbWFyeSRzbG9wZSwKICAgICAgICAgICAgICAgIGludGVyY2VwdCA9IHdpZGVfVVNfc3VtbWFyeSRpbnRlcmNlcHQpICsKICB0aGVtZV9saW5lZHJhdygpICsKICB0aGVtZShheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgcGxvdC5jYXB0aW9uID0gZWxlbWVudF90ZXh0KHNpemUgPSAxMiksCiAgICAgICAgIHBsb3QudGl0bGUgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE2KSkKYGBgCgoqKk5vdGUqKjogSW4gdGhlIHBsb3QgYWJvdmUsIHdlIHVzZSB0aGUgc2NhbGUgb2YgdGhlIG9yaWdpbmFsIHZhcmlhYmxlcyAoQ08yIGVtaXNzaW9uIGFuZCB0ZW1wZXJhdHVyZSksIGJ1dCB0aGUgZm9ybXVsYSBhYm92ZSBpbXBsaWVzIHRoYXQgc3RhbmRhcmRpemF0aW9uIG9mIHRoZSB2YXJpYWJsZXMgKGkuZS4gc3VidHJhY3RpbmcgdGhlIG1lYW4gYW5kIGRpdmlkaW5nIGJ5IHRoZSBzdGFuZGFyZCBkZXZpYXRpb24pIGFsbG93cyB0aGUgcmVncmVzc2lvbiBsaW5lIHRvIGhhdmUgYW4gaW50ZXJjZXB0IG9mIDAgYW5kIHNsb3BlIGVxdWFsIHRvICRccmhvJC4gQSBzaW1pbGFyIHBsb3QgaW4gc3RhbmRhcmRpemVkIHVuaXRzIGlzIGdpdmVuIGJlbG93LiAgCgpgYGB7cn0gCkNPMl90ZW1wX1VTX3NjYWxlZDwtd2lkZV9VUyAlPiUKICBnZ3Bsb3QoYWVzKHggPSBzY2FsZShFbWlzc2lvbnMpLCB5ID0gc2NhbGUoVGVtcGVyYXR1cmUpKSkgKwogICAgZ2VvbV9wb2ludCgpICsKICAgIGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIsIHNlID0gRkFMU0UpICsKICBsYWJzKHRpdGxlID0gIlVTIiB+IENPWzJdfiAiRW1pc3Npb25zIGFuZCBUZW1wZXJhdHVyZSAoMTk4MC0yMDE0KSIsCiAgICAgICAgIHkgPSAiU2NhbGVkIFRlbXBlcmF0dXJlIChGYWhyZW5oZWl0KSIsCiAgICAgICAgIHggPSAiU2NhbGVkIEVtaXNzaW9ucyAoTWV0cmljIFRvbm5lcykiKSArCiAgdGhlbWVfbGluZWRyYXcoKSArCiAgdGhlbWUoYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDEyKSwKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNCksCiAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE0KSwKICAgICAgIHBsb3QuY2FwdGlvbiA9IGVsZW1lbnRfdGV4dChzaXplID0gMTIpLAogICAgICAgICBwbG90LnRpdGxlID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNikpCgpDTzJfdGVtcF9VU19zY2FsZWQKYGBgCgpOb3RpY2UgdGhhdCB3ZSBhbHNvIHVzZSB0aGUgYGdlb21fc21vb3RoKG1ldGhvZCA9ICJsbSIpYCBmdW5jdGlvbiB0aGF0IHdlIHByZXZpb3VzbHkgdXNlZC4gQWdhaW4sIHRoaXMgYWRkcyBhIGxpbmUgY29ycmVzcG9uZGluZyB0byB0aGUgc2xvcGUgYW5kIGludGVyY2VwdCBmcm9tIHRoZSBgbG0oKWAgZnVuY3Rpb24gZnJvbSB0aGUgYHN0YXRzYCBSIHBhY2thZ2UuIAoKCgojIyMjIHsudGhpbmtfcXVlc3Rpb25fYmxvY2t9CjxiPjx1PiBRdWVzdGlvbiBPcHBvcnR1bml0eSA8L3U+PC9iPgoKV2hhdCBkb2VzIGBzZSA9IEZBTFNFYCBtZWFuPyBUcnkgdHVybmluZyBpdCB0byBUUlVFLiBXaGF0IGhhcHBlbnM/IAoKIyMjIwoqKioKPGRldGFpbHM+IDxzdW1tYXJ5PiBDbGljayBoZXJlIGZvciB0aGUgYW5zd2VyLjwvc3VtbWFyeT4KYHNlYCBzdGFuZHMgZm9yIHN0YW5kYXJkIGVycm9yLiBUaGUgZ3JheSBzaGFkaW5nIHNob3dzIHRoZSBbY29uZmlkZW5jZSBpbnRlcnZhbF0oaHR0cHM6Ly9zdGF0dHJlay5jb20vcmVncmVzc2lvbi9zbG9wZS1jb25maWRlbmNlLWludGVydmFsLmFzcHgpe3RhcmdldD0iX2JsYW5rIn0gb2YgdGhlIHNtb290aCBsaW5lLgo8L2RldGFpbHM+CioqKgoKIyMjICoqTGltaXRhdGlvbnMgb2YgQ29ycmVsYXRpb24qKgoqKioKCldoaWxlIGNvcnJlbGF0aW9uIGlzIHVzZWZ1bCBpbiBtYW55IHNldHRpbmdzIHRvIHVuZGVyc3RhbmQgaG93IHR3byB2YXJpYWJsZXMgbW92ZSB0b2dldGhlciwgY29ycmVsYXRpb24gaXMgbm90IGFsd2F5cyBhIHVzZWZ1bCBzdW1tYXJ5LiAKRm9yIGV4YW1wbGUsIGhlcmUgYXJlIHdheXMgaXQgbWlnaHQgbm90IGJlIHVzZWZ1bDogCgotIEEgbGluZWFyIHJlbGF0aW9uc2hpcCBtaWdodCBub3QgYmUgdGhlIGJlc3Qgd2F5IHRvIGNhcHR1cmUgdGhlIHJlbGF0aW9uc2hpcC4KLSBJZiBhbiBpbmRpdmlkdWFsIHdlcmUgaW50ZXJlc3RlZCBpbiB1bmRlcnN0YW5kaW5nIGEgX2NhdXNhbF8gcmVsYXRpb25zaGlwIGJldHdlZW4gdHdvIHZhcmlhYmxlcywgYXMgW2NvcnJlbGF0aW9uIGRvZXMgbm90IGltcGx5IGNhdXNhdGlvbl0oaHR0cHM6Ly9kZnJpZWRzLmNvbS9tYXRoL2NvcnJlbGF0aW9uLWRvZXMtbm90LWltcGx5LWNhdXNhdGlvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LiBBbm90aGVyIHdheSBvZiBzdGF0aW5nIHRoaXMgaXMgdGhhdCBzaW1wbHkgc2hvd2luZyB0aGVyZSBpcyBhIGxpbmVhciB0cmVuZCBvdmVyIHRpbWUgZG9lcyBub3QgaW1wbHkgdGhlcmUgaXMgYSBjYXVzYWwgcmVsYXRpb25zaGlwIGJldHdlZW4gdGhlc2UgdHdvIHZhcmlhYmxlcy4gIAoKQXMgeW91IGNhbiBzZWUgZnJvbSB0aGlzIHBsb3QsIG9mdGVuIGRhdGEgbWF5IHNob3cgYSBzaW1pbGFyIHBhdHRlcm4gb3ZlciB0aW1lIGJ5IHJhbmRvbSBjaGFuY2UuIApTZWUgdGhpcyBbd2Vic2l0ZV0oaHR0cHM6Ly93d3cudHlsZXJ2aWdlbi5jb20vc3B1cmlvdXMtY29ycmVsYXRpb25zKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGV4YW1wbGVzLgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoPSI2MDBweCJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJjYXVzYXRpb24ucG5nIikpCmBgYAoKIyMjIyMgW1tzb3VyY2VdXShodHRwOi8vdHlsZXJ2aWdlbi5jb20vc3B1cmlvdXMtY29ycmVsYXRpb25zKXt0YXJnZXQ9Il9ibGFuayJ9CgpJbiB0aGlzIGV4YW1wbGUgYW5kIGluIG91ciBjYXNlIHN0dWR5LCBkYXRhIHdhcyBjb2xsZWN0ZWQgb3ZlciB0aW1lLiBUaGlzIHR5cGUgb2YgZGF0YSB3aWxsIG9mdGVuIGhhdmUgd2hhdCBpcyBjYWxsZWQgW2F1dG9jb3JybGVhdGlvbl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQXV0b2NvcnJlbGF0aW9uKXt0YXJnZXQ9Il9ibGFuayJ9IG9yIHNlcmlhbCBjb3JyZWxhdGlvbi4gVGhpcyBtZWFucyB0aGF0IGRhdGEgcG9pbnRzIGZyb20gb25lIHllYXIgdG8gdGhlIG5leHQgbWF5IGJlIHNpbWlsYXIgdG8gb25lIGFub3RoZXIgb3IgaGF2ZSBzb21lIHNvcnQgb2YgaW50ZXJuYWwgc3RydWN0dXJlIHJlbGF0ZWQgdG8gdGltZSAoc3VjaCBhcyBzZWFzb25hbGl0eSkuIExldCdzIHRoaW5rIGFib3V0IG91ciBDTzIgZW1pc3Npb24gYW5kIHRlbXBlcmF0dXJlIGRhdGEuIFlvdSBtYXkgYmUgYWJsZSB0byBzZWUgaG93IG9uZSB5ZWFyIG9mIENPMiBlbWlzc2lvbnMgbWlnaHQgYmUgZmFpcmx5IHNpbWlsYXIgdG8gbmV4dCB5ZWFyLCBiZWNhdXNlIHRoZSBudW1iZXIgb2Ygc291cmNlcyAoc3VjaCBhcyBpbmR1c3RyaWFsIGZhY3RvcmllcyBhbmQgY2FycykgaW4gdGhlIFVTIHdpbGwgY2hhbmdlIHNsaWdodGx5IGZyb20geWVhciB0byB5ZWFyLCBidXQgdGhleSB3aWxsIGJlIHJlbGF0ZWQgdG8gdGhhdCBvZiB0aGUgcHJldmlvdXMgeWVhcnMuIEFueXRpbWUgd2UgbG9vayBhdCBjb3JyZWxhdGlvbiBiZXR3ZWVuIHR3byB2YXJpYWJsZXMgdGhhdCBlYWNoIGhhdmUgYXV0b2NvcnJlbGF0aW9uLCB0aGlzIGNhbiByZXN1bHQgaW4gYSBoaWdoZXIgbGlrZWxpaG9vZCBvZiBjb3JyZWxhdGlvbiBiZXR3ZWVuIHRoZXNlIHZhcmlhYmxlcy4gCgpJbmRlZWQgaWYgd2UgbG9vayBhdCBjb3JyZWxhdGlvbiBiZXR3ZWVuIHR3byByYW5kb20gdmFyaWFibGVzIHdpdGggYXV0b2NvcnJlbGF0aW9uIHdlIGNhbiBzZWUgYW4gaW5mbGF0aW9uIGluIHRoZSBjb3JyZWxhdGlvbiByaG8gdmFsdWVzIGJldHdlZW4gdGhlIHR3byB2YXJpYWJsZXMsIGFzIGNvbXBhcmVkIHRvIHRoYXQgb2YgdmFyaWFibGVzIHRoYXQgZG8gbm90IGhhdmUgYXV0b2NvcnJlbGF0aW9uLgoKYGBge3IsIGVjaG8gPSBGQUxTRX0KaGlzdChyZXBsaWNhdGUoNTAwMCwgeyBjb3IoZGlmZmludihybm9ybSg5OSkpLGRpZmZpbnYocm5vcm0oOTkpKSkgfSksIGJyZWFrcz0xMDAsIG1haW49IkNvcnJlbGF0aW9uIGJldHdlZW4gYXV0b2NvcnJlbGF0ZWQgdmFyaWFibGVzIiwgeGxhYj0icmhvIikKaGlzdChyZXBsaWNhdGUoNTAwMCwgeyBjb3Iocm5vcm0oMTAwKSxybm9ybSgxMDApKSB9KSwgYnJlYWtzPTEwMCwgbWFpbj0iQ29ycmVsYXRpb24gYmV0d2VlbiB2YXJpYWJsZXMgd2l0aCBubyBhdXRvY29ycmVsYXRpb24iLCB4bGFiPSJyaG8iKQpgYGAKClRoaXMgaXMgc29tZXRoaW5nIHRvIGtlZXAgaW4gbWluZCB3aGVuIHlvdSBldmFsdWF0ZSBob3cgdHdvIHRoaW5ncyBhcmUgcmVsYXRlZCB0byBvbmUgYW5vdGhlciBvdmVyIHRpbWUuIFRoZXJlIGFyZSBbbWV0aG9kc10oaHR0cHM6Ly9vbmxpbmUuc3RhdC5wc3UuZWR1L3N0YXQ0NjIvbm9kZS8xODgvKSB0aGF0IGhhdmUgYmVlbiBkZXZlbG9wZWQgdG8gYWNjb3VudCBmb3IgdGhpcyBpbiBbdGltZSBzZXJpZXNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1RpbWVfc2VyaWVzKSBhbmFseXNpcyAoYW5hbHl6aW5nIGRhdGEgb3ZlciB0aW1lKS4gVGhpcyBkb2VzIG5vdCBtZWFuIHRoYXQgdHdvIHZhcmlhYmxlcyAoc3VjaCBhcyBDTzIgYW5kIHRlbXBlcmF0dXJlKSBtYXkgbm90IGJlIGluIGZhY3QgY29ycmVsYXRlZCwgaXQganVzdCBtZWFucyB0aGF0IHdlIG5lZWQgdG8gYWNjb3VudCBmb3IgdGhlIGF1dG9jb3JyZWxhdGlvbiB3aXRoaW4gZWFjaCB2YXJpYWJsZSwgaG93ZXZlciB0aGlzIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhpcyBjYXNlIHN0dWR5LgoKIyAqKlN1bW1hcnkqKgoqKiogCgojIyAqKlN1bW1hcnkgUGxvdCoqCioqKgoKVGhlIGxhc3QgdGhpbmcgd2Ugd2lsbCBkbyBoZXJlIGlzIHRvIGNyZWF0ZSBhIHBsb3QgdGhhdCBzdW1tYXJpemVzIG91ciBtYWpvciBmaW5kaW5ncy4gCldlIHdpbGwgdXNlIHRoZSBgcGxvdF9sYXlvdXQoKWAgZnVuY3Rpb24gb2YgdGhlIGBwYXRjaHdvcmtgIFIgcGFja2FnZS4gVGhlIGBwYXRjaHdvcmtgIGFsbG93cyB5b3UgdG8gY3JlYXRlIGEgcGxvdCBsYXlvdXQgYmFzZWQgb24gbWF0aGVtYXRpY2FsLWxpa2UgZm9ybXVsYXMuIEFzIHlvdSBjYW4gc2VlIGluIHRoaXMgZXhhbXBsZSB3ZSB3YW50IHRoZSBgQ08yX3dvcmxkYCBhbmQgYFRvcDEwdGAgcGxvdCBvbiB0b3AgYW5kIHdlIHdhbnQgYW5vdGhlciByb3cgd2l0aCB0aGUgYENPMl90ZW1wX1VTX2ZhY2V0YCBhbmQgIHRoZSBgQ08yX3RlbXBfVVNgIHBsb3Qgb24gdGhlIGJvdHRvbS4gVGhlIHBsb3RfbGF5b3V0KCkgZnVuY3Rpb24gb2YgdGhlIGBwYXRjaHdvcmtgIHBhY2thZ2UgdGhlbiBhbGxvd3MgdXMgdG8gc3BlY2lmeSBoZWlnaHRzIGFuZCB3aWR0aHMgZm9yIHRoZSBwbG90cy4KCldlIHdpbGwgYWxzbyBzYXZlIHRoZSBmaWd1cmUgdXNpbmcgdGhlIGBnckRldmljZXNgIGBwbmcoKWAgZnVuY3Rpb24uIFdlIGNhbiBzcGVjaWZ5IHRoZSBuYW1lIG9mIG91ciBwbG90IGZpbGUgYW5kIHdoZXJlIHdlIHdhbnQgaXQgdG8gYmUgc2F2ZWQgdXNpbmcgdGhlIGBoZXJlKClgIGZ1bmN0aW9uIG9mIHRoZSBgaGVyZWAgcGFja2FnZS4gSW4gdGhpcyBjYXNlIGluIHRoZSBgaW1nYCBzdWJkaXJlY3Rvcnkgb2YgdGhlIGRpcmVjdG9yeSBjb250YWluaW5nIG91ciAuUnByb2ogZmlsZS4gV2UgY2FuIGFsc28gc3BlY2lmeSB0aGUgc2l6ZSBvZiB0aGUgcGxvdCBhbmQgdGhlIHJlc29sdXRpb24gdXNpbmcgdGhlIGByZXNgIGFyZ3VtZW50LiAgVGhlIGBnckRldmljZXNgIGBkZXYub2ZmKClgIGZ1bmN0aW9uIGlzIG5lY2Vzc2FyeSB0byBjbG9zZSB0aGUgZ3JhcGhpY3MgZGV2aWNlLgoKVGhpcyB3aWxsIGluY2x1ZGUgYSBmZXcgcGxvdHMgdGhhdCB3ZSBtYWRlIHByZXZpb3VzbHkgaW4gb3RoZXIgc2VjdGlvbnMuIFdlIHNhdmVkIHRoZXNlIGluIHRoZSAicGxvdHMiIGRpcmVjdG9yeSBhbmQgd2lsbCBsb2FkIHRoZXNlIG5vdyBmb3IgdXNlcnMgd2hvIHN0b3BwZWQgYW5kIHJlc3RhcnRlZCBvciBzdGFydGVkIGF0IHRoZSBkYXRhIGFuYWx5c2lzIHNlY3Rpb24uCgpgYGB7cn0KbG9hZChoZXJlOjpoZXJlKCJwbG90cyIsICJDTzJfd29ybGQucmRhIikpCmxvYWQoaGVyZTo6aGVyZSgicGxvdHMiLCAiVG9wMTB0LnJkYSIpKQpsb2FkKGhlcmU6OmhlcmUoInBsb3RzIiwgIkNPMl90ZW1wX1VTX2ZhY2V0LnJkYSIpKQpgYGAKCmBgYHtyLCBldmFsID0gRkFMU0V9CnBuZyhoZXJlOjpoZXJlKCJpbWciLCAibWFpbnBsb3QucG5nIiksIHVuaXRzID0gImluIiwgd2lkdGggPSAxMiwgaGVpZ2h0ID0gMTAsIHJlcyA9IDMwMCkKKENPMl93b3JsZCB8IFRvcDEwdCkgLyAoQ08yX3RlbXBfVVNfZmFjZXQgfCBDTzJfdGVtcF9VU19zY2FsZWQpICsKICBwbG90X2xheW91dCh3aWR0aHMgPSBjKDEsIDIpLAogICAgICAgICAgICAgIGhlaWdodHMgPSB1bml0KGMoNCwgMTApLCBjKCdjbScsICdjbScpKSkKZGV2Lm9mZigpCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjgwMCBweCIsIGRwaT0zMDB9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJtYWlucGxvdC5wbmciKSkKYGBgCgoKCiMjICoqU3lub3BzaXMqKgoqKioKCkluIHRoaXMgY2FzZSBzdHVkeSB3ZSBldmFsdWF0ZWQgQ08yIGVtaXNzaW9ucyBmcm9tIGFzIGZhciBiYWNrIGFzIDE3NTEgZm9yIHNvbWUgY291bnRyaWVzIHRvIDIwMTQuIFdlIGRpc2NvdmVyZWQgdGhhdCBnbG9iYWwgbGV2ZWxzIG9mIENPMiBlbWlzc2lvbnMgaGF2ZSBkcmFtYXRpY2FsbHkgaW5jcmVhc2VkIG92ZXIgdGltZS4gV2UgYWxzbyBsZWFybmVkIHRoYXQgc29tZSBjb3VudHJpZXMgaGF2ZSBiZWVuIHJlc3BvbnNpYmxlIGZvciBwYXJ0aWN1bGFybHkgaGlnaCBsZXZlbHMuIAoKV2UgYWxzbyB0b29rIGEgbG9vayBhdCBob3cgQ08yIGVtaXNzaW9ucyBtaWdodCByZWxhdGUgdG8gb3RoZXIgZmFjdG9ycywgc3VjaCBhcyB0ZW1wZXJhdHVyZSwgZW5lcmd5IHVzZSwgYW5kIG5hdHVyYWwgZGlzYXN0ZXJzLiBXZSBsZWFybmVkIHRoYXQgd2UgY2FuIHN1bW1hcml6ZSB0aGUgcmVsYXRpb25zaGlwIGJldHdlZW4gdHdvIHNldHMgb2YgZGF0YSB1c2luZyAqKmNvcnJlbGF0aW9uIGNvZWZmaWNpZW50cyoqLiBXZSBhbHNvIGxlYXJuZWQgdGhhdCB3ZSBjYW4gdXNlICoqcmVncmVzc2lvbioqIHRvIHByZWRpY3Qgb3IgZGVzY3JpYmUgaG93IGNoYW5nZXMgaW4gb25lIHZhcmlhYmxlIG1heSBpbmZsdWVuY2UgY2hhbmdlcyBpbiBhbm90aGVyIHZhcmlhYmxlLiBJbXBvcnRhbnRseSwgd2UgYWxzbyBsZWFybmVkIHRoYXQganVzdCBiZWNhdXNlIHR3byB2YXJpYWJsZXMgc2hvdyBzdHJvbmcgY29ycmVsYXRpb24gb3Igc2hvdyBhbiBhc3NvY2lhdGlvbiwgaXQgZG9lcyBub3QgbmVjZXNzYXJpbHkgaW5kaWNhdGUgdGhhdCB0aGV5IGFyZSBjYXVzYWxseSByZWxhdGVkLiAKCkhvd2V2ZXIsIHRoZXJlIGlzIHF1aXRlIGEgYml0IG9mIHNjaWVudGlmaWMgZXZpZGVuY2UgdG8gaW5kaWNhdGUgdGhhdCBpbiBmYWN0IENPMiBlbWlzc2lvbnMgdHJhcCBoZWF0IGFuZCBsZWFkIHRvIGluY3JlYXNlZCBnbG9iYWwgdGVtcGVyYXR1cmVzLiBZZXQsIGl0IGlzIGltcG9ydGFudCB0byByZWFsaXplIHRoYXQgdGhlcmUgYXJlIG90aGVyIGZhY3RvcnMgaW52b2x2ZWQgaW4gdGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIFVTIENPMiBlbWlzc2lvbnMgYW5kIFVTIGFubnVhbCBhdmVyYWdlIHRlbXBlcmF0dXJlcy4gRm9yIGV4YW1wbGUgdGhlcmUgYXJlIENPMiBlbWlzc2lvbnMgZnJvbSBvdGhlciBjb3VudHJpZXMgaW4gdGhlIGF0bW9zcGhlcmUsIHRoZXJlIGFyZSBvdGhlciBncmVlbmhvdXNlIGdhc2VzLCB0aGVyZSBpcyBhbHJlYWR5IGV4aXN0aW5nIENPMiBpbiB0aGUgYXRtb3NwaGVyZSB0aGF0IHdpbGwgY29udGludWUgdG8gdHJhcCBoZWF0IGZvciBtYW55IHllYXJzLCBhbmQgZmluYWxseSB0aGVyZSBpcyBoZWF0IHRyYXBwZWQgaW4gdGhlIG9jZWFuIGR1ZSB0byBwcmV2aW91cyBlbWlzc2lvbnMgdGhhdCB3aWxsIGNhdXNlIGRlbGF5ZWQgY2hhbmdlcyBpbiBzdXJmYWNlIHRlbXBlcmF0dXJlcy4gSG93ZXZlciwgaXQgaXMgdml0YWwgdGhhdCB3ZSB3b3JrIGFyb3VuZCB0aGUgZ2xvYmUgdG8gcmVkdWNlIGZ1dHVyZSBncmVlbmhvdXNlIGdhcyBlbWlzc2lvbnMgdG8gbWl0aWdhdGUgdGhlIGluY3JlYXNlZCB0ZW1wZXJhdHVyZXMgdGhhdCB3ZSB3aWxsIGV4cGVyaWVuY2UgZHVlIHRvIHByZXZpb3VzIGFuZCBleGlzdGluZyBDTzIgZW1pc3Npb25zLCBzbyB0aGF0IHRoZSB3YXJtaW5nIHRlbXBlcmF0dXJlcyBhcmVuJ3QgYXMgZXh0cmVtZSBhcyB0aGV5IGNvdWxkIGJlLiBGdXJ0aGVybW9yZSwgd2UgbmVlZCB0byBwcmVwYXJlIGZvciBpbmNyZWFzZWQgcmF0ZXMgb2YgbmF0dXJhbCBkaXNhc3RlcnMgYW5kIGhvdyB0aGVzZSBtYXkgaW5mbHVlbmNlIHBlb3BsZSBhcm91bmQgdGhlIHdvcmxkLiBFdmlkZW5jZSBzdWdnZXN0cyB0aGF0IGltcG92ZXJpc2hlZCBwZW9wbGUgYXJlIHRoZSBbbW9zdCBhZmZlY3RlZCBieSBkaXNhc3RlcnNdKGh0dHBzOi8vb3Vyd29ybGRpbmRhdGEub3JnL25hdHVyYWwtZGlzYXN0ZXJzKXt0YXJnZXQ9Il9ibGFuayJ9LiBXZSBuZWVkIHRvIGJlIHBhcnRpY3VsYXJseSBtaW5kZnVsIG9mIHRoaXMgYXMgd2UgcHJlcGFyZSBmb3IgdGhlIGZ1dHVyZS4gIAoKCgojICoqU3VnZ2VzdGVkIEhvbWV3b3JrKioKKioqCgpBc2sgc3R1ZGVudHMgdG8gY3JlYXRlIGEgcGxvdCB3aXRoIGxhYmVscyBzaG93aW5nIHRoZSBjb3VudHJpZXMgd2l0aCB0aGUgbG93ZXN0IENPMiBlbWlzc2lvbiBsZXZlbHMuCgpBc2sgc3R1ZGVudHMgdG8gcGxvdCBDTzIgZW1pc3Npb25zIGFuZCBvdGhlciB2YXJpYWJsZXMgKGUuZy4gZW5lcmd5IHVzZSkgb24gYSBzY2F0dGVyIHBsb3QsIGNhbGN1bGF0ZSB0aGUgUGVhcnNvbidzIGNvcnJlbGF0aW9uIGNvZWZmaWNpZW50LCBhbmQgZGlzY3VzcyByZXN1bHRzLiAKCiMgKipBZGRpdGlvbmFsIGluZm9ybWF0aW9uKioKKioqCgojIyAqKkhlbHBmdWwgTGlua3MqKgoqKioKCltUaWR5dmVyc2VdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1JTdHVkaW8gY2hlYXRzaGVldHNdKGh0dHBzOi8vcnN0dWRpby5jb20vcmVzb3VyY2VzL2NoZWF0c2hlZXRzLyl7dGFyZ2V0PSJfYmxhbmsifQpbSW50cm9kdWN0aW9uIHRvIGNvcnJlbGF0aW9uXShodHRwczovL3d3dy5tYXRoc2lzZnVuLmNvbS9kYXRhL2NvcnJlbGF0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KW0NvcnJlbGF0aW9uIGNvZWZmaWNpZW50XShodHRwczovL3JhZmFsYWIuZ2l0aHViLmlvL2RzYm9vay9yZWdyZXNzaW9uLmh0bWwjY29yci1jb2VmbCl7dGFyZ2V0PSJfYmxhbmsifSAgIApbQ29ycmVsYXRpb24gZG9lcyBub3QgaW1wbHkgY2F1c2F0aW9uXShodHRwczovL2RmcmllZHMuY29tL21hdGgvY29ycmVsYXRpb24tZG9lcy1ub3QtaW1wbHktY2F1c2F0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbUmVncmVzc2lvbl0oaHR0cHM6Ly9yYWZhbGFiLmdpdGh1Yi5pby9kc2Jvb2svcmVncmVzc2lvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW0xvY2FsbHkgZXN0aW1hdGVkIHNjYXR0ZXJwbG90IHNtb290aGluZ10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTG9jYWxfcmVncmVzc2lvbil7dGFyZ2V0PSJfYmxhbmsifSAgCltMb2NhbCBwb2x5bm9taWFsIHJlZ3Jlc3Npb25dKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xvY2FsX3JlZ3Jlc3Npb24pe3RhcmdldD0iX2JsYW5rIn0gIApbQXV0b2NvcnJsZWF0aW9uXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BdXRvY29ycmVsYXRpb24pe3RhcmdldD0iX2JsYW5rIn0gIApbVGltZSBzZXJpZXNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1RpbWVfc2VyaWVzKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltNZXRob2RzIHRvIGFjY291bnQgZm9yIGF1dG9jb3JyZWxhdGlvbl0oaHR0cHM6Ly9vbmxpbmUuc3RhdC5wc3UuZWR1L3N0YXQ0NjIvbm9kZS8xODgvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1VTIEVudmlyb25tZW50YWwgUHJvdGVjdGlvbiBBZ2VuY3kgKEVQQSkgSW52ZW50b3J5IG9mIFUuUy4gR3JlZW5ob3VzZSBHYXMgRW1pc3Npb25zIGFuZCBTaW5rcyAyMDIwIFJlcG9ydF0oaHR0cHM6Ly93d3cuZXBhLmdvdi9zaXRlcy9wcm9kdWN0aW9uL2ZpbGVzLzIwMjAtMDQvZG9jdW1lbnRzL3VzLWdoZy1pbnZlbnRvcnktMjAyMC1tYWluLXRleHQucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltOYXRpb25hbCBDbGltYXRlIEFzc2Vzc21lbnQgUmVwb3J0XShodHRwczovL2RhdGEuZ2xvYmFsY2hhbmdlLmdvdi9yZXBvcnQvbmNhMy1vdmVydmlldyl7dGFyZ2V0PSJfYmxhbmsifSAgICAKW0dyZWVuaG91c2UgZ2FzZXNdKGh0dHBzOi8vd3d3LmVwYS5nb3YvcmVwb3J0LWVudmlyb25tZW50L2dyZWVuaG91c2UtZ2FzZXMpe3RhcmdldD0iX2JsYW5rIn0gCltDbGltYXRlIGNoYW5nZV0oaHR0cHM6Ly93b3JsZDEwMS5jZnIub3JnL2dsb2JhbC1lcmEtaXNzdWVzL2NsaW1hdGUtY2hhbmdlL2NsaW1hdGUtY2hhbmdlLWFkYXB0YXRpb25zKXt0YXJnZXQ9Il9ibGFuayJ9CgoKPHU+KipQYWNrYWdlcyB1c2VkIGluIHRoaXMgY2FzZSBzdHVkeToqKiA8L3U+CgogUGFja2FnZSAgIHwgVXNlIGluIHRoaXMgY2FzZSBzdHVkeSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAotLS0tLS0tLS0tIHwtLS0tLS0tLS0tLS0tCltgaGVyZWBdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSl7dGFyZ2V0PSJfYmxhbmsifSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEKW2ByZWFkeGxgXShodHRwczovL3JlYWR4bC50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBpbXBvcnQgdGhlIGV4Y2VsIGZpbGUgZGF0YQpbYHJlYWRyYF0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBpbXBvcnQgdGhlIGNzdiBmaWxlIGRhdGEKW2BkcGx5cmBdKGh0dHBzOi8vZHBseXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gIHwgIG8gdmlldyBhbmQgd3JhbmdsZSB0aGUgZGF0YSwgYnkgbW9kaWZ5aW5nIHZhcmlhYmxlcywgcmVuYW1pbmcgdmFyaWFibGVzLCBzZWxlY3RpbmcgdmFyaWFibGVzLCBjcmVhdGluZyB2YXJpYWJsZXMsIGFuZCBhcnJhbmdpbmcgdmFsdWVzIHdpdGhpbiBhIHZhcmlhYmxlICAgCltgbWFncml0dHJgXShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvbWFncml0dHIvdmlnbmV0dGVzL21hZ3JpdHRyLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIHwgIHRvIHVzZSBhbmQgcmVhc3NpZ24gZGF0YSBvYmplY3RzIHVzaW5nIHRoZSBgJTw+JWBwaXBlIG9wZXJhdG9yCltgc3RyaW5ncmBdKGh0dHBzOi8vc3RyaW5nci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBzZWxlY3Qgb25seSB0aGUgZmlyc3QgNCBjaGFyYWN0ZXJzIG9mIGRhdGUgZGF0YQpbYHB1cnJyYF0oaHR0cHM6Ly9wdXJyci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgfCB0byBhcHBseSBhIGZ1bmN0aW9uIG9uIGEgbGlzdCBvZiB0aWJibGVzICh0aWJibGVzIGFyZSB0aGUgdGlkeXZlcnNlIHZlcnNpb24gb2YgYSBkYXRhIGZyYW1lKSAgCltgdGlkeXJgXShodHRwczovL3RpZHlyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IHRvIGRyb3Agcm93cyB3aXRoIGBOQWAgdmFsdWVzIGZyb20gYSB0aWJibGUKW2Bmb3JjYXRzYF0oaHR0cHM6Ly9mb3JjYXRzLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IHRvIHJlb3JkZXIgdGhlIGxldmVscyBvZiBhIGZhY3RvcgpbYGdncGxvdDJgXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gfCB0byBtYWtlIHZpc3VhbGl6YXRpb25zCltgZGlyZWN0bGFiZWxzYF0oaHR0cDovL2RpcmVjdGxhYmVscy5yLWZvcmdlLnItcHJvamVjdC5vcmcvZG9jcy9pbmRleC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gYWRkIGxhYmVscyB0byBwbG90cyBlYXNpbHkKW2BnZ3JlcGVsYF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSB8IHRvIGFkZCBsYWJlbHMgdGhhdCBkb24ndCBvdmVybGFwIHRvIHBsb3RzCltgYnJvb21gXShodHRwczovL3d3dy50aWR5dmVyc2Uub3JnL2Jsb2cvMjAxOC8wNy9icm9vbS0wLTUtMC8pIHwgdG8gbWFrZSB0aGUgb3V0cHV0IGZvcm0gc3RhdGlzdGljYWwgdGVzdHMgZWFzaWVyIHRvIHdvcmsgd2l0aApbYHBhdGNod29ya2BdKGh0dHBzOi8vZ2l0aHViLmNvbS90aG9tYXNwODUvcGF0Y2h3b3JrKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IHRvIGNvbWJpbmUgcGxvdHMKCgojIyAqKlNlc3Npb24gSW5mbyoqCioqKgoKYGBge3J9CnNlc3Npb25JbmZvKCkKYGBgCgoqKkVzdGltYXRlIG9mIFJNYXJrZG93biBDb21waWxhdGlvbiBUaW1lOiAqKgoKYGBge3IsIGVjaG89RkFMU0V9CnJtYXJrZG93bjo6OnBlcmZfdGltZXJfc3RvcCgicmVuZGVyIikKcHRzID0gcm1hcmtkb3duOjo6cGVyZl90aW1lcl9zdW1tYXJ5KCkKY2F0KCJBYm91dCIsIHJvdW5kKHB0cyR0aW1lWzFdLzEwMDAgKyA1KSwgIi0iLCByb3VuZChwdHMkdGltZVsxXS8xMDAwICsgMTUpLCJzZWNvbmRzIikKYGBgCgpUaGlzIGNvbXBpbGF0aW9uIHRpbWUgd2FzIG1lYXN1cmVkIG9uIGEgUEMgbWFjaGluZSBvcGVyYXRpbmcgb24gV2luZG93cyAxMC4gVGhpcyByYW5nZSBzaG91bGQgb25seSBiZSB1c2VkIGFzIGFuIGVzdGltYXRlIGFzIGNvbXBpbGF0aW9uIHRpbWUgd2lsbCB2YXJ5IHdpdGggZGlmZmVyZW50IG1hY2hpbmVzIGFuZCBvcGVyYXRpbmcgc3lzdGVtcy4gCgojIyAqKkFja25vd2xlZGdtZW50cyoqCioqKgoKV2Ugd291bGQgbGlrZSB0byBhY2tub3dsZWRnZSBbTWVnYW4gTGF0c2hhd10oaHR0cHM6Ly93d3cuamhzcGguZWR1L2ZhY3VsdHkvZGlyZWN0b3J5L3Byb2ZpbGUvMTcwOC9tZWdhbi13ZWlsLWxhdHNoYXcpIGZvciBhc3Npc3RpbmcgaW4gZnJhbWluZyB0aGUgbWFqb3IgZGlyZWN0aW9uIG9mIHRoZSBjYXNlIHN0dWR5LgoKV2Ugd291bGQgbGlrZSB0byBhY2tub3dsZWRnZSBbUWllciBNZW5nXShodHRwczovL3d3dy5vcGVuY2FzZXN0dWRpZXMub3JnL2F1dGhvcnMvcW1lbmcvKSBhbmQgW01pY2hhZWwgQnJlc2hvY2tdKGh0dHBzOi8vbWJyZXNob2NrLmdpdGh1Yi5pby8pIGZvciB0aGVpciBjb250cmlidXRpb25zIHRvIHRoaXMgY2FzZSBzdHVkeS4gCgpXZSB3b3VsZCBhbHNvIGxpa2UgdG8gYWNrbm93bGVkZ2UgdGhlIFtCbG9vbWJlcmcgQW1lcmljYW4gSGVhbHRoIEluaXRpYXRpdmVdKGh0dHBzOi8vYW1lcmljYW5oZWFsdGguamh1LmVkdS8pIGZvciBmdW5kaW5nIHRoaXMgd29yay4gCgoKPHNjcmlwdCB0eXBlPSd0ZXh0L2phdmFzY3JpcHQnIGlkPSdjbHVzdHJtYXBzJyBzcmM9Jy8vY2RuLmNsdXN0cm1hcHMuY29tL21hcF92Mi5qcz9jbD0wODA4MDgmdz1hJnQ9dHQmZD1ya2VKeTdzelIyemdrbzZTelF2T2pnU0FLUEc2YUh3ZmdQMzM4eXNxQXlFJmNvPWZmZmZmZiZjbW89M2FjYzNhJmNtbj1mZjUzNTMmY3Q9ODA4MDgwJz48L3NjcmlwdD4=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
